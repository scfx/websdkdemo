import { retryWhen, scan, tap, delay } from 'rxjs/operators';
export function retryWithDelay(delayTime, count = 1) {
    return (input) => input.pipe(retryWhen((errors) => errors.pipe(scan((acc, error) => ({ count: acc.count + 1, error }), {
        count: 0,
        error: undefined,
    }), tap((current) => {
        if (current.count > count) {
            throw current.error;
        }
    }), delay(delayTime))));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV0cnktd2l0aC1kZWxheS5vcGVyYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvcmUvY29tbW9uL3JldHJ5LXdpdGgtZGVsYXkub3BlcmF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdELE1BQU0sVUFBVSxjQUFjLENBQzFCLFNBQWlCLEVBQ2pCLEtBQUssR0FBRyxDQUFDO0lBRVQsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQ2YsS0FBSyxDQUFDLElBQUksQ0FDUixTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUNuQixNQUFNLENBQUMsSUFBSSxDQUNULElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRTtRQUN0RCxLQUFLLEVBQUUsQ0FBQztRQUNSLEtBQUssRUFBRSxTQUFnQjtLQUN4QixDQUFDLEVBQ0YsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUU7UUFDZCxJQUFJLE9BQU8sQ0FBQyxLQUFLLEdBQUcsS0FBSyxFQUFFO1lBQ3pCLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQztTQUNyQjtJQUNILENBQUMsQ0FBQyxFQUNGLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FDakIsQ0FDRixDQUNGLENBQUM7QUFDTixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyByZXRyeVdoZW4sIHNjYW4sIHRhcCwgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZXRyeVdpdGhEZWxheTxUPihcbiAgICBkZWxheVRpbWU6IG51bWJlcixcbiAgICBjb3VudCA9IDFcbiAgKTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFQ+IHtcbiAgICByZXR1cm4gKGlucHV0KSA9PlxuICAgICAgaW5wdXQucGlwZShcbiAgICAgICAgcmV0cnlXaGVuKChlcnJvcnMpID0+XG4gICAgICAgICAgZXJyb3JzLnBpcGUoXG4gICAgICAgICAgICBzY2FuKChhY2MsIGVycm9yKSA9PiAoeyBjb3VudDogYWNjLmNvdW50ICsgMSwgZXJyb3IgfSksIHtcbiAgICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICAgIGVycm9yOiB1bmRlZmluZWQgYXMgYW55LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0YXAoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuY291bnQgPiBjb3VudCkge1xuICAgICAgICAgICAgICAgIHRocm93IGN1cnJlbnQuZXJyb3I7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZGVsYXkoZGVsYXlUaW1lKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKTtcbiAgfVxuIl19