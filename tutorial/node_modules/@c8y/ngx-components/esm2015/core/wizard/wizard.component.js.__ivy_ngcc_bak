import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { BsModalRef } from 'ngx-bootstrap/modal';
import { filter } from 'rxjs/operators';
import { WizardService } from './wizard.service';
/**
 * A generic component that is intended to serve as the building block of more wizards.
 *
 * **Example**
 * ```html
 * <button
 *    title="Add application"
 *    class="btn btn-primary"
 *    (click)="addApplication()"
 *  >
 *    Add application
 *  </button>
 * ```
 *
 * ```ts
 * import { Component } from '@angular/core';
 * import { WizardConfig, WizardService, Wizard } from '@c8y/ngx-components';
 * import { ModalOptions } from 'ngx-bootstrap/modal';
 *
 * @Component({
 *  selector: 'c8y-add-application-wizard',
 *  templateUrl: './templatePath'
 * })
 * export class AddApplicationWizardComponent {
 *   constructor(private wizardService: WizardService) {}
 *
 *   addApplication() {
 *     const wizardConfig: WizardConfig = {
 *       headerText: 'Add Application',
 *       headerIcon: 'c8y-icon-modules',
 *       bodyHeaderText: 'Select methods',
 *       bodyHeaderIcon: 'c8y-icon-modules'
 *     };
 *
 *     const initialState: Wizard = {
 *       wizardConfig,
 *       id: 'uploadApplication'
 *     };
 *
 *     const modalOptions: ModalOptions = { initialState };
 *
 *     this.wizardService.show(modalOptions);
 *   }
 * }
 * ```
 */
export class WizardComponent {
    constructor(wizardService, bsModalRef) {
        this.wizardService = wizardService;
        this.bsModalRef = bsModalRef;
        /**
         * A configuration object that allows you to set header values, both text and icon.
         */
        this.wizardConfig = {};
        /**
         * The event that is emitted when the wizard is closed.
         */
        this.onClose = new EventEmitter();
        /**
         * The event that is emitted when the wizard is reseted.
         */
        this.onReset = new EventEmitter();
        /**
         * The event that is emitted when the wizard entry is clicked.
         */
        this.onSelect = new EventEmitter();
        this.headerTemplate$ = this.wizardService.headerTemplate$.pipe(filter(header => header.wizardId === this.id));
        this.bodyTemplate$ = this.wizardService.bodyTemplate$.pipe(filter(body => body.wizardId === this.id));
        this.footerTemplate$ = this.wizardService.footerTemplate$.pipe(filter(footer => footer.wizardId === this.id));
    }
    ngOnInit() {
        this.emitTemplates();
    }
    /**
     * Resets the wizard.
     * @param result Custom result object which will be emitted via onReset output.
     */
    reset(result) {
        this.onReset.emit(result);
        this.emitTemplates();
    }
    /**
     * Closes the wizard.
     * @param result Custom result object which will be emitted via onClose output.
     */
    close(result) {
        this.onClose.emit(result);
        this.bsModalRef.hide();
    }
    emitTemplates() {
        setTimeout(() => {
            this.wizardService.headerTemplate$.next({ template: this.header, wizardId: this.id });
            this.wizardService.bodyTemplate$.next({ template: this.body, wizardId: this.id });
            this.wizardService.footerTemplate$.next({ template: this.footer, wizardId: this.id });
        });
    }
}
WizardComponent.decorators = [
    { type: Component, args: [{
                selector: 'c8y-wizard',
                template: "<div class=\"viewport-modal animated fadeIn\">\n  <ng-template *ngTemplateOutlet=\"(headerTemplate$ | async)?.template\"></ng-template>\n\n  <ng-template #headerRef>\n    <div class=\"modal-header dialog-header animated fadeIn\">\n      <h1 [c8yIcon]=\"wizardConfig.headerIcon\"></h1>\n      <h4>{{ wizardConfig.headerText | translate }}</h4>\n    </div>\n  </ng-template>\n\n  <ng-template *ngTemplateOutlet=\"(bodyTemplate$ | async)?.template\"></ng-template>\n\n  <ng-template #bodyRef>\n    <div class=\"p-16 p-t-8 text-center\" *ngIf=\"wizardConfig.bodyHeaderText\">\n      <div class=\"c8y-wizard-nav\">\n        <i [c8yIcon]=\"wizardConfig.bodyHeaderIcon\"></i>\n        <span>{{ wizardConfig.bodyHeaderText | translate }}</span>\n      </div>\n    </div>\n  </ng-template>\n  <c8y-wizard-outlet (onSelect)=\"onSelect.emit($event)\"></c8y-wizard-outlet>\n\n  <ng-template *ngTemplateOutlet=\"(footerTemplate$ | async)?.template\"></ng-template>\n  <ng-template #footerRef>\n    <div class=\"modal-footer animated fadeIn\">\n      <button\n        (click)=\"close()\"\n        type=\"button\"\n        class=\"btn btn-default\"\n        title=\"{{ 'Cancel' | translate }}\"\n      >\n        <span translate>Cancel</span>\n      </button>\n    </div>\n  </ng-template>\n</div>\n"
            },] }
];
WizardComponent.ctorParameters = () => [
    { type: WizardService },
    { type: BsModalRef }
];
WizardComponent.propDecorators = {
    header: [{ type: ViewChild, args: ['headerRef', { static: true },] }],
    body: [{ type: ViewChild, args: ['bodyRef', { static: true },] }],
    footer: [{ type: ViewChild, args: ['footerRef', { static: true },] }],
    id: [{ type: Input }],
    wizardConfig: [{ type: Input }],
    onClose: [{ type: Output }],
    onReset: [{ type: Output }],
    onSelect: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2l6YXJkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvcmUvd2l6YXJkL3dpemFyZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sRUFFTixTQUFTLEVBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4QyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFakQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQTZDRztBQU1ILE1BQU0sT0FBTyxlQUFlO0lBbUMxQixZQUFtQixhQUE0QixFQUFTLFVBQXNCO1FBQTNELGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQVMsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQTFCOUU7O1dBRUc7UUFDTSxpQkFBWSxHQUFpQixFQUFFLENBQUM7UUFDekM7O1dBRUc7UUFDTyxZQUFPLEdBQXNCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDMUQ7O1dBRUc7UUFDTyxZQUFPLEdBQXNCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDMUQ7O1dBRUc7UUFDTyxhQUFRLEdBQThCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDMUQsb0JBQWUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQ2hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUM5QyxDQUFDO1FBQ08sa0JBQWEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUMxQyxDQUFDO1FBQ08sb0JBQWUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQ2hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUM5QyxDQUFDO0lBRStFLENBQUM7SUFFbEYsUUFBUTtRQUNOLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLE1BQVk7UUFDaEIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDMUIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsTUFBWTtRQUNoQixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFTyxhQUFhO1FBQ25CLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZCxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDdEYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2xGLElBQUksQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN4RixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7OztZQXJFRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLFlBQVk7Z0JBQ3RCLGd4Q0FBc0M7YUFDdkM7OztZQXBEUSxhQUFhO1lBSGIsVUFBVTs7O3FCQXlEaEIsU0FBUyxTQUFDLFdBQVcsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7bUJBQ3ZDLFNBQVMsU0FBQyxTQUFTLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO3FCQUNyQyxTQUFTLFNBQUMsV0FBVyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtpQkFLdkMsS0FBSzsyQkFJTCxLQUFLO3NCQUlMLE1BQU07c0JBSU4sTUFBTTt1QkFJTixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJzTW9kYWxSZWYgfSBmcm9tICduZ3gtYm9vdHN0cmFwL21vZGFsJztcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFdpemFyZCwgV2l6YXJkQ29uZmlnLCBXaXphcmRFbnRyeSB9IGZyb20gJy4vd2l6YXJkLm1vZGVsJztcbmltcG9ydCB7IFdpemFyZFNlcnZpY2UgfSBmcm9tICcuL3dpemFyZC5zZXJ2aWNlJztcblxuLyoqXG4gKiBBIGdlbmVyaWMgY29tcG9uZW50IHRoYXQgaXMgaW50ZW5kZWQgdG8gc2VydmUgYXMgdGhlIGJ1aWxkaW5nIGJsb2NrIG9mIG1vcmUgd2l6YXJkcy5cbiAqXG4gKiAqKkV4YW1wbGUqKlxuICogYGBgaHRtbFxuICogPGJ1dHRvblxuICogICAgdGl0bGU9XCJBZGQgYXBwbGljYXRpb25cIlxuICogICAgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIlxuICogICAgKGNsaWNrKT1cImFkZEFwcGxpY2F0aW9uKClcIlxuICogID5cbiAqICAgIEFkZCBhcHBsaWNhdGlvblxuICogIDwvYnV0dG9uPlxuICogYGBgXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuICogaW1wb3J0IHsgV2l6YXJkQ29uZmlnLCBXaXphcmRTZXJ2aWNlLCBXaXphcmQgfSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbiAqIGltcG9ydCB7IE1vZGFsT3B0aW9ucyB9IGZyb20gJ25neC1ib290c3RyYXAvbW9kYWwnO1xuICpcbiAqIEBDb21wb25lbnQoe1xuICogIHNlbGVjdG9yOiAnYzh5LWFkZC1hcHBsaWNhdGlvbi13aXphcmQnLFxuICogIHRlbXBsYXRlVXJsOiAnLi90ZW1wbGF0ZVBhdGgnXG4gKiB9KVxuICogZXhwb3J0IGNsYXNzIEFkZEFwcGxpY2F0aW9uV2l6YXJkQ29tcG9uZW50IHtcbiAqICAgY29uc3RydWN0b3IocHJpdmF0ZSB3aXphcmRTZXJ2aWNlOiBXaXphcmRTZXJ2aWNlKSB7fVxuICpcbiAqICAgYWRkQXBwbGljYXRpb24oKSB7XG4gKiAgICAgY29uc3Qgd2l6YXJkQ29uZmlnOiBXaXphcmRDb25maWcgPSB7XG4gKiAgICAgICBoZWFkZXJUZXh0OiAnQWRkIEFwcGxpY2F0aW9uJyxcbiAqICAgICAgIGhlYWRlckljb246ICdjOHktaWNvbi1tb2R1bGVzJyxcbiAqICAgICAgIGJvZHlIZWFkZXJUZXh0OiAnU2VsZWN0IG1ldGhvZHMnLFxuICogICAgICAgYm9keUhlYWRlckljb246ICdjOHktaWNvbi1tb2R1bGVzJ1xuICogICAgIH07XG4gKlxuICogICAgIGNvbnN0IGluaXRpYWxTdGF0ZTogV2l6YXJkID0ge1xuICogICAgICAgd2l6YXJkQ29uZmlnLFxuICogICAgICAgaWQ6ICd1cGxvYWRBcHBsaWNhdGlvbidcbiAqICAgICB9O1xuICpcbiAqICAgICBjb25zdCBtb2RhbE9wdGlvbnM6IE1vZGFsT3B0aW9ucyA9IHsgaW5pdGlhbFN0YXRlIH07XG4gKlxuICogICAgIHRoaXMud2l6YXJkU2VydmljZS5zaG93KG1vZGFsT3B0aW9ucyk7XG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS13aXphcmQnLFxuICB0ZW1wbGF0ZVVybDogJy4vd2l6YXJkLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBXaXphcmRDb21wb25lbnQgaW1wbGVtZW50cyBXaXphcmQsIE9uSW5pdCB7XG4gIEBWaWV3Q2hpbGQoJ2hlYWRlclJlZicsIHsgc3RhdGljOiB0cnVlIH0pIGhlYWRlcjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQFZpZXdDaGlsZCgnYm9keVJlZicsIHsgc3RhdGljOiB0cnVlIH0pIGJvZHk6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBWaWV3Q2hpbGQoJ2Zvb3RlclJlZicsIHsgc3RhdGljOiB0cnVlIH0pIGZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcbiAgLyoqXG4gICAqIFRoZSBpZCBwYXJhbWV0ZXIgaWRlbnRpZmllcyB0aGUgcGFydGljdWxhciB3aXphcmQgYW5kIGNhbiBiZSB1c2VkIHRvIHJlZmVyIHRvIGl0IHdoZW4gaG9va2luZyB3aXphcmQgZW50cmllcy5cbiAgICogRXhhbXBsZTogXCJ3aXphcmRJZFwiLlxuICAgKi9cbiAgQElucHV0KCkgaWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEEgY29uZmlndXJhdGlvbiBvYmplY3QgdGhhdCBhbGxvd3MgeW91IHRvIHNldCBoZWFkZXIgdmFsdWVzLCBib3RoIHRleHQgYW5kIGljb24uXG4gICAqL1xuICBASW5wdXQoKSB3aXphcmRDb25maWc6IFdpemFyZENvbmZpZyA9IHt9O1xuICAvKipcbiAgICogVGhlIGV2ZW50IHRoYXQgaXMgZW1pdHRlZCB3aGVuIHRoZSB3aXphcmQgaXMgY2xvc2VkLlxuICAgKi9cbiAgQE91dHB1dCgpIG9uQ2xvc2U6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAvKipcbiAgICogVGhlIGV2ZW50IHRoYXQgaXMgZW1pdHRlZCB3aGVuIHRoZSB3aXphcmQgaXMgcmVzZXRlZC5cbiAgICovXG4gIEBPdXRwdXQoKSBvblJlc2V0OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgLyoqXG4gICAqIFRoZSBldmVudCB0aGF0IGlzIGVtaXR0ZWQgd2hlbiB0aGUgd2l6YXJkIGVudHJ5IGlzIGNsaWNrZWQuXG4gICAqL1xuICBAT3V0cHV0KCkgb25TZWxlY3Q6IEV2ZW50RW1pdHRlcjxXaXphcmRFbnRyeT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIHJlYWRvbmx5IGhlYWRlclRlbXBsYXRlJCA9IHRoaXMud2l6YXJkU2VydmljZS5oZWFkZXJUZW1wbGF0ZSQucGlwZShcbiAgICBmaWx0ZXIoaGVhZGVyID0+IGhlYWRlci53aXphcmRJZCA9PT0gdGhpcy5pZClcbiAgKTtcbiAgcmVhZG9ubHkgYm9keVRlbXBsYXRlJCA9IHRoaXMud2l6YXJkU2VydmljZS5ib2R5VGVtcGxhdGUkLnBpcGUoXG4gICAgZmlsdGVyKGJvZHkgPT4gYm9keS53aXphcmRJZCA9PT0gdGhpcy5pZClcbiAgKTtcbiAgcmVhZG9ubHkgZm9vdGVyVGVtcGxhdGUkID0gdGhpcy53aXphcmRTZXJ2aWNlLmZvb3RlclRlbXBsYXRlJC5waXBlKFxuICAgIGZpbHRlcihmb290ZXIgPT4gZm9vdGVyLndpemFyZElkID09PSB0aGlzLmlkKVxuICApO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyB3aXphcmRTZXJ2aWNlOiBXaXphcmRTZXJ2aWNlLCBwdWJsaWMgYnNNb2RhbFJlZjogQnNNb2RhbFJlZikge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmVtaXRUZW1wbGF0ZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldHMgdGhlIHdpemFyZC5cbiAgICogQHBhcmFtIHJlc3VsdCBDdXN0b20gcmVzdWx0IG9iamVjdCB3aGljaCB3aWxsIGJlIGVtaXR0ZWQgdmlhIG9uUmVzZXQgb3V0cHV0LlxuICAgKi9cbiAgcmVzZXQocmVzdWx0PzogYW55KSB7XG4gICAgdGhpcy5vblJlc2V0LmVtaXQocmVzdWx0KTtcbiAgICB0aGlzLmVtaXRUZW1wbGF0ZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIHdpemFyZC5cbiAgICogQHBhcmFtIHJlc3VsdCBDdXN0b20gcmVzdWx0IG9iamVjdCB3aGljaCB3aWxsIGJlIGVtaXR0ZWQgdmlhIG9uQ2xvc2Ugb3V0cHV0LlxuICAgKi9cbiAgY2xvc2UocmVzdWx0PzogYW55KSB7XG4gICAgdGhpcy5vbkNsb3NlLmVtaXQocmVzdWx0KTtcbiAgICB0aGlzLmJzTW9kYWxSZWYuaGlkZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0VGVtcGxhdGVzKCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy53aXphcmRTZXJ2aWNlLmhlYWRlclRlbXBsYXRlJC5uZXh0KHsgdGVtcGxhdGU6IHRoaXMuaGVhZGVyLCB3aXphcmRJZDogdGhpcy5pZCB9KTtcbiAgICAgIHRoaXMud2l6YXJkU2VydmljZS5ib2R5VGVtcGxhdGUkLm5leHQoeyB0ZW1wbGF0ZTogdGhpcy5ib2R5LCB3aXphcmRJZDogdGhpcy5pZCB9KTtcbiAgICAgIHRoaXMud2l6YXJkU2VydmljZS5mb290ZXJUZW1wbGF0ZSQubmV4dCh7IHRlbXBsYXRlOiB0aGlzLmZvb3Rlciwgd2l6YXJkSWQ6IHRoaXMuaWQgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==