import { HttpClient, HttpClientModule } from '@angular/common/http';
import { LOCALE_ID, NgModule } from '@angular/core';
import { MissingTranslationHandler, TranslateService as NgxTranslateService, TranslateCompiler, TranslateFakeCompiler, TranslateLoader, TranslateParser, TranslateStore, USE_DEFAULT_LANG, USE_STORE, USE_EXTEND, DEFAULT_LANGUAGE } from '@ngx-translate/core';
import { OptionsService } from '../common/options.service';
import { AppStateService } from '../common/ui-state.service';
import { LANGUAGES } from './languages';
import { LOCALE_PATH } from './locale.path';
import { MissingTranslationCustomHandler } from './missing-translation-custom.handler';
import { MESSAGES } from './pattern-messages.data';
import { HOOK_PATTERN_MESSAGES } from './patterns-message.hook';
import { TranslateCustomLoader } from './translate.loader';
import { TranslateParserCustom } from './translate.parser';
import { C8yTranslateModule } from './c8y-translate.module';
import { CachedLocaleDictionaryService } from './cached-locale-dictionary.service';
const angularLocalesLanguageMap = { en: 'en-GB', 'en-EN': 'en-GB' };
// AoT requires an exported function for factories
export function translateLoaderFactory(httpClient, optionsService, cachedLocaleDictionaryService, localePath, languages) {
    return new TranslateCustomLoader(httpClient, optionsService, cachedLocaleDictionaryService, localePath, languages);
}
export function localePathFactory(options) {
    return options.localePath;
}
export function languagesFactory(options) {
    return options.languages;
}
export function localeId(appStateService) {
    return {
        get lang() {
            return getAngularLocalesLanguageString(appStateService.state.lang || 'en');
        },
        toLowerCase() {
            return this.lang.toLowerCase();
        },
        toString() {
            return this.lang;
        }
    };
}
export function getAngularLocalesLanguageString(language) {
    return angularLocalesLanguageMap[language] || language;
}
/**
 * The angular module definition for i18n (translation).
 * @exports I18nModule
 */
export class I18nModule {
    static providers() {
        return [
            { provide: LOCALE_ID, useFactory: localeId, deps: [AppStateService] },
            { provide: HOOK_PATTERN_MESSAGES, useValue: MESSAGES, multi: true },
            { provide: LOCALE_PATH, useFactory: localePathFactory, deps: [OptionsService] },
            { provide: LANGUAGES, useFactory: languagesFactory, deps: [OptionsService] },
            // Extracted from projects/ngx-translate/core/src/public_api.ts
            {
                provide: TranslateLoader,
                useFactory: translateLoaderFactory,
                deps: [HttpClient, OptionsService, CachedLocaleDictionaryService, LOCALE_PATH, LANGUAGES]
            },
            { provide: TranslateCompiler, useClass: TranslateFakeCompiler },
            { provide: TranslateParser, useClass: TranslateParserCustom },
            { provide: MissingTranslationHandler, useClass: MissingTranslationCustomHandler },
            TranslateStore,
            NgxTranslateService,
            { provide: USE_STORE, useValue: undefined },
            { provide: USE_DEFAULT_LANG, useValue: undefined },
            { provide: USE_EXTEND, useValue: false },
            { provide: DEFAULT_LANGUAGE, useValue: undefined }
        ];
    }
    static forRoot() {
        return {
            ngModule: I18nModule,
            providers: I18nModule.providers()
        };
    }
}
I18nModule.decorators = [
    { type: NgModule, args: [{
                exports: [C8yTranslateModule],
                imports: [HttpClientModule]
            },] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaTE4bi5tb2R1bGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9jb3JlL2kxOG4vaTE4bi5tb2R1bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3BELE9BQU8sRUFDTCx5QkFBeUIsRUFDekIsZ0JBQWdCLElBQUksbUJBQW1CLEVBQ3ZDLGlCQUFpQixFQUNqQixxQkFBcUIsRUFDckIsZUFBZSxFQUNmLGVBQWUsRUFDZixjQUFjLEVBQ2QsZ0JBQWdCLEVBQ2hCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsZ0JBQWdCLEVBQ2pCLE1BQU0scUJBQXFCLENBQUM7QUFDN0IsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQzNELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3hDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDNUMsT0FBTyxFQUFFLCtCQUErQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDdkYsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ25ELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQzNELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQzNELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQ25GLE1BQU0seUJB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O0lBQ0osQ0FBQzs7O1lBbENGLFFBQVEsU0FBQztnQkFDUixPQUFPLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQztnQkFDN0IsT0FBTyxFQUFFLENBQUMsZ0JBQWdCLENBQUM7YUFDNUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwQ2xpZW50TW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgTE9DQUxFX0lELCBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgTWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlcixcbiAgVHJhbnNsYXRlU2VydmljZSBhcyBOZ3hUcmFuc2xhdGVTZXJ2aWNlLFxuICBUcmFuc2xhdGVDb21waWxlcixcbiAgVHJhbnNsYXRlRmFrZUNvbXBpbGVyLFxuICBUcmFuc2xhdGVMb2FkZXIsXG4gIFRyYW5zbGF0ZVBhcnNlcixcbiAgVHJhbnNsYXRlU3RvcmUsXG4gIFVTRV9ERUZBVUxUX0xBTkcsXG4gIFVTRV9TVE9SRSxcbiAgVVNFX0VYVEVORCxcbiAgREVGQVVMVF9MQU5HVUFHRVxufSBmcm9tICdAbmd4LXRyYW5zbGF0ZS9jb3JlJztcbmltcG9ydCB7IE9wdGlvbnNTZXJ2aWNlIH0gZnJvbSAnLi4vY29tbW9uL29wdGlvbnMuc2VydmljZSc7XG5pbXBvcnQgeyBBcHBTdGF0ZVNlcnZpY2UgfSBmcm9tICcuLi9jb21tb24vdWktc3RhdGUuc2VydmljZSc7XG5pbXBvcnQgeyBMQU5HVUFHRVMgfSBmcm9tICcuL2xhbmd1YWdlcyc7XG5pbXBvcnQgeyBMT0NBTEVfUEFUSCB9IGZyb20gJy4vbG9jYWxlLnBhdGgnO1xuaW1wb3J0IHsgTWlzc2luZ1RyYW5zbGF0aW9uQ3VzdG9tSGFuZGxlciB9IGZyb20gJy4vbWlzc2luZy10cmFuc2xhdGlvbi1jdXN0b20uaGFuZGxlcic7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4vcGF0dGVybi1tZXNzYWdlcy5kYXRhJztcbmltcG9ydCB7IEhPT0tfUEFUVEVSTl9NRVNTQUdFUyB9IGZyb20gJy4vcGF0dGVybnMtbWVzc2FnZS5ob29rJztcbmltcG9ydCB7IFRyYW5zbGF0ZUN1c3RvbUxvYWRlciB9IGZyb20gJy4vdHJhbnNsYXRlLmxvYWRlcic7XG5pbXBvcnQgeyBUcmFuc2xhdGVQYXJzZXJDdXN0b20gfSBmcm9tICcuL3RyYW5zbGF0ZS5wYXJzZXInO1xuaW1wb3J0IHsgQzh5VHJhbnNsYXRlTW9kdWxlIH0gZnJvbSAnLi9jOHktdHJhbnNsYXRlLm1vZHVsZSc7XG5pbXBvcnQgeyBDYWNoZWRMb2NhbGVEaWN0aW9uYXJ5U2VydmljZSB9IGZyb20gJy4vY2FjaGVkLWxvY2FsZS1kaWN0aW9uYXJ5LnNlcnZpY2UnO1xuY29uc3QgYW5ndWxhckxvY2FsZXNMYW5ndWFnZU1hcCA9IHsgZW46ICdlbi1HQicsICdlbi1FTic6ICdlbi1HQicgfTtcblxuLy8gQW9UIHJlcXVpcmVzIGFuIGV4cG9ydGVkIGZ1bmN0aW9uIGZvciBmYWN0b3JpZXNcbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVMb2FkZXJGYWN0b3J5KFxuICBodHRwQ2xpZW50OiBIdHRwQ2xpZW50LFxuICBvcHRpb25zU2VydmljZTogT3B0aW9uc1NlcnZpY2UsXG4gIGNhY2hlZExvY2FsZURpY3Rpb25hcnlTZXJ2aWNlOiBDYWNoZWRMb2NhbGVEaWN0aW9uYXJ5U2VydmljZSxcbiAgbG9jYWxlUGF0aDogc3RyaW5nLFxuICBsYW5ndWFnZXM6IGFueVxuKSB7XG4gIHJldHVybiBuZXcgVHJhbnNsYXRlQ3VzdG9tTG9hZGVyKFxuICAgIGh0dHBDbGllbnQsXG4gICAgb3B0aW9uc1NlcnZpY2UsXG4gICAgY2FjaGVkTG9jYWxlRGljdGlvbmFyeVNlcnZpY2UsXG4gICAgbG9jYWxlUGF0aCxcbiAgICBsYW5ndWFnZXNcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsZVBhdGhGYWN0b3J5KG9wdGlvbnM6IE9wdGlvbnNTZXJ2aWNlKSB7XG4gIHJldHVybiBvcHRpb25zLmxvY2FsZVBhdGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsYW5ndWFnZXNGYWN0b3J5KG9wdGlvbnM6IE9wdGlvbnNTZXJ2aWNlKSB7XG4gIHJldHVybiBvcHRpb25zLmxhbmd1YWdlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsZUlkKGFwcFN0YXRlU2VydmljZTogQXBwU3RhdGVTZXJ2aWNlKSB7XG4gIHJldHVybiB7XG4gICAgZ2V0IGxhbmcoKSB7XG4gICAgICByZXR1cm4gZ2V0QW5ndWxhckxvY2FsZXNMYW5ndWFnZVN0cmluZyhhcHBTdGF0ZVNlcnZpY2Uuc3RhdGUubGFuZyB8fCAnZW4nKTtcbiAgICB9LFxuICAgIHRvTG93ZXJDYXNlKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFuZy50b0xvd2VyQ2FzZSgpO1xuICAgIH0sXG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYW5nO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFuZ3VsYXJMb2NhbGVzTGFuZ3VhZ2VTdHJpbmcobGFuZ3VhZ2UpIHtcbiAgcmV0dXJuIGFuZ3VsYXJMb2NhbGVzTGFuZ3VhZ2VNYXBbbGFuZ3VhZ2VdIHx8IGxhbmd1YWdlO1xufVxuXG4vKipcbiAqIFRoZSBhbmd1bGFyIG1vZHVsZSBkZWZpbml0aW9uIGZvciBpMThuICh0cmFuc2xhdGlvbikuXG4gKiBAZXhwb3J0cyBJMThuTW9kdWxlXG4gKi9cbkBOZ01vZHVsZSh7XG4gIGV4cG9ydHM6IFtDOHlUcmFuc2xhdGVNb2R1bGVdLCAvLyBXZSBleHBvcnQgY3VzdG9tIHRyYW5zbGF0aW9uIG1vZHVsZSB0aGF0IGV4dGVuZHMgbmd4LXRyYW5zbGF0ZVxuICBpbXBvcnRzOiBbSHR0cENsaWVudE1vZHVsZV1cbn0pXG5leHBvcnQgY2xhc3MgSTE4bk1vZHVsZSB7XG4gIHN0YXRpYyBwcm92aWRlcnMoKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIHsgcHJvdmlkZTogTE9DQUxFX0lELCB1c2VGYWN0b3J5OiBsb2NhbGVJZCwgZGVwczogW0FwcFN0YXRlU2VydmljZV0gfSxcbiAgICAgIHsgcHJvdmlkZTogSE9PS19QQVRURVJOX01FU1NBR0VTLCB1c2VWYWx1ZTogTUVTU0FHRVMsIG11bHRpOiB0cnVlIH0sXG4gICAgICB7IHByb3ZpZGU6IExPQ0FMRV9QQVRILCB1c2VGYWN0b3J5OiBsb2NhbGVQYXRoRmFjdG9yeSwgZGVwczogW09wdGlvbnNTZXJ2aWNlXSB9LFxuICAgICAgeyBwcm92aWRlOiBMQU5HVUFHRVMsIHVzZUZhY3Rvcnk6IGxhbmd1YWdlc0ZhY3RvcnksIGRlcHM6IFtPcHRpb25zU2VydmljZV0gfSxcblxuICAgICAgLy8gRXh0cmFjdGVkIGZyb20gcHJvamVjdHMvbmd4LXRyYW5zbGF0ZS9jb3JlL3NyYy9wdWJsaWNfYXBpLnRzXG4gICAgICB7XG4gICAgICAgIHByb3ZpZGU6IFRyYW5zbGF0ZUxvYWRlcixcbiAgICAgICAgdXNlRmFjdG9yeTogdHJhbnNsYXRlTG9hZGVyRmFjdG9yeSxcbiAgICAgICAgZGVwczogW0h0dHBDbGllbnQsIE9wdGlvbnNTZXJ2aWNlLCBDYWNoZWRMb2NhbGVEaWN0aW9uYXJ5U2VydmljZSwgTE9DQUxFX1BBVEgsIExBTkdVQUdFU11cbiAgICAgIH0sXG4gICAgICB7IHByb3ZpZGU6IFRyYW5zbGF0ZUNvbXBpbGVyLCB1c2VDbGFzczogVHJhbnNsYXRlRmFrZUNvbXBpbGVyIH0sXG4gICAgICB7IHByb3ZpZGU6IFRyYW5zbGF0ZVBhcnNlciwgdXNlQ2xhc3M6IFRyYW5zbGF0ZVBhcnNlckN1c3RvbSB9LFxuICAgICAgeyBwcm92aWRlOiBNaXNzaW5nVHJhbnNsYXRpb25IYW5kbGVyLCB1c2VDbGFzczogTWlzc2luZ1RyYW5zbGF0aW9uQ3VzdG9tSGFuZGxlciB9LFxuICAgICAgVHJhbnNsYXRlU3RvcmUsXG4gICAgICBOZ3hUcmFuc2xhdGVTZXJ2aWNlLFxuICAgICAgeyBwcm92aWRlOiBVU0VfU1RPUkUsIHVzZVZhbHVlOiB1bmRlZmluZWQgfSxcbiAgICAgIHsgcHJvdmlkZTogVVNFX0RFRkFVTFRfTEFORywgdXNlVmFsdWU6IHVuZGVmaW5lZCB9LFxuICAgICAgeyBwcm92aWRlOiBVU0VfRVhURU5ELCB1c2VWYWx1ZTogZmFsc2UgfSxcbiAgICAgIHsgcHJvdmlkZTogREVGQVVMVF9MQU5HVUFHRSwgdXNlVmFsdWU6IHVuZGVmaW5lZCB9XG4gICAgXTtcbiAgfVxuICBzdGF0aWMgZm9yUm9vdCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IEkxOG5Nb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IEkxOG5Nb2R1bGUucHJvdmlkZXJzKClcbiAgICB9O1xuICB9XG59XG4iXX0=