{"version":3,"file":"c8y-ngx-components-device-profile.js","sources":["../../device-profile/device-profile-navigation.factory.ts","../../device-profile/device-profile.service.ts","../../device-profile/select-configuration-modal.component.ts","../../device-profile/device-profile.model.ts","../../device-profile/device-profile.component.ts","../../device-profile/add-device-profile.component.ts","../../device-profile/device-profile-list.component.ts","../../device-profile/device-profile.guard.ts","../../device-profile/device-tab-profile/device-tab-profile.component.ts","../../device-profile/device-tab-profile/device-tab-profile-detail.component.ts","../../device-profile/device-tab-profile/device-profile-item-list.component.ts","../../device-profile/device-profile.module.ts","../../device-profile/c8y-ngx-components-device-profile.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAIa,8BAA8B;AAAG,IAGtC,GAAG;AACX;AACoC,YADhC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;AACxB,gBAAM,IAAI,CAAC,QAAQ,GAAG,IAAI,aAAa,CAAC;AACxC,oBAAQ,KAAK,EAAE,OAAO,CAAC,iBAAiB,CAAC;AACzC,oBAAQ,IAAI,EAAE,kBAAkB;AAChC,oBAAQ,IAAI,EAAE,oBAAoB;AAClC,oBAAQ,MAAM,EAAE,OAAO,CAAC,YAAY,CAAC;AACrC,iBAAO,CAAC,CAAC;AACT,aAAK;AACL,YAAI,OAAO,IAAI,CAAC,QAAQ,CAAC;AACzB,SAAG;AAEH,KAFG;AACH;0DAfC,UAAU;;;;0BACT;AAAC;AAAC,MCiBS,oBAAoB;AACjC,IAUE,YACU,gBAAkC,EAClC,gBAAkC,EAClC,YAA0B;AACnC,QAHS,qBAAgB,GAAhB,gBAAgB,CAAkB;AAAC,QACnC,qBAAgB,GAAhB,gBAAgB,CAAkB;AAAC,QACnC,iBAAY,GAAZ,YAAY,CAAc;AACtC,QAdW,aAAQ,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC;AAClC,QAAW,WAAM,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,QAAQ,CAAC,CAAC;AACpD,QAEU,0BAAqB,GAAG,OAAO,CAAC,6BAA6B,CAAC,CAAC;AACzE,QAAU,8BAAyB,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;AAClE,QAAU,qBAAgB,GAAG,OAAO,CAChC,iGAAiG,CAClG,CAAC;AACJ,QAMI,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;AACzC,KAAG;AACH,IACE,mBAAmB,CAAC,aAAqC;AAC3D,QAAI,IAAI,GAAG,CAAC,aAAa,EAAE,iBAAiB,CAAC,KAAK,EAAE,EAAE;AACtD,YAAM,OAAO,aAAa,CAAC,UAAU,CAAC,IAAI,CAAC;AAC3C,SAAK;AACL,QAAI,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,aAA+B,CAAC,CAAC;AACzE,KAAG;AACH,IACE,6BAA6B,CAAC,UAAkB;AAAI,QAClD,MAAM,gBAAgB,GAAG;AAC7B,YAAM,IAAI,EAAE;AACZ,gBAAQ,EAAE,iBAAiB,EAAE,UAAU,EAAE;AACzC,gBAAQ,EAAE,iBAAiB,EAAE,EAAE,EAAE;AACjC,gBAAQ,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,iBAAiB,EAAE,EAAE;AAC/C,aAAO;AACP,SAAK,CAAC;AACN,QAAI,OAAO,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;AACpD,KAAG;AACH,IACE,iBAAiB,CAAC,QAAc;AAAI,QAClC,IAAI,KAAK,GAAW;AACxB,YAAM,IAAI,EAAE,aAAa;AACzB,SAAK,CAAC;AACN,QAAI,MAAM,MAAM,GAAW;AAC3B,YAAM,QAAQ,EAAE,GAAG;AACnB,YAAM,cAAc,EAAE,IAAI;AAC1B,SAAK,CAAC;AACN,QAAI,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,KAAK,EAAE,QAAQ,IAAI,EAAE,CAAC,CAAC;AACjE,QAAI,OAAO,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AAC1D,KAAG;AACH,IACQ,mBAAmB,CAAC,QAAyB;AACrD;AAEiB,YAFb,MAAM,MAAM,GAAW;AAC3B,gBAAM,QAAQ;AACd,gBAAM,YAAY,EAAE,mBAAmB;AACvC,gBAAM,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;AAC3C,gBAAM,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;AACvC,gBAAM,MAAM,EAAE,IAAI;AAClB,gBAAM,QAAQ,EAAE,CAAC;AACjB,aAAK,CAAC;AACN,YACI,MAAM,SAAS,GAAG,CAAC,MAAM,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACzE,YAAI,OAAO,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,eAAe,CAAC,UAAU,GAAG,SAAS,GAAG,SAAS,CAAC;AAChG,SAAG;AAEF,KAFE;AACH,IACQ,sBAAsB,CAAC,MAAsB,EAAE,aAAqC;AAC5F;AAEI,YAFA,IAAI,SAAS,CAAC;AAClB,YAAI,MAAM,YAAY,GAAe;AACrC,gBAAM,QAAQ,EAAE,MAAM,CAAC,EAAE;AACzB,gBAAM,SAAS,EAAE,aAAa,CAAC,EAAE;AACjC,gBAAM,WAAW,EAAE,aAAa,CAAC,IAAI;AACrC,gBAAM,iBAAiB,EAAE,aAAa,CAAC,iBAAiB;AACxD,gBAAM,WAAW,EAAE,yBAAyB,aAAa,CAAC,IAAI,cAAc,MAAM,CAAC,IAAI,EAAE;AACzF,aAAK,CAAC;AACN,YAAI,IAAI;AACR,gBAAM,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AACxE,gBAAM,SAAS,GAAG,IAAI,CAAC;AACvB,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB,gBAAM,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC7C,aAAK;AACL,YAAI,OAAO,SAAS,CAAC;AACrB,SAAG;AAEF,KAFE;AACH,IACE,gBAAgB,CACd,MAAsB,EACtB,eAAuC;AACxC,QACC,MAAM,cAAc,GAAG,MAAM,CAAC,YAAY,CAAC;AAC/C,QAAI,MAAM,eAAe,GAAG,GAAG,CAAC,eAAe,EAAE,4BAA4B,CAAC,CAAC;AAC/E,QAAI,MAAM,WAAW,GAAG,EAAE,CAAC;AAC3B,QAAI,MAAM,YAAY,GAAG,EAAE,CAAC;AAC5B,QACI,IAAI,cAAc,EAAE;AACxB,YAAM,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AACvC,SAAK;AACL,QAAI,IAAI,eAAe,EAAE;AACzB,YAAM,YAAY,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;AACzC,SAAK;AACL,QAAI,OAAO,IAAI,CAAC,uBAAuB,CACjC,WAAW,EACX,YAAY,EACZ,MAAM,EACN,SAAS,EACT,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAC1B,CAAC;AACN,KAAG;AACH,IACE,gBAAgB,CACd,MAAsB,EACtB,eAAuC;AACxC,QACC,MAAM,cAAc,GAAG,MAAM,CAAC,gBAAgB,CAAC;AACnD,QAAI,MAAM,eAAe,GAAG,GAAG,CAAC,eAAe,EAAE,4BAA4B,CAAC,CAAC;AAC/E,QAAI,OAAO,IAAI,CAAC,uBAAuB,CACjC,cAAc,EACd,eAAe,EACf,MAAM,EACN,SAAS,EACT,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAC1B,CAAC;AACN,KAAG;AACH,IACE,qBAAqB,CACnB,MAAsB,EACtB,eAAuC;AACxC,QACC,MAAM,mBAAmB,GAAG,EAAE,CAAC;AACnC,QAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG;AACnC,YAAM,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,KAAK,oBAAoB,EAAE;AACrD,gBAAQ,mBAAmB,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;AAC9C,aAAO;AACP,SAAK,CAAC,CAAC;AACP,QAAI,MAAM,oBAAoB,GAAG,GAAG,CAAC,eAAe,EAAE,iCAAiC,CAAC,CAAC;AACzF,QAAI,OAAO,IAAI,CAAC,uBAAuB,CACjC,mBAAmB,EACnB,oBAAoB,EACpB,KAAK,EACL,MAAM,EACN,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAC/B,CAAC;AACN,KAAG;AACH,IACU,QAAQ,CAAC,QAAgB;AAAI,QACnC,MAAM,YAAY,GAAG,CAAC,iBAAmC;AAC7D,YAAM,OAAO,CAAC,iBAAiB,CAAC,MAAM,GAAG,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;AACzE,SAAK,CAAC;AACN,QACI,QAAQ,QAAQ;AACpB,YAAM,KAAK,UAAU,CAAC;AACtB,YAAM,KAAK,UAAU;AACrB,gBAAQ,OAAO,CAAC,iBAAmC;AACnD,oBAAU,OAAO,iBAAiB,CAAC,MAAM;AACzC,wBAAY,iBAAiB,CAAC,OAAO;AACrC,wBAAY,iBAAiB,CAAC,MAAM,CAAC,WAAW,KAAK,iBAAiB,CAAC,OAAO,CAAC,WAAW;AAC1F,0BAAc,IAAI,CAAC,yBAAyB;AAC5C,0BAAc,YAAY,CAAC,iBAAiB,CAAC,CAAC;AAC9C,iBAAS,CAAC;AACV,YAAM,KAAK,eAAe;AAC1B,gBAAQ,OAAO,CAAC,iBAAmC;AACnD,oBAAU,OAAO,iBAAiB,CAAC,MAAM;AACzC,wBAAY,iBAAiB,CAAC,OAAO;AACrC,yBAAa,iBAAiB,CAAC,MAAM,CAAC,QAAQ,KAAK,iBAAiB,CAAC,OAAO,CAAC,QAAQ;AACrF,4BAAc,iBAAiB,CAAC,MAAM,CAAC,WAAW,KAAK,iBAAiB,CAAC,OAAO,CAAC,WAAW,CAAC;AAC7F,0BAAc,IAAI,CAAC,gBAAgB;AACnC,0BAAc,YAAY,CAAC,iBAAiB,CAAC,CAAC;AAC9C,iBAAS,CAAC;AACV,YAAM;AACN,gBAAQ,OAAO,YAAY,CAAC;AAC5B,SAAK;AACL,KAAG;AACH,IACU,uBAAuB,CAC7B,cAAqB,EAAE,EACvB,eAAqE,EAAE,EACvE,eAAuB,EACvB,uBAA+B,EAC/B,QAAyD;AAC1D,QACC,MAAM,aAAa,GAAG,IAAI,CAAC,sCAAsC,CAC/D,WAAW,EACX,eAAe,EACf,uBAAuB,CACxB,CAAC;AACN,QAAI,MAAM,qBAAqB,GAAG,IAAI,CAAC,uCAAuC,CACxE,aAAa,EACb,YAAY,EACZ,eAAe,EACf,uBAAuB,EACvB,QAAQ,CACT,CAAC;AACN,QAAI,OAAO,MAAM,CAAC,OAAO,CAAC,qBAAqB,CAAC,EAAE,MAAM,CAAC,CAAC;AAC1D,KAAG;AACH,IACU,sCAAsC,CAC5C,WAAkB,EAClB,eAAuB,EACvB,uBAA+B;AAChC,QACC,OAAO,WAAW,CAAC,MAAM,CACvB,CAAC,eAAe,EAAE,UAAU,KAC1B,MAAM,CAAC,MAAM,CAAC,eAAe,EAAE;AACvC,YAAU,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;AACzC,gBAAY,MAAM,EAAE;AACpB,oBAAc,QAAQ,EAAE,UAAU,CAAC,IAAI;AACvC,oBAAc,WAAW,EAAE,UAAU,CAAC,uBAAuB,CAAC;AAC9D,oBAAc,OAAO,EAAE,UAAU,CAAC,GAAG;AACrC,iBAAa;AACb,gBAAY,OAAO,EAAE,SAAS;AAC9B,aAAW;AACX,SAAS,CAAC,EACJ,EAAE,CACH,CAAC;AACN,KAAG;AACH,IACU,uCAAuC,CAC7C,aAAqB,EACrB,YAAkE,EAClE,eAAuB,EACvB,uBAA+B,EAC/B,QAAyD;AAC1D,QACC,YAAY,CAAC,OAAO,CAAC,WAAW;AACpC,YAAM,MAAM,iBAAiB,GAAqB;AAClD,gBAAQ,OAAO,EAAE;AACjB,oBAAU,QAAQ,EAAE,WAAW,CAAC,IAAI;AACpC,oBAAU,WAAW,EAAE,WAAW,CAAC,uBAAuB,CAAC;AAC3D,oBAAU,OAAO,EAAE,WAAW,CAAC,GAAG;AAClC,iBAAS;AACT,gBAAQ,MAAM,EAAE,aAAa,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;AAC3D,sBAAY,aAAa,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC,MAAM;AAC9D,sBAAY,SAAS;AACrB,aAAO,CAAC;AACR,YAAM,iBAAiB,CAAC,eAAe,GAAG,QAAQ,CAAC,iBAAiB,CAAC,CAAC;AACtE,YAAM,aAAa,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,GAAG,iBAAiB,CAAC;AACtE,SAAK,CAAC,CAAC;AACP,QAAI,OAAO,aAAa,CAAC;AACzB,KAAG;AACH;gDA5OC,UAAU;0IACT;AAAC;AACU,YAnBX,gBAAgB;AAChB,YAEA,gBAAgB;AAChB,YASO,YAAY;AAAG;;;mJAAE;AAAC;AAAC,MCLf,iCAAiC;AAC9C,IAaE,YAAoB,iBAAoC;AAC1D,QADsB,sBAAiB,GAAjB,iBAAiB,CAAmB;AAAC,QAbzD,UAAK,GAAW,OAAO,CAAC,sBAAsB,CAAC,CAAC;AAClD,QAAE,SAAI,GAAkB,IAAI,OAAO,EAAE,CAAC;AACtC,QAAE,mBAAc,GAAsB,IAAI,CAAC,IAAI,CAAC,IAAI,CAChD,SAAS,CAAC,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC,EAChC,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CACxC,CAAC;AACJ,QAAE,kBAAa,GAAwB,IAAI,YAAY,EAAO,CAAC;AAC/D,QACE,oBAAe,GAAQ,EAAE,CAAC;AAC5B,QAAE,gBAAW,GAAQ,EAAE,CAAC;AACxB,QAAE,WAAM,GAAgB,EAAE,EAAE,EAAE,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC;AAChD,QAGI,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;AACzC,KAAG;AACH,IACE,MAAM,CAAC,UAAU;AACnB,QAAI,IAAI,CAAC,UAAU,EAAE;AACrB,YAAM,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;AAC5B,SAAK;AAAC,aAAK;AACX,YAAM,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAC7C,EAAE,IAAI,EAAE,IAAI,UAAU,GAAG,EAAE,EAC3B,EAAE,iBAAiB,EAAE,IAAI,UAAU,GAAG,EAAE,CACzC,CAAC;AACR,SAAK;AACL,QAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;AACrB,KAAG;AACH,IACE,MAAM,CAAC,aAAa;AACtB,QAAI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;AAC3C,KAAG;AACH,IACE,QAAQ;AACV,QAAI,OAAO,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,cAAc,CAAC,aAAa,EAAE;AACtF,YAAM,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC;AACjF,YAAM,MAAM,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE;AAC/B,SAAK,CAAC,CAAC;AACP,KAAG;AACH,IACE,SAAS,CAAC,GAAqB;AAAI,QACjC,MAAM,aAAa,GAAU,IAAI,CAAC,QAAQ,CAAC;AAC/C,QAAI,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,IAAI;AAChC,YAAM,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,IAAI,CAAC;AACnE,YAAM,MAAM,QAAQ,GACZ,aAAa,IAAI,aAAa,CAAC,MAAM,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;AACtF,YAAM,MAAM,iBAAiB,GAAuB;AACpD,gBAAQ,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC;AACpC,gBAAQ,GAAG,EAAE,IAAI;AACjB,gBAAQ,QAAQ;AAChB,aAAO,CAAC;AACR,YAAM,IAAI,iBAAiB,GAAuB,GAAG,CAAC,IAAI,CAClD,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,iBAAiB,CAC9B,CAAC;AAC9B,YAAM,IAAI,iBAAiB,EAAE;AAC7B,gBAAQ,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAC1D,aAAO;AAAC,iBAAK;AACb,gBAAQ,iBAAiB,GAAG;AAC5B,oBAAU,OAAO,EAAE,IAAI,CAAC,EAAE;AAC1B,oBAAU,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,iBAAiB,EAAE,CAAC;AACnD,oBAAU,OAAO,EAAE,CAAC,iBAAiB,CAAC;AACtC,iBAAS,CAAC;AACV,gBAAQ,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;AACpC,aAAO;AACP,YAAM,OAAO,GAAG,CAAC;AACjB,SAAK,EAAE,EAAE,CAAC,CAAC;AACX,KAAG;AACH;6DAxEC,SAAS,SAAC,kBACT,QAAQ,EAAE,gCAAgC,kBAC1C;iOAA0D,cAC3D;;;;;;;mGACI;AAAC;AACU,YAPP,iBAAiB;AAAG;;;;;;;kFAAE;AAAC;AAAC,IC6CrB;AAAZ,WAAY,sBAAsB;AACjC,IAAC,6DAAmC,CAAA;AACrC,CAAC,EAFW,sBAAsB,KAAtB,sBAAsB;AAC5B;AAAC,MC3BM,sBAAsB;AAAG,IAQpC,YACU,KAAqB,EACrB,YAA0B,EAC1B,gBAAkC,EAClC,QAAkB,EAClB,iBAAoC,EACpC,OAAuB,EACvB,iBAAoC;AAC7C,QAPS,UAAK,GAAL,KAAK,CAAgB;AAAC,QACtB,iBAAY,GAAZ,YAAY,CAAc;AAAC,QAC3B,qBAAgB,GAAhB,gBAAgB,CAAkB;AAAC,QACnC,aAAQ,GAAR,QAAQ,CAAU;AAAC,QACnB,sBAAiB,GAAjB,iBAAiB,CAAmB;AAAC,QACrC,YAAO,GAAP,OAAO,CAAgB;AAAC,QACxB,sBAAiB,GAAjB,iBAAiB,CAAmB;AAChD,QAfE,wBAAmB,GAAG,OAAO,CAC3B,8IAA8I,CAC/I,CAAC;AACJ,QAaI,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;AACzC,KAAG;AACH,IACQ,QAAQ;AAChB;AACA,YADI,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC7D,YAAI,IAAI,CAAC,aAAa,IAAI,MAAM,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAkB,CAAC;AACnF,YAAI,IAAI,IAAI,CAAC,aAAa,EAAE;AAC5B,gBAAM,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;AACjD,gBAAM,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,EAAE;AAC1D,oBAAQ,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,GAAG,EAAE,CAAC;AAC3D,iBAAO;AACP,gBAAM,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa,EAAE;AAC/D,oBAAQ,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa,GAAG,EAAE,CAAC;AAChE,iBAAO;AACP,aAAK;AACL,SAAG;AAEF,KAFE;AACH,IACE,WAAW;AACb,QAAI,MAAM,YAAY,GAEd;AACR,YAAM,eAAe,EAAE,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,QAAQ,CAAC;AACvE,YAAM,cAAc,EAAE,cAAc,CAAC,QAAQ;AAC7C,YAAM,gCAAgC,EAAE,WAAW,IAC3C,IAAI,CAAC,iCAAiC,CACpC,WAAW,CAAC,OAAO,CAAC,UAAU,EAC9B,cAAc,CAAC,QAAQ,CACxB;AACT,YAAM,IAAI,EAAE,cAAc;AAC1B,YAAM,KAAK,EAAE,OAAO,CAAC,iBAAiB,CAAC;AACvC,YAAM,IAAI,EAAE,kBAAkB,CAAC,MAAM;AACrC,SAAK,CAAC;AACN,QAAI,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,8BAA8B,EAAE;AACpE,YAAM,mBAAmB,EAAE,IAAI;AAC/B,YAAM,YAAY;AAClB,SAAK,CAAC,CAAC;AACP,QACI,IAAI,YAAY,CAAC,gCAAgC,EAAE;AACvD,YAAM,KAAK,CAAC,OAAO,CAAC,8BAA8B,GAAG,YAAY,CAAC,gCAAgC,CAC1F,KAAK,CACN,CAAC;AACR,SAAK;AACL,QACI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;AAC9B,QAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,YAAY;AACpE,YAAM,MAAM,CAAC,QAAQ,CAAC,GAAG,YAAY,CAAC;AACtC,YAAM,IAAI,CAAC,QAAQ,EAAE;AACrB,gBAAQ,OAAO;AACf,aAAO;AACP,YAAM,MAAM,oBAAoB,GAA4B;AAC5D,gBAAQ,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB,IAAI,EAAE;AACrE,aAAO,CAAC;AACR,YAAM,MAAM,CAAC,oBAAoB,CAAC,iBAAiB,EAAE;AACrD,gBAAQ,QAAQ,EAAE;AAClB,oBAAU,IAAI,EAAE,QAAQ,CAAC,IAAI;AAC7B,oBAAU,OAAO,EAAE,QAAQ,CAAC,OAAO;AACnC,oBAAU,GAAG,EAAE,QAAQ,CAAC,GAAG;AAC3B,oBAAU,OAAO,EAAE,QAAQ,CAAC,OAAO;AACnC,oBAAU,eAAe,EAAE,QAAQ,CAAC,eAAe;AACnD,iBAAkC;AAClC,aAAO,CAAC,CAAC;AACT,YAAM,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,CAAC;AACrD,SAAK,CAAC,CAAC;AACP,KAAG;AACH,IACE,iCAAiC,CAC/B,WAAoC,EACpC,QAAwB;AACzB,QACC,OAAO,WAAW,CAAC,IAAI,CACrB,oBAAoB,EAAE,EACtB,SAAS,CAAC,UAAU,IAClB,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,QAAQ,EAAE;AAC/D,YAAU,WAAW,EAAE,UAAU;AACjC,YAAU,MAAM,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE;AACnC,YAAU,UAAU,EAAE,IAAI;AAC1B,SAAS,CAAC,CACH,EACD,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,EACvB,GAAG,CAAC,GAAG,IAAI,IAAI,CAAC,8BAA8B,CAAC,GAAG,CAAC,CAAC,EACpD,WAAW,CAAC,CAAC,CAAC,CACf,CAAC;AACN,KAAG;AACH,IACE,8BAA8B,CAAC,GAAqB;AACtD,QAAI,GAAG,CAAC,OAAO,CAAC,EAAE;AAClB,YAAM,EAAE,CAAC,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAChE,SAAK,CAAC,CAAC;AACP,QAAI,OAAO,GAAG,CAAC;AACf,KAAG;AACH,IACE,gBAAgB;AAClB,QAAI,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iCAAiC,EAAE;AACvE,YAAM,mBAAmB,EAAE,IAAI;AAC/B,SAAK,CAAC,CAAC;AACP,QAAI,KAAK,CAAC,OAAO,CAAC,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;AAC1F,QAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa,CAAC;AAChF,QAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;AAC9B,QAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,sBAAsB;AAC9E,YAAM,MAAM,cAAc,GAAiC,sBAAsB,CAAC,GAAG,CAC7E,YAAY;AACpB,gBAAU,OAAO,MAAM,CACX;AACZ,oBAAc,GAAG,EAAE,YAAY,CAAC,GAAG;AACnC,oBAAc,IAAI,EAAE,YAAY,CAAC,IAAI;AACrC,iBAAa,EACD,YAAY,CAAC,iBAAiB,GAAG,EAAE,IAAI,EAAE,YAAY,CAAC,iBAAiB,EAAE,GAAG,EAAE,CAC/E,CAAC;AACZ,aAAS,CACF,CAAC;AACR,YAAM,MAAM,MAAM,GAA+B,MAAM,CAC/C,cAAc,EACd,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa,IAAI,EAAE,CACzD,CAAC;AACR,YAAM,MAAM,aAAa,GAA+B,QAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM;AACxF,gBAAQ,OAAO,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,CAAC;AACzE,aAAO,CAAC,CAAC;AACT,YAAM,MAAM,oBAAoB,GAA4B;AAC5D,gBAAQ,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB,IAAI,EAAE;AACrE,aAAO,CAAC;AACR,YAAM,MAAM,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;AACxE,YAAM,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,CAAC;AACrD,SAAK,CAAC,CAAC;AACP,KAAG;AACH,IACE,WAAW;AACb,QAAI,MAAM,YAAY,GAEd;AACR,YAAM,eAAe,EAAE,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,QAAQ,CAAC;AACvE,YAAM,cAAc,EAAE,cAAc,CAAC,QAAQ;AAC7C,YAAM,gCAAgC,EAAE,WAAW,IAC3C,IAAI,CAAC,iCAAiC,CACpC,WAAW,CAAC,OAAO,CAAC,UAAU,EAC9B,cAAc,CAAC,QAAQ,CACxB;AACT,YAAM,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ;AAC7D,YAAM,IAAI,EAAE,WAAW;AACvB,YAAM,KAAK,EAAE,OAAO,CAAC,iBAAiB,CAAC;AACvC,YAAM,IAAI,EAAE,kBAAkB,CAAC,KAAK;AACpC,SAAK,CAAC;AACN,QAAI,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,8BAA8B,EAAE;AACpE,YAAM,mBAAmB,EAAE,IAAI;AAC/B,YAAM,YAAY;AAClB,SAAK,CAAC,CAAC;AACP,QACI,IAAI,YAAY,CAAC,gCAAgC,EAAE;AACvD,YAAM,KAAK,CAAC,OAAO,CAAC,8BAA8B,GAAG,YAAY,CAAC,gCAAgC,CAC1F,KAAK,CACN,CAAC;AACR,SAAK;AACL,QACI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;AAC9B,QAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,gBAAgB;AACxE,YAAM,MAAM,cAAc,GAA4B,gBAAgB,CAAC,GAAG,CAAC,YAAY;AACvF,gBAAQ,OAAO;AACf,oBAAU,IAAI,EAAE,YAAY,CAAC,IAAI;AACjC,oBAAU,OAAO,EAAE,YAAY,CAAC,OAAO;AACvC,oBAAU,GAAG,EAAE,YAAY,CAAC,GAAG;AAC/B,oBAAU,MAAM,EAAE,SAAS;AAC3B,iBAAS,CAAC;AACV,aAAO,CAAC,CAAC;AACT,YAAM,MAAM,MAAM,GAA0B,MAAM,CAC1C,cAAc,EACd,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,IAAI,EAAE,CACpD,CAAC;AACR,YAAM,MAAM,QAAQ,GAA0B,QAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM;AAC9E,gBAAQ,OAAO,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,CAAC;AACzE,aAAO,CAAC,CAAC;AACT,YAAM,MAAM,oBAAoB,GAA4B;AAC5D,gBAAQ,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB,IAAI,EAAE;AACrE,aAAO,CAAC;AACR,YAAM,MAAM,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,EAAE,QAAQ,EAAE,CAAC,CAAC;AACnE,YAAM,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,CAAC;AACrD,SAAK,CAAC,CAAC;AACP,KAAG;AACH,IACE,IAAI,oBAAoB;AAC1B,QAAI,MAAM,UAAU,GACd,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ;AACnD,YAAM,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;AAC/D,QAAI,MAAM,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;AAC9E,QAAI,MAAM,eAAe,GACnB,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa;AACxD,YAAM,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;AACpE,QAAI,OAAO,UAAU,IAAI,UAAU,IAAI,eAAe,CAAC;AACvD,KAAG;AACH,IACE,UAAU,CAAC,WAAW,EAAE,QAAQ;AAClC,QAAI,MAAM,oBAAoB,GAA4B;AAC1D,YAAM,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB;AAC7D,SAAK,CAAC;AACN,QAAI,MAAM,QAAQ,GAAG,oBAAoB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,MAAM,CACtE,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC,CACpC,CAAC;AACN,QAAI,oBAAoB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,GAAG,QAAQ,CAAC;AAChE,QAAI,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,CAAC;AACnD,KAAG;AACH,IACE,cAAc;AAChB,QAAI,OAAO,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,QAAQ,CAAC;AACzD,QAAI,IAAI,CAAC,mBAAmB,CAAC,EAAE,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,iBAAiB,EAAE,CAAC,CAAC;AAC1F,KAAG;AACH,IACQ,mBAAmB,CAAC,oBAAoB;AAChD;AAA8D,YAA1D,IAAI,oBAAoB,CAAC,UAAU,IAAI,oBAAoB,CAAC,UAAU,CAAC,IAAI,KAAK,EAAE,EAAE;AACxF,gBAAM,OAAO,oBAAoB,CAAC,UAAU,CAAC,IAAI,CAAC;AAClD,aAAK;AACL,YAAI,MAAM,CAAC,MAAM,CAAC,oBAAoB,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,EAAE,CAAC,CAAC;AACvE,YAAI,IAAI;AACR,gBAAM,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC;AAChF,gBAAM,IAAI,CAAC,aAAa,GAAG,IAAqB,CAAC;AACjD,gBAAM,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;AACjD,gBAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC;AACpE,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB,gBAAM,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC7C,aAAK;AACL,SAAG;AAEF,KAFE;AACH,IACgB,gBAAgB,CAAC,SAAS;AAC1C;AACoD,YADhD,IAAI;AACR,gBAAM,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACrE,gBAAM,OAAO,IAAI,CAAC;AAClB,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB,gBAAM,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC7C,aAAK;AACL,SAAG;AAEF,KAFE;AACH,IACU,kBAAkB,CAAC,cAAc;AAC3C,QAAI,IACE,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,iBAAiB,CAAC;AAChD,YAAM,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,IAAI,CAAC,EAC5C;AACN,YAAM,IAAI,cAAc,KAAK,cAAc,CAAC,aAAa,EAAE;AAC3D,gBAAQ,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CACjC,EAAE,UAAU,EAAE,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,IAAI,EAAE,EAClD,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,YAAY,EAAE,EAAE,CACnC,CAAC;AACV,aAAO;AAAC,iBAAK;AACb,gBAAQ,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CACjC,EAAE,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,IAAI,EAAE,EACzD,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,iBAAiB,EAAE,EAAE,CACxC,CAAC;AACV,aAAO;AACP,SAAK;AACL,QAAI,OAAO,EAAE,CAAC;AACd,KAAG;AACH;kDA5QC,SAAS,SAAC,kBACT,QAAQ,EAAE,oBAAoB,kBAC9B;;;;;;;;;;;;;;;;;imBAEG;AAAC;AAAgD,YAtB7C,cAAc;AAAI,YAOlB,YAAY;AAAI,YACA,gBAAgB;AAAI,YATpC,QAAQ;AAAI,YAQE,iBAAiB;AAAI,YAEnC,cAAc;AAAI,YAOlB,iBAAiB;AAAG;;;;;uxMAImB,cAC/C;;qRAL8B;AAAC;AAAC,MCRpB,yBAAyB;AACtC,IAeE,YAAoB,KAAiB,EAAU,oBAA0C;AAAI,QAAzE,UAAK,GAAL,KAAK,CAAY;AAAC,QAAS,yBAAoB,GAApB,oBAAoB,CAAsB;AAAC,QAf1F,wBAAmB,GAAG,OAAO,CAAC,8IAA8I,CAAC,CAAC;AAChL,QAAE,kBAAa,GAA2B;AAC1C,YAAI,IAAI,EAAE,EAAE;AACZ,YAAI,IAAI,EAAE,aAAa;AACvB,YAAI,UAAU,EAAE,EAAE;AAClB,YAAI,iBAAiB,EAAG,EACnB;AACL,SAAG,CAAC;AACJ,QAAE,WAAM,GAAiB,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM;AACrD,YAAI,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC;AACzB,YAAI,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AAC1B,SAAG,CAAC,CAAC;AACL,KAG+F;AAC/F,IACQ,MAAM;AACd;AAA8D,YAA1D,MAAM,EAAE,GAAG,CAAC,MAAM,IAAI,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,CAAC;AAC9F,YAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AACtB,SAAG;AAEF,KAFE;AACH,IACE,KAAK;AACP,QAAI,IAAI,CAAC,OAAO,EAAE,CAAC;AACnB,QAAI,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;AACtB,KAAG;AACH;qDA/BC,SAAS,SAAC,kBACT,QAAQ,EAAE,wBAAwB,kBAClC;;;;;;;;;;;;;;;;;;gBAAkD,cACnD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gYACI;AAAC;AACU,YAVP,UAAU;AAAI,YAEd,oBAAoB;AAAG;;;;;;;2GAAE;AAAC;AAAC,MCavB,0BAA0B;AAAG,IASxC,YACU,gBAAkC,EAClC,gBAAkC,EAClC,YAA0B,EAC1B,YAA0B,EAC1B,cAA8B,EAC9B,MAAc,EACd,oBAA0C;AACnD,QAPS,qBAAgB,GAAhB,gBAAgB,CAAkB;AAAC,QACnC,qBAAgB,GAAhB,gBAAgB,CAAkB;AAAC,QACnC,iBAAY,GAAZ,YAAY,CAAc;AAAC,QAC3B,iBAAY,GAAZ,YAAY,CAAc;AAAC,QAC3B,mBAAc,GAAd,cAAc,CAAgB;AAAC,QAC/B,WAAM,GAAN,MAAM,CAAQ;AAAC,QACf,yBAAoB,GAApB,oBAAoB,CAAsB;AACtD,QAhBE,cAAS,GAAY,KAAK,CAAC;AAC7B,QAAE,WAAM,GAA0B,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;AAC5D,QAAE,oBAAe,GAA4C,IAAI,CAAC,MAAM,CAAC,IAAI,CACzE,GAAG,CAAC,OAAO,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,EAClC,SAAS,CAAC,MAAM,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,CAAC,EAC9D,GAAG,CAAC,OAAO,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,CAAC,CACpC,CAAC;AACJ,KASM;AACN,IACE,QAAQ;AACV,QAAI,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC9B,KAAG;AACH,IACE,kBAAkB;AACpB,QAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AACvB,KAAG;AACH,IACQ,mBAAmB;AAC3B;AAA8D,YAA1D,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,yBAAyB,EAAE;AACtE,gBAAM,KAAK,EAAE,UAAU;AACvB,aAAK,CAAC,CAAC,OAAoC,CAAC;AAC5C,YAAI,IAAI;AACR,gBAAM,MAAM,SAAS,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC;AAC3C,gBAAM,KAAK,CAAC,KAAK,EAAE,CAAC;AACpB,gBAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,oBAAoB,SAAS,EAAE,CAAC,CAAC;AACjE,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB;AAGA,aAFK;AACL,SAAG;AAEF,KAFE;AACH,IACQ,sBAAsB,CAAC,aAAa;AAC5C;AACmB,YADf,MAAM,IAAI,GAAG,SAAS,CAAC,aAAa,CAAC,CAAC;AAC1C,YAAI,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;AACnB,YAAI,IAAI,CAAC,IAAI,GAAG,eAAe,GAAG,aAAa,CAAC,IAAI,CAAC;AACrD,YAAI,MAAM,EAAE,GAAG,CAAC,MAAM,IAAI,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC;AAChF,YAAI,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,oBAAoB,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;AAC3D,SAAG;AAEF,KAFE;AACH,IACQ,mBAAmB,CAAC,aAAa;AACzC;AACY,YADR,MAAM,iBAAiB,GAAG,aAAa,CAAC,IAAI,CAAC;AACjD,YAAI,MAAM,KAAK,GAAG,OAAO,CAAC,uBAAuB,CAAC,CAAC;AACnD,YAAI,MAAM,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACpD,OAAO,CAAC,qEAAqE,CAAC,EAC9E,EAAE,iBAAiB,EAAE,CACtB,CAAC;AACN,YAAI,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC;AAC5F,YAAI,IAAI;AACR,gBAAM,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAC7B,KAAK,EACL,GAAG,gBAAgB,IAAI,aAAa,EAAE,EACtC,MAAM,CAAC,MAAM,EACb;AACR,oBAAU,EAAE,EAAE,OAAO,CAAC,QAAQ,CAAC;AAC/B,iBAAS,CACF,CAAC;AACR,gBAAM,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;AAC1C,gBAAM,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AACzB,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB;AAGA,aAFK;AACL,SAAG;AAEF,KAFE;AACH,IACgB,MAAM,CAAC,SAAS;AAChC;AACoD,YADhD,IAAI;AACR,gBAAM,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACpD,gBAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC;AACpE,aAAK;AAAC,YAAA,OAAO,EAAE,EAAE;AACjB,gBAAM,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC7C,aAAK;AACL,SAAG;AAEH,KAFG;AACH;sDApFC,SAAS,SAAC,kBACT,QAAQ,EAAE,yBAAyB,kBACnC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAAmD,cACpD;;;;;;;;;;;;;;;;;iaACI;AAAC;AAAoD,YAfjC,gBAAgB;AAAI,YACpC,gBAAgB;AAAI,YACG,YAAY;AAAI,YAAvC,YAAY;AAAI,YAEhB,cAAc;AAAI,YAGlB,MAAM;AAAI,YADV,oBAAoB;AAAG;;;;;;;4QAAE;AAAC;AAAC,MCDvB,kBAAkB;AAAG,IAChC,WAAW,CAAC,KAA6B,EAAE,KAA0B;AACvE,QAAI,MAAM,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,WAAW,IAAI,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;AAChF,QAAI,IAAI,CAAC,WAAW,EAAE;AACtB,YAAM,OAAO,KAAK,CAAC;AACnB,SAAK;AACL,QAAI,OAAO,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,sBAAsB,CAAC,aAAa,CAAC,CAAC;AACzF,KAAG;AACH,IACU,qBAAqB,CAAC,EAAkB,EAAE,SAAiC;AACrF,QAAI,MAAM,SAAS,GAAG,EAAE,CAAC,uBAAuB,IAAI,EAAE,CAAC;AACvD,QAAI,IAAI,CAAC,SAAS,EAAE;AACpB,YAAM,OAAO,KAAK,CAAC;AACnB,SAAK;AACL,QAAI,OAAO,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,IAAI,kBAAkB,KAAK,SAAS,CAAC,CAAC;AACpF,KAAG;AACH;8CAjBC,UAAU;;;;0BACT;AAAC;AAAC,MCaS,yBAAyB;AAAG,IAgBvC,YACS,cAA4C,EAC3C,oBAA0C,EAC1C,KAAqB,EACrB,iBAA2C,EAC3C,YAA0B;AACnC,QALQ,mBAAc,GAAd,cAAc,CAA8B;AAAC,QAC5C,yBAAoB,GAApB,oBAAoB,CAAsB;AAAC,QAC3C,UAAK,GAAL,KAAK,CAAgB;AAAC,QACtB,sBAAiB,GAAjB,iBAAiB,CAA0B;AAAC,QAC5C,iBAAY,GAAZ,YAAY,CAAc;AACtC,QAjBE,kBAAa,GAAuB,EAAE,CAAC;AACzC,QAAE,kBAAa,GAAuB,EAAE,CAAC;AACzC,QAAE,uBAAkB,GAAuB,EAAE,CAAC;AAC9C,QAEE,YAAO,GAAW,EAAE,CAAC;AACvB,QAAE,cAAS,GAAY,KAAK,CAAC;AAC7B,KAUM;AACN,IACQ,QAAQ;AAChB;AAA8D,YAA1D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;AAC9D,YAAI,IAAI,CAAC,sCAAsC,EAAE,CAAC;AAClD,YAAI,IAAI,CAAC,yBAAyB,EAAE,CAAC;AACrC,SAAG;AAEF,KAFE;AACH,IACQ,sCAAsC;AAC9C;AACmC,YAD/B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AAC1B,YAAI,IAAI,CAAC,cAAc,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,6BAA6B,CACjF,IAAI,CAAC,MAAM,CAAC,IAAI,CACjB,CAAC;AACN,YAAI,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;AACjC,gBAAM,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC;AAC1D,gBAAM,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC;AACtF,aAAK;AACL,YAAI,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;AAC/D,YAAI,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;AACzF,YAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;AACjC,YAAI,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;AAC3B,SAAG;AAEF,KAFE;AACH,IACE,aAAa,CAAC,EAAiB;AACjC,QAAI,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;AAC9B,QAAI,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;AAC/D,KAAG;AACH,IACQ,eAAe;AACvB;AAA8D,YAA1D,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,sBAAsB,CACrE,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,eAAe,CACrB,CAAC;AACN,SAAG;AAEF,KAFE;AACH,IACE,OAAO,CAAC,SAAiB;AAC3B,QAAI,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;AAC7B,QAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CACpB,GAAG,CAAC,CAAC,IAAW;AACtB,YAAQ,OAAO,IAAI,CAAC,MAAM,CAChB,CAAC,EAAO,KAAK,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,CAAC,CACpF,CAAC;AACV,SAAO,CAAC,CACH,CAAC;AACN,KAAG;AACH,IACE,WAAW;AACb,QAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;AAC9C,QAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;AAC9C,QAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;AAC9C,KAAG;AACH,IACE,kBAAkB,CAAC,MAAM,EAAE,OAAO;AACpC,QAAI,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AACrF,QAAI,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AACrF,QAAI,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,oBAAoB,CAAC,qBAAqB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AAC/F,KAAG;AACH,IACU,yBAAyB;AACnC,QAAI,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,cAAc;AACrD,aAAO,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;AAChC,aAAO,SAAS,CAAC,CAAC,aAA6B;AAC/C,YAAQ,IAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;AACrE,SAAO,CAAC,CAAC;AACT,QAAI,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC;AAC1F,YAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CACtB,OAAO,CACL,sFAAsF,CACvF,CACF,CAAC;AACR,YAAM,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,UAAU,CAAC;AACxC,SAAK,CAAC,CAAC;AACP,KAAG;AACH,IACU,qBAAqB;AAC/B,QAAI,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,iBAAiB;AACxD,aAAO,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;AAC7B,aAAO,IAAI,CACH,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,IAAkB,CAAC,EACrC,MAAM,CAAC,SAAS,IAAI,SAAS,CAAC,iBAAiB,CAAC,CACjD;AACP,aAAO,SAAS,CAAC,SAAS;AAC1B,YAAQ,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;AACnC,SAAO,CAAC,CAAC;AACT,KAAG;AACH;qDAhHC,SAAS,SAAC,kBACT,QAAQ,EAAE,wBAAwB,kBAClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAAkD,kBAClD,SAAS,EAAE,CAAC;mBAA4B,CAAC,cAC1C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ohBACI;AAAC;AAAmD,YATvD,4BAA4B;AAC5B,YANO,oBAAoB;AAAI,YAHxB,cAAc;AAAI,YASzB,wBAAwB;AACvB,YAJD,YAAY;AACb;;;;;;;;wOAAE;AAAC;AAAC,MCFQ,+BAA+B;AAC5C,IALA;AACG,QAMQ,mBAAc,GAAW,EAAE,CAAC;AACvC,QAAW,sBAAiB,GAAW,EAAE,CAAC;AAC1C,QAGW,kBAAa,GAAY,IAAI,CAAC;AACzC,KAAC;AACD;2DAdC,SAAS,SAAC,kBACT,QAAQ,EAAE,+BAA+B;KACzC;;;;;;;KAAyD,cAC1D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8NACI;AAAC;AACI,2BAAP,KAAK;AAAK,0BACV,KAAK;AAAK,6BACV,KAAK;AAAK,gCACV,KAAK;AAAK,gCACV,KAAK;AAAK,sBACV,KAAK;AAAK,oBACV,KAAK;AAAK,4BACV,KAAK;AAAI;;;;;;;;;;;;;;;;;;;;;;;oBAAE;AAAC;AAAC,MCRH,8BAA8B;AAC3C;0DALC,SAAS,SAAC,kBACT,QAAQ,EAAE,8BAA8B;MACxC;;;;;0PAEG;AAAC;AACI,mBAAP,KAAK;AAAK,gCACV,KAAK;AAAK,+BACV,KAAK;AAAK,4BACV,KAAK;AAAI;;;eAN8C;YACzD;;;;;;;;;;;oBAKa;AAAC;ACiBf,MAAM,oBAAoB,GAAY;AACtC,IAAE;AACF,QAAI,IAAI,EAAE,qBAAqB;AAC/B,QAAI,SAAS,EAAE,sBAAsB;AACrC,KAAG;AACH,IAAE;AACF,QAAI,IAAI,EAAE,iBAAiB;AAC3B,QAAI,SAAS,EAAE,0BAA0B;AACzC,KAAG;AACH,CAAC,CAAC;AAEF,MAAM,sBAAsB,GAAU;AACtC,IAAE;AACF,QAAI,OAAO,EAAE,WAAW,CAAC,MAAM;AAC/B,QAAI,IAAI,EAAE,gBAAgB;AAC1B,QAAI,SAAS,EAAE,yBAAyB;AACxC,QAAI,KAAK,EAAE,OAAO,CAAC,gBAAgB,CAAC;AACpC,QAAI,IAAI,EAAE,oBAAoB;AAC9B,QAAI,WAAW,EAAE,CAAC,kBAAkB,CAAC;AACrC,KAAG;AACH,CAAC,CAAC;AACF,WAqCgB;AAChB,MAMa,mBAAmB;AAAG;+CA3ClC,QAAQ,SAAC,kBACR,YAAY,EAAE;KACZ,sBAAsB,sBACtB,0BAA0B;AAC1B,yBAAyB,sBACzB;AAAiC;YACjC,yBAAyB;gBACzB,+BAA+B;eAC/B;;;AAA8B,kBAC/B;GACD,OAAO,EAAE,EAAE;MACX,OAAO,EAAE;;EACP,UAAU;IACV,YAAY;WACZ;QAAgB;MAChB,YAAY,CAAC;CAAQ,CAAC,oBAAoB,CAAC;eAC3C,gBAAgB,CAAC,OAAO,EAAE;MAC1B,aAAa;CACb,mBAAmB;eACnB,aAAa;iBACb;GAAa,sBACb;0BAA4B;GAC7B;MACD,eAAe,EAAE,sBACf,yBAAyB,sBACzB;UAAiC;QACjC;gBAAyB;EAC1B,kBACD,SAAS,EAAE;SACT,0BACE,OAAO,EAAE;gBAAoB,0BAC7B;GAAQ,EAAE,8BAA8B;MACxC,KAAK,EAAE,IAAI,sBACZ;cACD,0BACE,OAAO,EAAE;MAAU,0BACnB,QAAQ,IAAwB;;AAChC,KAAK,EAAE,IAAI;IACZ,sBACD;mBAAoB;SACpB,kBAAkB;WACnB,cACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDACI;AAAC;AC7FN;AACA;AACA;AACA;AACA;AAI0M","sourcesContent":["import { Injectable } from '@angular/core';\nimport { gettext, NavigatorNode, NavigatorNodeFactory } from '@c8y/ngx-components';\n\n@Injectable()\nexport class DeviceProfileNavigationFactory implements NavigatorNodeFactory {\n  nodeItem: NavigatorNode;\n\n  async get() {\n    if (!this.nodeItem) {\n      this.nodeItem = new NavigatorNode({\n        label: gettext('Device profiles'),\n        path: '/device-profiles',\n        icon: 'c8y-device-profile',\n        parent: gettext('Management')\n      });\n    }\n    return this.nodeItem;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  IManagedObject,\n  InventoryService,\n  IOperation,\n  IResultList,\n  OperationService,\n  OperationStatus,\n  QueriesUtil\n} from '@c8y/client';\nimport {\n  DeviceProfile,\n  DeviceProfileFirmware,\n  DeviceProfileSoftware,\n  ComparisonResult\n} from './device-profile.model';\nimport { AlertService } from '@c8y/ngx-components';\nimport { sortBy, toArray, get } from 'lodash-es';\nimport { gettext } from '@c8y/ngx-components';\n\n@Injectable()\nexport class DeviceProfileService {\n  readonly dateFrom = new Date(0);\n  readonly dateTo = new Date(Date.now() + 86400000); // 1 day in the future\n  private queriesUtil: QueriesUtil;\n\n  private NOT_INSTALLED_WARNING = gettext('Not installed on the device');\n  private VERSION_MISSMATCH_WARNING = gettext('Version mismatch');\n  private SAME_URL_WARNING = gettext(\n    'Installed configuration has the same URL but different name or type than the one in the profile'\n  );\n\n  constructor(\n    private inventoryService: InventoryService,\n    private operationService: OperationService,\n    private alertService: AlertService\n  ) {\n    this.queriesUtil = new QueriesUtil();\n  }\n\n  createDeviceProfile(deviceProfile: Partial<DeviceProfile>) {\n    if (get(deviceProfile, 'c8y_Filter.type') === '') {\n      delete deviceProfile.c8y_Filter.type;\n    }\n    return this.inventoryService.create(deviceProfile as IManagedObject);\n  }\n\n  getDeviceProfilesByDeviceType(deviceType: string): Promise<IResultList<IManagedObject>> {\n    const deviceTypeFilter = {\n      __or: [\n        { 'c8y_Filter.type': deviceType },\n        { 'c8y_Filter.type': '' },\n        { __not: { __has: 'c8y_Filter.type' } }\n      ]\n    };\n    return this.getDeviceProfiles(deviceTypeFilter);\n  }\n\n  getDeviceProfiles(andQuery?: any): Promise<IResultList<IManagedObject>> {\n    let query: object = {\n      type: 'c8y_Profile'\n    };\n    const filter: object = {\n      pageSize: 100,\n      withTotalPages: true\n    };\n    query = this.queriesUtil.addAndFilter(query, andQuery || {});\n    return this.inventoryService.listQuery(query, filter);\n  }\n\n  async getProfileOperation(deviceId: string | number) {\n    const filter: object = {\n      deviceId,\n      fragmentType: 'c8y_DeviceProfile',\n      dateFrom: this.dateFrom.toISOString(),\n      dateTo: this.dateTo.toISOString(),\n      revert: true,\n      pageSize: 1\n    };\n\n    const operation = (await this.operationService.list(filter)).data[0];\n    return operation && operation.status !== OperationStatus.SUCCESSFUL ? operation : undefined;\n  }\n\n  async createProfileOperation(device: IManagedObject, deviceProfile: Partial<DeviceProfile>) {\n    let operation;\n    const operationCfg: IOperation = {\n      deviceId: device.id,\n      profileId: deviceProfile.id,\n      profileName: deviceProfile.name,\n      c8y_DeviceProfile: deviceProfile.c8y_DeviceProfile,\n      description: `Assign device profile ${deviceProfile.name} to device ${device.name}`\n    };\n    try {\n      const { data } = await this.operationService.create(operationCfg);\n      operation = data;\n    } catch (ex) {\n      this.alertService.addServerFailure(ex);\n    }\n    return operation;\n  }\n\n  getFirmwareItems(\n    device: IManagedObject,\n    selectedProfile: Partial<DeviceProfile>\n  ): ComparisonResult[] {\n    const deviceFirmware = device.c8y_Firmware;\n    const profileFirmware = get(selectedProfile, 'c8y_DeviceProfile.firmware');\n    const deviceItems = [];\n    const profileItems = [];\n\n    if (deviceFirmware) {\n      deviceItems.push(deviceFirmware);\n    }\n    if (profileFirmware) {\n      profileItems.push(profileFirmware);\n    }\n    return this.createProfileComparison(\n      deviceItems,\n      profileItems,\n      'name',\n      'version',\n      this.getAlert('firmware')\n    );\n  }\n\n  getSoftwareItems(\n    device: IManagedObject,\n    selectedProfile: Partial<DeviceProfile>\n  ): ComparisonResult[] {\n    const deviceSoftware = device.c8y_SoftwareList;\n    const profileSoftware = get(selectedProfile, 'c8y_DeviceProfile.software');\n    return this.createProfileComparison(\n      deviceSoftware,\n      profileSoftware,\n      'name',\n      'version',\n      this.getAlert('software')\n    );\n  }\n\n  getConfigurationItems(\n    device: IManagedObject,\n    selectedProfile: Partial<DeviceProfile>\n  ): ComparisonResult[] {\n    const deviceConfiguration = [];\n    Object.keys(device).forEach(key => {\n      if (key.slice(0, 18) === 'c8y_Configuration_') {\n        deviceConfiguration.push(device[key]);\n      }\n    });\n    const profileConfiguration = get(selectedProfile, 'c8y_DeviceProfile.configuration');\n    return this.createProfileComparison(\n      deviceConfiguration,\n      profileConfiguration,\n      'url',\n      'type',\n      this.getAlert('configuration')\n    );\n  }\n\n  private getAlert(itemType: string): (comparisionResult: ComparisonResult) => string {\n    const notInstalled = (comparisionResult: ComparisonResult) => {\n      return !comparisionResult.device ? this.NOT_INSTALLED_WARNING : '';\n    };\n\n    switch (itemType) {\n      case 'firmware':\n      case 'software':\n        return (comparisionResult: ComparisonResult) => {\n          return comparisionResult.device &&\n            comparisionResult.profile &&\n            comparisionResult.device.itemDetails !== comparisionResult.profile.itemDetails\n            ? this.VERSION_MISSMATCH_WARNING\n            : notInstalled(comparisionResult);\n        };\n      case 'configuration':\n        return (comparisionResult: ComparisonResult) => {\n          return comparisionResult.device &&\n            comparisionResult.profile &&\n            (comparisionResult.device.itemName !== comparisionResult.profile.itemName ||\n              comparisionResult.device.itemDetails !== comparisionResult.profile.itemDetails)\n            ? this.SAME_URL_WARNING\n            : notInstalled(comparisionResult);\n        };\n      default:\n        return notInstalled;\n    }\n  }\n\n  private createProfileComparison(\n    deviceItems: any[] = [],\n    profileItems: Array<DeviceProfileSoftware | DeviceProfileFirmware> = [],\n    mergeByProperty: string,\n    propertyNameWithDetails: string,\n    getAlert: (comparisionResult: ComparisonResult) => string\n  ): ComparisonResult[] {\n    const comparisonObj = this.createProfileComparisonFromDeviceItems(\n      deviceItems,\n      mergeByProperty,\n      propertyNameWithDetails\n    );\n    const extendedComparisonObj = this.extendProfileComparisonWithProfileItems(\n      comparisonObj,\n      profileItems,\n      mergeByProperty,\n      propertyNameWithDetails,\n      getAlert\n    );\n    return sortBy(toArray(extendedComparisonObj), 'name');\n  }\n\n  private createProfileComparisonFromDeviceItems(\n    deviceItems: any[],\n    mergeByProperty: string,\n    propertyNameWithDetails: string\n  ): any {\n    return deviceItems.reduce(\n      (comapritionItem, deviceItem) =>\n        Object.assign(comapritionItem, {\n          [deviceItem[mergeByProperty]]: {\n            device: {\n              itemName: deviceItem.name,\n              itemDetails: deviceItem[propertyNameWithDetails],\n              itemUrl: deviceItem.url\n            },\n            profile: undefined\n          }\n        }),\n      {}\n    );\n  }\n\n  private extendProfileComparisonWithProfileItems(\n    comparisonObj: object,\n    profileItems: Array<DeviceProfileSoftware | DeviceProfileFirmware>,\n    mergeByProperty: string,\n    propertyNameWithDetails: string,\n    getAlert: (comparisionResult: ComparisonResult) => string\n  ) {\n    profileItems.forEach(profileItem => {\n      const comparisionResult: ComparisonResult = {\n        profile: {\n          itemName: profileItem.name,\n          itemDetails: profileItem[propertyNameWithDetails],\n          itemUrl: profileItem.url\n        },\n        device: comparisonObj[profileItem[mergeByProperty]]\n          ? comparisonObj[profileItem[mergeByProperty]].device\n          : undefined\n      };\n      comparisionResult.comparisonAlert = getAlert(comparisionResult);\n      comparisonObj[profileItem[mergeByProperty]] = comparisionResult;\n    });\n    return comparisonObj;\n  }\n}\n","import { Component, EventEmitter } from '@angular/core';\nimport { gettext, ISelectModalObject, ISelectModalOption, ModalLabels } from '@c8y/ngx-components';\nimport { IManagedObject, QueriesUtil } from '@c8y/client';\nimport { Subject, Observable } from 'rxjs';\nimport { switchMap, map } from 'rxjs/operators';\nimport { RepositoryService, RepositoryType } from '@c8y/ngx-components/repository';\n\n@Component({\n  selector: 'c8y-select-configuration-modal',\n  templateUrl: './select-configuration-modal.component.html'\n})\nexport class SelectConfigurationModalComponent {\n  title: string = gettext('Select configuration');\n  load: Subject<void> = new Subject();\n  configurations: Observable<any[]> = this.load.pipe(\n    switchMap(() => this.getItems()),\n    map(({ data }) => this.aggregate(data))\n  );\n  resultEmitter: EventEmitter<any[]> = new EventEmitter<any>();\n  selected: any[];\n  deviceTypeQuery: any = {};\n  searchQuery: any = {};\n  labels: ModalLabels = { ok: gettext('Save') };\n  private queriesUtil: QueriesUtil;\n\n  constructor(private repositoryService: RepositoryService) {\n    this.queriesUtil = new QueriesUtil();\n  }\n\n  search(searchTerm) {\n    if (!searchTerm) {\n      this.searchQuery = {};\n    } else {\n      this.searchQuery = this.queriesUtil.addOrFilter(\n        { name: `*${searchTerm}*` },\n        { configurationType: `*${searchTerm}*` }\n      );\n    }\n    this.load.next();\n  }\n\n  result(selectedItems) {\n    this.resultEmitter.emit(selectedItems);\n  }\n\n  getItems() {\n    return this.repositoryService.listRepositoryEntries(RepositoryType.CONFIGURATION, {\n      query: this.queriesUtil.addOrFilter(this.deviceTypeQuery, this.searchQuery),\n      params: { pageSize: 100 }\n    });\n  }\n\n  aggregate(mos: IManagedObject[]): ISelectModalObject[] {\n    const selectedItems: any[] = this.selected;\n    return mos.reduce((acc, curr) => {\n      curr.configurationType = curr.configurationType || curr.name;\n      const selected =\n        selectedItems && selectedItems.filter(val => val.url === curr.url).length > 0;\n      const selectModalOption: ISelectModalOption = {\n        body: [{ value: curr.name }],\n        obj: curr,\n        selected\n      };\n      let selectModalObject: ISelectModalObject = acc.find(\n        val => val.body[0].value === curr.configurationType\n      ) as ISelectModalObject;\n      if (selectModalObject) {\n        selectModalObject.options.push(selectModalOption);\n      } else {\n        selectModalObject = {\n          groupId: curr.id,\n          body: [{ value: curr.configurationType }],\n          options: [selectModalOption]\n        };\n        acc.push(selectModalObject);\n      }\n      return acc;\n    }, []);\n  }\n}\n","import { IManagedObject } from '@c8y/client';\n\nexport interface DeviceProfile extends Partial<IManagedObject> {\n  name?: string;\n  type: string;\n  c8y_Filter: {\n    type?: string;\n  };\n  c8y_DeviceProfile: {\n    firmware?: DeviceProfileFirmware;\n    software?: DeviceProfileSoftware[];\n    configuration?: DeviceProfileConfiguration[];\n  };\n}\n\nexport interface DeviceProfileFirmware {\n  name: string;\n  version: string;\n  url: string;\n  isPatch: boolean;\n  patchDependency?: string;\n}\n\nexport interface DeviceProfileSoftware {\n  name: string;\n  version: string;\n  url: string;\n  action: string;\n}\n\nexport interface DeviceProfileConfiguration {\n  url: string;\n  name: string;\n  type: string;\n}\n\nexport interface ComparisonResult {\n  profile: {\n    itemName: string;\n    itemDetails?: string;\n    itemUrl: string;\n  };\n  device: {\n    itemName: string;\n    itemDetails?: string;\n    itemUrl: string;\n  };\n  comparisonAlert?: string;\n}\n\nexport enum DeviceProfileOperation {\n  APPLY_PROFILE = 'c8y_DeviceProfile'\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { ActivatedRoute } from '@angular/router';\nimport {\n  DeviceProfile,\n  DeviceProfileConfiguration,\n  DeviceProfileFirmware,\n  DeviceProfileSoftware\n} from './device-profile.model';\nimport { AlertService, BreadcrumbService, gettext, ModalSelectionMode } from '@c8y/ngx-components';\nimport { IManagedObject, InventoryService, QueriesUtil } from '@c8y/client';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport { assign, isEqual, concat, uniqWith } from 'lodash-es';\nimport { SelectConfigurationModalComponent } from './select-configuration-modal.component';\nimport { has, isEmpty } from 'lodash-es';\nimport { take, distinctUntilChanged, switchMap, map, shareReplay } from 'rxjs/operators';\nimport { RepositoryType, RepositorySelectModalComponent } from '@c8y/ngx-components/repository';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { RepositoryService } from '@c8y/ngx-components/repository';\n\n@Component({\n  selector: 'c8y-device-profile',\n  templateUrl: './device-profile.component.html'\n})\nexport class DeviceProfileComponent implements OnInit {\n  DEVICE_TYPE_POPOVER = gettext(\n    'The device profile will be available for assignments on devices of the specified type. Otherwise, it will be available for all device types.'\n  );\n  deviceProfile: DeviceProfile;\n  profileName: string;\n  private queriesUtil: QueriesUtil;\n\n  constructor(\n    private route: ActivatedRoute,\n    private alertService: AlertService,\n    private inventoryService: InventoryService,\n    private location: Location,\n    private breadcrumbService: BreadcrumbService,\n    private bsModal: BsModalService,\n    private repositoryService: RepositoryService\n  ) {\n    this.queriesUtil = new QueriesUtil();\n  }\n\n  async ngOnInit() {\n    const profileId = this.route.snapshot.paramMap.get('id');\n    this.deviceProfile = (await this.getDeviceProfile(profileId)) as DeviceProfile;\n    if (this.deviceProfile) {\n      this.profileName = this.deviceProfile.name;\n      if (!this.deviceProfile.c8y_DeviceProfile.software) {\n        this.deviceProfile.c8y_DeviceProfile.software = [];\n      }\n      if (!this.deviceProfile.c8y_DeviceProfile.configuration) {\n        this.deviceProfile.c8y_DeviceProfile.configuration = [];\n      }\n    }\n  }\n\n  addFirmware() {\n    const initialState: Partial<RepositorySelectModalComponent> & {\n      repositoryEntriesWithVersionsFn$: (modal: any) => Observable<IManagedObject[]>;\n    } = {\n      deviceTypeQuery: this.getDeviceTypeQuery(RepositoryType.FIRMWARE),\n      repositoryType: RepositoryType.FIRMWARE,\n      repositoryEntriesWithVersionsFn$: modalDialog =>\n        this.getRepositoryEntriesWithVersions$(\n          modalDialog.content.searchTerm,\n          RepositoryType.FIRMWARE\n        ),\n      icon: 'c8y-firmware',\n      title: gettext('Select firmware'),\n      mode: ModalSelectionMode.SINGLE\n    };\n    const modal = this.bsModal.show(RepositorySelectModalComponent, {\n      ignoreBackdropClick: true,\n      initialState\n    });\n\n    if (initialState.repositoryEntriesWithVersionsFn$) {\n      modal.content.repositoryEntriesWithVersions$ = initialState.repositoryEntriesWithVersionsFn$(\n        modal\n      );\n    }\n\n    modal.content.load.next();\n    modal.content.resultEmitter.pipe(take(1)).subscribe(firmwareList => {\n      const [firmware] = firmwareList;\n      if (!firmware) {\n        return;\n      }\n      const deviceProfilePartial: Partial<IManagedObject> = {\n        c8y_DeviceProfile: this.deviceProfile.c8y_DeviceProfile || {}\n      };\n      assign(deviceProfilePartial.c8y_DeviceProfile, {\n        firmware: {\n          name: firmware.name,\n          version: firmware.version,\n          url: firmware.url,\n          isPatch: firmware.isPatch,\n          patchDependency: firmware.patchDependency\n        } as DeviceProfileFirmware\n      });\n      this.updateDeviceProfile(deviceProfilePartial);\n    });\n  }\n\n  getRepositoryEntriesWithVersions$(\n    searchTerm$: BehaviorSubject<string>,\n    repoType: RepositoryType\n  ) {\n    return searchTerm$.pipe(\n      distinctUntilChanged(),\n      switchMap(searchTerm =>\n        this.repositoryService.listRepositoryEntries(repoType, {\n          partialName: searchTerm,\n          params: { pageSize: 100 },\n          skipLegacy: true\n        })\n      ),\n      map(({ data }) => data),\n      map(mos => this.getAndAssignRepositoryBinaries(mos)),\n      shareReplay(1)\n    );\n  }\n\n  getAndAssignRepositoryBinaries(mos: IManagedObject[]) {\n    mos.forEach(mo => {\n      mo.versions = this.repositoryService.listBaseVersions(mo);\n    });\n    return mos;\n  }\n\n  addConfiguration() {\n    const modal = this.bsModal.show(SelectConfigurationModalComponent, {\n      ignoreBackdropClick: true\n    });\n    modal.content.deviceTypeQuery = this.getDeviceTypeQuery(RepositoryType.CONFIGURATION);\n    modal.content.selected = this.deviceProfile.c8y_DeviceProfile.configuration;\n    modal.content.load.next();\n    modal.content.resultEmitter.pipe(take(1)).subscribe(selectedConfigurations => {\n      const selectedMapped: DeviceProfileConfiguration[] = selectedConfigurations.map(\n        selectedItem => {\n          return assign(\n            {\n              url: selectedItem.url,\n              name: selectedItem.name\n            },\n            selectedItem.configurationType ? { type: selectedItem.configurationType } : {}\n          );\n        }\n      );\n      const merged: DeviceProfileConfiguration = concat(\n        selectedMapped,\n        this.deviceProfile.c8y_DeviceProfile.configuration || []\n      );\n      const configuration: DeviceProfileConfiguration = uniqWith(merged, (arrVal, othVal) => {\n        return arrVal.type && othVal.type && arrVal.type === othVal.type;\n      });\n      const deviceProfilePartial: Partial<IManagedObject> = {\n        c8y_DeviceProfile: this.deviceProfile.c8y_DeviceProfile || {}\n      };\n      assign(deviceProfilePartial.c8y_DeviceProfile, { configuration });\n      this.updateDeviceProfile(deviceProfilePartial);\n    });\n  }\n\n  addSoftware() {\n    const initialState: Partial<RepositorySelectModalComponent> & {\n      repositoryEntriesWithVersionsFn$: (modal: any) => Observable<IManagedObject[]>;\n    } = {\n      deviceTypeQuery: this.getDeviceTypeQuery(RepositoryType.SOFTWARE),\n      repositoryType: RepositoryType.SOFTWARE,\n      repositoryEntriesWithVersionsFn$: modalDialog =>\n        this.getRepositoryEntriesWithVersions$(\n          modalDialog.content.searchTerm,\n          RepositoryType.SOFTWARE\n        ),\n      selected: this.deviceProfile.c8y_DeviceProfile.software,\n      icon: 'c8y-tools',\n      title: gettext('Select software'),\n      mode: ModalSelectionMode.MULTI\n    };\n    const modal = this.bsModal.show(RepositorySelectModalComponent, {\n      ignoreBackdropClick: true,\n      initialState\n    });\n\n    if (initialState.repositoryEntriesWithVersionsFn$) {\n      modal.content.repositoryEntriesWithVersions$ = initialState.repositoryEntriesWithVersionsFn$(\n        modal\n      );\n    }\n\n    modal.content.load.next();\n    modal.content.resultEmitter.pipe(take(1)).subscribe(selectedSoftware => {\n      const selectedMapped: DeviceProfileSoftware[] = selectedSoftware.map(selectedItem => {\n        return {\n          name: selectedItem.name,\n          version: selectedItem.version,\n          url: selectedItem.url,\n          action: 'install'\n        };\n      });\n      const merged: DeviceProfileSoftware = concat(\n        selectedMapped,\n        this.deviceProfile.c8y_DeviceProfile.software || []\n      );\n      const software: DeviceProfileSoftware = uniqWith(merged, (arrVal, othVal) => {\n        return arrVal.name && othVal.name && arrVal.name === othVal.name;\n      });\n      const deviceProfilePartial: Partial<IManagedObject> = {\n        c8y_DeviceProfile: this.deviceProfile.c8y_DeviceProfile || {}\n      };\n      assign(deviceProfilePartial.c8y_DeviceProfile, { software });\n      this.updateDeviceProfile(deviceProfilePartial);\n    });\n  }\n\n  get isDeviceProfileEmpty() {\n    const isSoftware =\n      this.deviceProfile.c8y_DeviceProfile.software &&\n      this.deviceProfile.c8y_DeviceProfile.software.length > 0;\n    const isFirmware = Boolean(this.deviceProfile.c8y_DeviceProfile.firmware);\n    const isConfiguration =\n      this.deviceProfile.c8y_DeviceProfile.configuration &&\n      this.deviceProfile.c8y_DeviceProfile.configuration.length > 0;\n    return isSoftware || isFirmware || isConfiguration;\n  }\n\n  removeItem(removedItem, category) {\n    const deviceProfilePartial: Partial<IManagedObject> = {\n      c8y_DeviceProfile: this.deviceProfile.c8y_DeviceProfile\n    };\n    const filtered = deviceProfilePartial.c8y_DeviceProfile[category].filter(\n      item => !isEqual(removedItem, item)\n    );\n    deviceProfilePartial.c8y_DeviceProfile[category] = filtered;\n    this.updateDeviceProfile(deviceProfilePartial);\n  }\n\n  removeFirmware() {\n    delete this.deviceProfile.c8y_DeviceProfile.firmware;\n    this.updateDeviceProfile({ c8y_DeviceProfile: this.deviceProfile.c8y_DeviceProfile });\n  }\n\n  async updateDeviceProfile(partialDeviceProfile) {\n    if (partialDeviceProfile.c8y_Filter && partialDeviceProfile.c8y_Filter.type === '') {\n      delete partialDeviceProfile.c8y_Filter.type;\n    }\n    Object.assign(partialDeviceProfile, { id: this.deviceProfile.id });\n    try {\n      const { data } = await this.inventoryService.update(partialDeviceProfile);\n      this.deviceProfile = data as DeviceProfile;\n      this.profileName = this.deviceProfile.name;\n      this.alertService.success(gettext('Device profile changed.'));\n    } catch (ex) {\n      this.alertService.addServerFailure(ex);\n    }\n  }\n\n  private async getDeviceProfile(profileId) {\n    try {\n      const { data } = await this.inventoryService.detail(profileId);\n      return data;\n    } catch (ex) {\n      this.alertService.addServerFailure(ex);\n    }\n  }\n\n  private getDeviceTypeQuery(repositoryType) {\n    if (\n      has(this.deviceProfile, 'c8y_Filter.type') &&\n      !isEmpty(this.deviceProfile.c8y_Filter.type)\n    ) {\n      if (repositoryType === RepositoryType.CONFIGURATION) {\n        return this.queriesUtil.addOrFilter(\n          { deviceType: this.deviceProfile.c8y_Filter.type },\n          { __not: { __has: `deviceType` } }\n        );\n      } else {\n        return this.queriesUtil.addOrFilter(\n          { 'c8y_Filter.type': this.deviceProfile.c8y_Filter.type },\n          { __not: { __has: `c8y_Filter.type` } }\n        );\n      }\n    }\n    return {};\n  }\n}\n","import { Component } from '@angular/core';\nimport { BsModalRef } from 'ngx-bootstrap/modal';\nimport { DeviceProfile } from './device-profile.model';\nimport { DeviceProfileService } from './device-profile.service';\nimport { gettext } from '@c8y/ngx-components';\n\n@Component({\n  selector: 'c8y-add-device-profile',\n  templateUrl: './add-device-profile-component.html'\n})\nexport class AddDeviceProfileComponent {\n  DEVICE_TYPE_POPOVER = gettext('The device profile will be available for assignments on devices of the specified type. Otherwise, it will be available for all device types.');\n  deviceProfile: Partial<DeviceProfile> = {\n    name: '',\n    type: 'c8y_Profile',\n    c8y_Filter: {},\n    c8y_DeviceProfile : {\n    }\n  };\n  result: Promise<any> = new Promise((resolve, reject) => {\n    this._save = resolve;\n    this._cancel = reject;\n  });\n  private _save;\n  private _cancel;\n\n  constructor(private modal: BsModalRef, private deviceProfileService: DeviceProfileService) {}\n\n  async create() {\n    const mo = (await this.deviceProfileService.createDeviceProfile(this.deviceProfile)).data;\n    this._save(mo.id);\n  }\n\n  close() {\n    this._cancel();\n    this.modal.hide();\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { IManagedObject, InventoryService, IResultList } from '@c8y/client';\nimport { TranslateService } from '@ngx-translate/core';\nimport { AlertService, gettext, ModalService, Status } from '@c8y/ngx-components';\nimport { cloneDeep } from 'lodash-es';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport { AddDeviceProfileComponent } from './add-device-profile.component';\nimport { DeviceProfileService } from './device-profile.service';\nimport { Router } from '@angular/router';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { tap, switchMap } from 'rxjs/operators';\n\n@Component({\n  selector: 'c8y-device-profile-list',\n  templateUrl: './device-profile-list.component.html'\n})\nexport class DeviceProfileListComponent implements OnInit {\n  reloading: boolean = false;\n  reload: BehaviorSubject<void> = new BehaviorSubject(null);\n  deviceProfiles$: Observable<IResultList<IManagedObject>> = this.reload.pipe(\n    tap(() => (this.reloading = true)),\n    switchMap(() => this.deviceProfileService.getDeviceProfiles()),\n    tap(() => (this.reloading = false))\n  );\n\n  constructor(\n    private inventoryService: InventoryService,\n    private translateService: TranslateService,\n    private modalService: ModalService,\n    private alertService: AlertService,\n    private bsModalService: BsModalService,\n    private router: Router,\n    private deviceProfileService: DeviceProfileService\n  ) {}\n\n  ngOnInit() {\n    this.loadDeviceProfiles();\n  }\n\n  loadDeviceProfiles() {\n    this.reload.next();\n  }\n\n  async createDeviceProfile() {\n    const modal = this.bsModalService.show(AddDeviceProfileComponent, {\n      class: 'modal-sm'\n    }).content as AddDeviceProfileComponent;\n    try {\n      const profileId = await modal.result;\n      modal.close();\n      this.router.navigateByUrl(`/device-profiles/${profileId}`);\n    } catch (ex) {\n      // do nothing\n    }\n  }\n\n  async duplicateDeviceProfile(deviceProfile) {\n    const copy = cloneDeep(deviceProfile);\n    copy.id = null;\n    copy.name = 'Duplicate of ' + deviceProfile.name;\n    const mo = (await this.deviceProfileService.createDeviceProfile(copy)).data;\n    this.router.navigateByUrl(`/device-profiles/${mo.id}`);\n  }\n\n  async deleteDeviceProfile(deviceProfile) {\n    const deviceProfileName = deviceProfile.name;\n    const title = gettext('Delete device profile');\n    const confirmationText = this.translateService.instant(\n      gettext('You are about to delete a device profile \"{{ deviceProfileName }}\".'),\n      { deviceProfileName }\n    );\n    const finalQuestion = this.translateService.instant(gettext('Do you want to proceed?'));\n    try {\n      await this.modalService.confirm(\n        title,\n        `${confirmationText} ${finalQuestion}`,\n        Status.DANGER,\n        {\n          ok: gettext('Delete')\n        }\n      );\n      await this.delete(deviceProfile.id);\n      this.reload.next();\n    } catch (ex) {\n      // do nothing\n    }\n  }\n\n  private async delete(profileId) {\n    try {\n      await this.inventoryService.delete(profileId);\n      this.alertService.success(gettext('Device profile deleted.'));\n    } catch (ex) {\n      this.alertService.addServerFailure(ex);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, RouterStateSnapshot } from '@angular/router';\nimport { DeviceProfileOperation } from './device-profile.model';\nimport { IManagedObject } from '@c8y/client';\n\n@Injectable()\nexport class DeviceProfileGuard implements CanActivate {\n  canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\n    const contextData = route.data.contextData || route.parent.data.contextData;\n    if (!contextData) {\n      return false;\n    }\n    return this.hasSupportedOperation(contextData, DeviceProfileOperation.APPLY_PROFILE);\n  }\n\n  private hasSupportedOperation(mo: IManagedObject, operation: DeviceProfileOperation) {\n    const supported = mo.c8y_SupportedOperations || [];\n    if (!supported) {\n      return false;\n    }\n    return !!supported.find(supportedOperation => supportedOperation === operation);\n  }\n}\n","import { Component, OnDestroy, OnInit, Pipe } from '@angular/core';\nimport { IManagedObject, IOperation, IResultList, Realtime } from '@c8y/client';\nimport { ActivatedRoute } from '@angular/router';\nimport { pipe, Subscription } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { DeviceProfileService } from '../device-profile.service';\nimport { DeviceProfile, ComparisonResult } from '../device-profile.model';\nimport {\n  AlertService,\n  gettext,\n  ManagedObjectRealtimeService,\n  OperationRealtimeService\n} from '@c8y/ngx-components';\n\n@Component({\n  selector: 'c8y-device-tab-profile',\n  templateUrl: './device-tab-profile.component.html',\n  providers: [ManagedObjectRealtimeService]\n})\nexport class DeviceTabProfileComponent implements OnInit, OnDestroy {\n  device: IManagedObject;\n  deviceProfiles: IResultList<IManagedObject>;\n  selectedProfile: Partial<DeviceProfile>;\n  operation: IOperation;\n  firmwareItems: ComparisonResult[] = [];\n  softwareItems: ComparisonResult[] = [];\n  configurationItems: ComparisonResult[] = [];\n\n  filterPipe: Pipe;\n  pattern: string = '';\n  reloading: boolean = false;\n  private operationsSubscription: Subscription;\n  private moOnDeleteSubscription: Subscription;\n  private moOnUpdateSubscription: Subscription;\n\n  constructor(\n    public deviceRealtime: ManagedObjectRealtimeService,\n    private deviceProfileService: DeviceProfileService,\n    private route: ActivatedRoute,\n    private operationRealtime: OperationRealtimeService,\n    private alertService: AlertService\n  ) {}\n\n  async ngOnInit() {\n    this.device = this.route.snapshot.parent.data.contextData;\n    this.getDeviceProfilesAndUpdateProfileItems();\n    this.subscribeToManagedObjects();\n  }\n\n  async getDeviceProfilesAndUpdateProfileItems() {\n    this.reloading = true;\n    this.deviceProfiles = await this.deviceProfileService.getDeviceProfilesByDeviceType(\n      this.device.type\n    );\n    if (this.device.c8y_Profile) {\n      const profileId = this.device.c8y_Profile.profileId;\n      this.selectedProfile = this.deviceProfiles.data.find(mo => mo.id === profileId);\n    }\n    this.updateProfileItems(this.device, this.selectedProfile);\n    this.operation = await this.deviceProfileService.getProfileOperation(this.device.id);\n    this.subscribeToOperations();\n    this.reloading = false;\n  }\n\n  selectProfile(mo: DeviceProfile) {\n    this.selectedProfile = mo;\n    this.updateProfileItems(this.device, this.selectedProfile);\n  }\n\n  async createOperation() {\n    this.operation = await this.deviceProfileService.createProfileOperation(\n      this.device,\n      this.selectedProfile\n    );\n  }\n\n  setPipe(filterStr: string) {\n    this.pattern = filterStr;\n    this.filterPipe = pipe(\n      map((data: any[]) => {\n        return data.filter(\n          (mo: any) => mo.name && mo.name.toLowerCase().indexOf(filterStr.toLowerCase()) > -1\n        );\n      })\n    );\n  }\n\n  ngOnDestroy() {\n    this.operationsSubscription.unsubscribe();\n    this.moOnUpdateSubscription.unsubscribe();\n    this.moOnDeleteSubscription.unsubscribe();\n  }\n\n  updateProfileItems(device, profile) {\n    this.firmwareItems = this.deviceProfileService.getFirmwareItems(device, profile);\n    this.softwareItems = this.deviceProfileService.getSoftwareItems(device, profile);\n    this.configurationItems = this.deviceProfileService.getConfigurationItems(device, profile);\n  }\n\n  private subscribeToManagedObjects() {\n    this.moOnUpdateSubscription = this.deviceRealtime\n      .onUpdate$(this.device.id)\n      .subscribe((managedObject: IManagedObject) => {\n        this.updateProfileItems(managedObject, this.selectedProfile);\n      });\n    this.moOnDeleteSubscription = this.deviceRealtime.onDelete$(this.device.id).subscribe(() => {\n      this.alertService.danger(\n        gettext(\n          'This device has just been deleted. You will be redirected to \"All devices\" page now.'\n        )\n      );\n      window.location.href = '#/device';\n    });\n  }\n\n  private subscribeToOperations() {\n    this.operationsSubscription = this.operationRealtime\n      .onAll$(this.device.id)\n      .pipe(\n        map(({ data }) => data as IOperation),\n        filter(operation => operation.c8y_DeviceProfile)\n      )\n      .subscribe(operation => {\n        this.operation = operation;\n      });\n  }\n}\n","import { Component, Input } from '@angular/core';\nimport { ComparisonResult } from '../device-profile.model';\n\n@Component({\n  selector: 'c8y-device-tab-profile-detail',\n  templateUrl: './device-tab-profile-detail.component.html'\n})\nexport class DeviceTabProfileDetailComponent {\n  @Input() sectionTitle: string;\n  @Input() sectionIcon: string;\n  @Input() emptyStateText: string = '';\n  @Input() emptyStateDetails: string = '';\n  @Input() isProfileSelected: boolean;\n  @Input() isEmpty: boolean;\n  @Input() items: ComparisonResult[];\n  @Input() showTextLabel: boolean = true;\n}\n","import { Component, Input } from '@angular/core';\nimport { ComparisonResult } from '../device-profile.model';\n\n@Component({\n  selector: 'c8y-device-profile-item-list',\n  templateUrl: './device-profile-item-list.component.html'\n})\nexport class DeviceProfileItemListComponent {\n  @Input() icon: string;\n  @Input() comparisonResults: ComparisonResult[];\n  @Input() showProfileItems: boolean;\n  @Input() showTextLabel: boolean;\n}\n","import { NgModule } from '@angular/core';\nimport { Route, RouterModule } from '@angular/router';\nimport {\n  CommonModule,\n  CoreModule,\n  HOOK_NAVIGATOR_NODES,\n  HOOK_ROUTE,\n  gettext,\n  ViewContext\n} from '@c8y/ngx-components';\nimport { BsDropdownModule } from 'ngx-bootstrap/dropdown';\nimport { PopoverModule } from 'ngx-bootstrap/popover';\nimport { TooltipModule } from 'ngx-bootstrap/tooltip';\nimport { ButtonsModule } from 'ngx-bootstrap/buttons';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { DeviceProfileComponent } from './device-profile.component';\nimport { DeviceProfileListComponent } from './device-profile-list.component';\nimport { DeviceProfileNavigationFactory } from './device-profile-navigation.factory';\nimport { DeviceProfileService } from './device-profile.service';\nimport { AddDeviceProfileComponent } from './add-device-profile.component';\nimport { DeviceProfileGuard } from './device-profile.guard';\nimport { RepositoryModule } from '@c8y/ngx-components/repository';\nimport { SelectConfigurationModalComponent } from './select-configuration-modal.component';\nimport { DeviceTabProfileComponent } from './device-tab-profile/device-tab-profile.component';\nimport { DeviceTabProfileDetailComponent } from './device-tab-profile/device-tab-profile-detail.component';\nimport { DeviceProfileItemListComponent } from './device-tab-profile/device-profile-item-list.component';\nimport { SingleOperationDetailsModule } from '@c8y/ngx-components/operations/single-operation-details';\n\nconst deviceProfilesRoutes: Route[] = [\n  {\n    path: 'device-profiles/:id',\n    component: DeviceProfileComponent\n  },\n  {\n    path: 'device-profiles',\n    component: DeviceProfileListComponent\n  }\n];\n\nconst deviceTabProfileRoutes: any[] = [\n  {\n    context: ViewContext.Device,\n    path: 'device-profile',\n    component: DeviceTabProfileComponent,\n    label: gettext('Device profile'),\n    icon: 'c8y-device-profile',\n    canActivate: [DeviceProfileGuard]\n  }\n];\n\n@NgModule({\n  declarations: [\n    DeviceProfileComponent,\n    DeviceProfileListComponent,\n    AddDeviceProfileComponent,\n    SelectConfigurationModalComponent,\n    DeviceTabProfileComponent,\n    DeviceTabProfileDetailComponent,\n    DeviceProfileItemListComponent\n  ],\n  exports: [],\n  imports: [\n    CoreModule,\n    CommonModule,\n    RepositoryModule,\n    RouterModule.forChild(deviceProfilesRoutes),\n    BsDropdownModule.forRoot(),\n    TooltipModule,\n    ReactiveFormsModule,\n    ButtonsModule,\n    PopoverModule,\n    SingleOperationDetailsModule\n  ],\n  entryComponents: [\n    AddDeviceProfileComponent,\n    SelectConfigurationModalComponent,\n    DeviceTabProfileComponent\n  ],\n  providers: [\n    {\n      provide: HOOK_NAVIGATOR_NODES,\n      useClass: DeviceProfileNavigationFactory,\n      multi: true\n    },\n    {\n      provide: HOOK_ROUTE,\n      useValue: deviceTabProfileRoutes,\n      multi: true\n    },\n    DeviceProfileService,\n    DeviceProfileGuard\n  ]\n})\nexport class DeviceProfileModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {DeviceProfileItemListComponent as ɵc} from './device-tab-profile/device-profile-item-list.component';\nexport {DeviceTabProfileDetailComponent as ɵb} from './device-tab-profile/device-tab-profile-detail.component';\nexport {DeviceTabProfileComponent as ɵa} from './device-tab-profile/device-tab-profile.component';"]}