{"version":3,"file":"c8y-ngx-components-operations-bulk-operation-scheduler.js","sources":["../../operations/bulk-operation-scheduler/operation-scheduler.component.ts","../../operations/bulk-operation-scheduler/bulk-operation-scheduler.module.ts","../../operations/bulk-operation-scheduler/c8y-ngx-components-operations-bulk-operation-scheduler.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, forwardRef, Input, OnDestroy, OnInit } from '@angular/core';\nimport {\n  ControlValueAccessor,\n  FormBuilder,\n  FormControl,\n  FormGroup,\n  NG_VALIDATORS,\n  NG_VALUE_ACCESSOR,\n  ValidationErrors,\n  Validator,\n  Validators\n} from '@angular/forms';\nimport { gettext } from '@c8y/ngx-components';\nimport { isEmpty } from 'lodash-es';\nimport { Subscription } from 'rxjs';\nimport { throttleTime } from 'rxjs/operators';\nimport { OperationSchedule } from './operation-schedule.interface';\n\n@Component({\n  selector: 'c8y-operation-scheduler',\n  templateUrl: 'operation-scheduler.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => OperationSchedulerComponent)\n    },\n    {\n      provide: NG_VALIDATORS,\n      multi: true,\n      useExisting: forwardRef(() => OperationSchedulerComponent)\n    }\n  ]\n})\nexport class OperationSchedulerComponent\n  implements ControlValueAccessor, Validator, OnInit, OnDestroy {\n  @Input('minutesAhead') set _minutesAhead(minutes: number) {\n    if (minutes && minutes > this.MINUTES_AHEAD_DEFAULT) {\n      this.minutesAhead = minutes;\n    }\n  }\n  @Input('delayConfig') set _delayConfig(config: { seconds: number; milliseconds: number }) {\n    if (config) {\n      if (config.seconds > this.DELAY_SECONDS_DEFAULT) {\n        this.delaySeconds = config.seconds;\n      }\n\n      if (config.milliseconds > this.DELAY_MILLISECONDS_DEFAULT) {\n        this.delayMilliseconds = config.milliseconds;\n      }\n    }\n  }\n\n  placeholder: string = gettext('Start date');\n  fgOperationScheduler: FormGroup;\n  minDate: Date;\n  minDelay: number;\n  delayErrors: ValidationErrors = null;\n  pickerErrors: ValidationErrors = null;\n\n  private readonly DELAY_SECONDS_DEFAULT: number = 1;\n  private readonly DELAY_MILLISECONDS_DEFAULT: number = 1;\n  private readonly MINUTES_AHEAD_DEFAULT: number = 5;\n  private delaySeconds: number = this.DELAY_SECONDS_DEFAULT;\n  private delayMilliseconds: number = this.DELAY_MILLISECONDS_DEFAULT;\n  private minutesAhead: number = this.MINUTES_AHEAD_DEFAULT;\n  private currentUnit: string = 'seconds';\n  private delayInSeconds: number;\n  private initialDate: Date;\n  private subscription: Subscription;\n\n  private onChange: (name) => void;\n  private onTouched: () => void;\n  private onValidatorChanged: () => void;\n\n  constructor(private formBuilder: FormBuilder) {}\n\n  ngOnInit() {\n    this.minDate = new Date();\n    this.initialDate = new Date(\n      this.minDate.setMinutes(this.minDate.getMinutes() + this.minutesAhead)\n    );\n    this.minDelay = this.delaySeconds;\n\n    this.fgOperationScheduler = this.formBuilder.group({\n      picker: ['', [Validators.required, this.dateValidation]],\n      time: ['', [Validators.required, this.timeValidation]],\n      delay: ['', [Validators.required, Validators.min(this.minDelay)]],\n      unit: ['seconds']\n    });\n\n    this.fgOperationScheduler.patchValue({\n      picker: this.initialDate,\n      time: this.initialDate,\n      delay: this.minDelay\n    });\n\n    // Due to the validation of picker and time it could be possible that value changes\n    // are emitted more than once. Therefore we throttle the emits.\n    const valueChanges$ = this.fgOperationScheduler.valueChanges.pipe(throttleTime(100));\n    this.subscription = valueChanges$.subscribe(data => {\n      this.delayErrors = this.fgOperationScheduler.controls.delay.errors;\n      this.pickerErrors = this.fgOperationScheduler.controls.picker.errors;\n      this.convertDelayHandler(data.unit);\n      this.emitData(data);\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.subscription && !this.subscription.closed) {\n      this.subscription.unsubscribe();\n    }\n  }\n\n  writeValue(value: OperationSchedule): void {\n    if (value) {\n      this.fgOperationScheduler.patchValue({\n        picker: value.scheduledDate,\n        time: value.scheduledDate,\n        delay: value.delayInSeconds > 1 ? value.delayInSeconds : value.delayInSeconds * 1000,\n        unit: value.delayInSeconds > 1 ? 'seconds' : 'milliseconds'\n      });\n    }\n  }\n\n  registerOnChange(fn: any): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  setDisabledState?(isDisabled: boolean): void {\n    isDisabled ? this.fgOperationScheduler.disable() : this.fgOperationScheduler.enable();\n  }\n\n  validate(): ValidationErrors {\n    if (this.fgOperationScheduler.invalid) {\n      return {\n        ...this.fgOperationScheduler.controls.picker.errors,\n        ...this.fgOperationScheduler.controls.time.errors,\n        ...this.fgOperationScheduler.controls.delay.errors\n      };\n    }\n  }\n\n  registerOnValidatorChange(fn: any) {\n    this.onValidatorChanged = fn;\n  }\n\n  markAsTouched(): void {\n    if (this.onTouched) {\n      this.onTouched();\n    }\n  }\n\n  convertDelayHandler(unit: string) {\n    if (this.currentUnit === unit) {\n      return;\n    }\n\n    this.currentUnit = unit;\n    this.convertDelay(this.currentUnit);\n\n    // update validator on delay control to make sure that\n    // switching from minutes to seconds or vice versa does not harm validation.\n    this.fgOperationScheduler.controls.delay.setValidators([Validators.required]);\n    this.fgOperationScheduler.controls.delay.updateValueAndValidity();\n  }\n\n  emitData(data: { delayInSeconds: number; picker: Date; time?: Date; delay?: number }) {\n    if (this.onValidatorChanged) {\n      this.onValidatorChanged();\n    }\n\n    if (data.picker && data.time) {\n      data.picker = this.combineDateAndTime(data.picker, data.time);\n    }\n\n    this.convertDelay(this.currentUnit);\n    data.delayInSeconds = this.delayInSeconds;\n\n    if (this.onChange) {\n      this.onChange({\n        delayInSeconds: data.delayInSeconds,\n        scheduledDate: data.picker\n      });\n    }\n  }\n\n  private convertDelay(unit: string) {\n    if (unit && this.fgOperationScheduler.controls.delay.value) {\n      this.delayMilliseconds = this.fgOperationScheduler.controls.delay.value;\n      if (unit === 'milliseconds') {\n        this.minDelay =\n          this.delayMilliseconds > this.DELAY_MILLISECONDS_DEFAULT\n            ? this.delayMilliseconds\n            : this.DELAY_MILLISECONDS_DEFAULT;\n        this.delayInSeconds = this.fgOperationScheduler.controls.delay.value / 1000;\n      } else {\n        this.delaySeconds = this.fgOperationScheduler.controls.delay.value;\n        this.minDelay =\n          this.delaySeconds > this.DELAY_SECONDS_DEFAULT\n            ? this.delaySeconds\n            : this.DELAY_SECONDS_DEFAULT;\n        this.delayInSeconds = this.fgOperationScheduler.controls.delay.value;\n      }\n    }\n  }\n\n  private combineDateAndTime(date: Date, time: Date) {\n    return new Date(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate(),\n      time.getHours(),\n      time.getMinutes()\n    );\n  }\n\n  private dateValidation(fControl: FormControl) {\n    if (fControl.value) {\n      const date = fControl.value as Date;\n      fControl.parent.get('time').setValue(date);\n      return date >= new Date()\n        ? null\n        : {\n            dateValidation: true\n          };\n    }\n    return { dateValidation: true };\n  }\n\n  private timeValidation(fControl: FormControl) {\n    if (fControl.value) {\n      const date = fControl.value as Date;\n      const result =\n        date >= new Date()\n          ? null\n          : {\n              dateValidation: true\n            };\n\n      const picker = fControl.parent.get('picker');\n\n      if (result) {\n        picker.setErrors(result);\n        picker.markAsTouched();\n        return result;\n      }\n\n      if (picker && picker.errors && picker.errors.dateValidation) {\n        delete picker.errors.dateValidation;\n\n        if (isEmpty(picker.errors)) {\n          picker.setErrors(null);\n          return result;\n        }\n\n        picker.setErrors(picker.errors);\n      }\n      return result;\n    }\n    return { dateValidation: true };\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { CoreModule } from '@c8y/ngx-components';\nimport { BsDatepickerModule } from 'ngx-bootstrap/datepicker';\nimport { TimepickerModule } from 'ngx-bootstrap/timepicker';\nimport { OperationSchedulerComponent } from './operation-scheduler.component';\n\n/**\n * This module provides components for scheduling bulk operations.\n */\n@NgModule({\n  imports: [\n    CoreModule,\n    ReactiveFormsModule,\n    BsDatepickerModule.forRoot(),\n    TimepickerModule.forRoot()\n  ],\n  providers: [],\n  declarations: [OperationSchedulerComponent],\n  entryComponents: [OperationSchedulerComponent],\n  exports: [OperationSchedulerComponent]\n})\nexport class BulkOperationSchedulerModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}