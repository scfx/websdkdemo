/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Pipe } from '@angular/core';
import { Observable, of as observableOf } from 'rxjs';
import { map } from 'rxjs/operators';
import * as ɵngcc0 from '@angular/core';
export class FormlySelectOptionsPipe {
    /**
     * @param {?} options
     * @param {?=} field
     * @return {?}
     */
    transform(options, field) {
        if (!(options instanceof Observable)) {
            options = observableOf(options);
        }
        return ((/** @type {?} */ (options))).pipe(map((/**
         * @param {?} value
         * @return {?}
         */
        value => this.toOptions(value, field || {}))));
    }
    /**
     * @private
     * @param {?} options
     * @param {?} field
     * @return {?}
     */
    toOptions(options, field) {
        /** @type {?} */
        const gOptions = [];
        /** @type {?} */
        const groups = {};
        /** @type {?} */
        const to = field.templateOptions || {};
        to._flatOptions = true;
        options.map((/**
         * @param {?} option
         * @return {?}
         */
        (option) => {
            if (!this.getGroupProp(option, to)) {
                gOptions.push(this.toOption(option, to));
            }
            else {
                to._flatOptions = false;
                if (!groups[this.getGroupProp(option, to)]) {
                    groups[this.getGroupProp(option, to)] = [];
                    gOptions.push({
                        label: this.getGroupProp(option, to),
                        group: groups[this.getGroupProp(option, to)],
                    });
                }
                groups[this.getGroupProp(option, to)].push(this.toOption(option, to));
            }
        }));
        return gOptions;
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    toOption(item, to) {
        return {
            label: this.getLabelProp(item, to),
            value: this.getValueProp(item, to),
            disabled: this.getDisabledProp(item, to) || false,
        };
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    getLabelProp(item, to) {
        if (typeof to.labelProp === 'function') {
            return to.labelProp(item);
        }
        if (this.shouldUseLegacyOption(item, to)) {
            console.warn(`NgxFormly: legacy select option '{key, value}' is deprecated since v5.5, use '{value, label}' instead.`);
            return item.value;
        }
        return item[to.labelProp || 'label'];
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    getValueProp(item, to) {
        if (typeof to.valueProp === 'function') {
            return to.valueProp(item);
        }
        if (this.shouldUseLegacyOption(item, to)) {
            return item.key;
        }
        return item[to.valueProp || 'value'];
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    getDisabledProp(item, to) {
        if (typeof to.disabledProp === 'function') {
            return to.disabledProp(item);
        }
        return item[to.disabledProp || 'disabled'];
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    getGroupProp(item, to) {
        if (typeof to.groupProp === 'function') {
            return to.groupProp(item);
        }
        return item[to.groupProp || 'group'];
    }
    /**
     * @private
     * @param {?} item
     * @param {?} to
     * @return {?}
     */
    shouldUseLegacyOption(item, to) {
        return !to.valueProp
            && !to.labelProp
            && item != null
            && typeof item === 'object'
            && 'key' in item
            && 'value' in item;
    }
}
FormlySelectOptionsPipe.ɵfac = function FormlySelectOptionsPipe_Factory(t) { return new (t || FormlySelectOptionsPipe)(); };
FormlySelectOptionsPipe.ɵpipe = /*@__PURE__*/ ɵngcc0.ɵɵdefinePipe({ name: "formlySelectOptions", type: FormlySelectOptionsPipe, pure: true });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FormlySelectOptionsPipe, [{
        type: Pipe,
        args: [{ name: 'formlySelectOptions' }]
    }], null, null); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LW9wdGlvbnMucGlwZS5qcyIsInNvdXJjZXMiOlsiQG5neC1mb3JtbHkvY29yZS9zZWxlY3Qvc2VsZWN0LW9wdGlvbnMucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxFQUFFLElBQUksWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7QUFJckMsTUFBTSxPQUFPLHVCQUF1QjtBQUFHO0FBQVE7QUFDdEM7QUFBeUI7QUFDL0I7QUFBUSxJQURULFNBQVMsQ0FBQyxPQUFPLEVBQUUsS0FBeUI7QUFDOUMsUUFBSSxJQUFJLENBQUMsQ0FBQyxPQUFPLFlBQVksVUFBVSxDQUFDLEVBQUU7QUFDMUMsWUFBTSxPQUFPLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3RDLFNBQUs7QUFDTCxRQUNJLE9BQU8sQ0FBQyxtQkFBQSxPQUFPLEVBQW1CLENBQUMsQ0FBQyxJQUFJLENBQ3RDLEdBQUc7QUFBTTtBQUE0QjtBQUV4QztBQUVPLFFBSkEsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLEVBQUMsQ0FDakQsQ0FBQztBQUNOLElBQUUsQ0FBQztBQUNIO0FBQ087QUFBZ0I7QUFBMEI7QUFDakM7QUFDYjtBQUFRLElBRkQsU0FBUyxDQUFDLE9BQU8sRUFBRSxLQUF3QjtBQUNyRDtBQUF5QixjQUFmLFFBQVEsR0FBVSxFQUFFO0FBQzlCO0FBQXlCLGNBQW5CLE1BQU0sR0FBNkIsRUFBRTtBQUMzQztBQUF5QixjQUFuQixFQUFFLEdBQUcsS0FBSyxDQUFDLGVBQWUsSUFBSSxFQUFFO0FBQ3RDLFFBQ0ksRUFBRSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7QUFDM0Is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SUFBSSxJQUFJLENBQUM7QUFDekIsSUFBRSxDQUFDO0FBQ0g7bURBN0ZDLElBQUksU0FBQyxFQUFFLElBQUksRUFBRSxxQkFBcUIsRUFBRTs7Ozs7MEJBQ2hDO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQaXBlLCBQaXBlVHJhbnNmb3JtIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiBhcyBvYnNlcnZhYmxlT2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEZvcm1seUZpZWxkQ29uZmlnIH0gZnJvbSAnQG5neC1mb3JtbHkvY29yZSc7XG5cbkBQaXBlKHsgbmFtZTogJ2Zvcm1seVNlbGVjdE9wdGlvbnMnIH0pXG5leHBvcnQgY2xhc3MgRm9ybWx5U2VsZWN0T3B0aW9uc1BpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcbiAgdHJhbnNmb3JtKG9wdGlvbnMsIGZpZWxkPzogRm9ybWx5RmllbGRDb25maWcpIHtcbiAgICBpZiAoIShvcHRpb25zIGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkpIHtcbiAgICAgIG9wdGlvbnMgPSBvYnNlcnZhYmxlT2Yob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIChvcHRpb25zIGFzIE9ic2VydmFibGU8YW55PikucGlwZShcbiAgICAgIG1hcCh2YWx1ZSA9PiB0aGlzLnRvT3B0aW9ucyh2YWx1ZSwgZmllbGQgfHwge30pKSxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSB0b09wdGlvbnMob3B0aW9ucywgZmllbGQ6IEZvcm1seUZpZWxkQ29uZmlnKSB7XG4gICAgY29uc3QgZ09wdGlvbnM6IGFueVtdID0gW10sXG4gICAgICBncm91cHM6IHsgW2tleTogc3RyaW5nXTogYW55W10gfSA9IHt9LFxuICAgICAgdG8gPSBmaWVsZC50ZW1wbGF0ZU9wdGlvbnMgfHwge307XG5cbiAgICB0by5fZmxhdE9wdGlvbnMgPSB0cnVlO1xuICAgIG9wdGlvbnMubWFwKChvcHRpb246IGFueSkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmdldEdyb3VwUHJvcChvcHRpb24sIHRvKSkge1xuICAgICAgICBnT3B0aW9ucy5wdXNoKHRoaXMudG9PcHRpb24ob3B0aW9uLCB0bykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG8uX2ZsYXRPcHRpb25zID0gZmFsc2U7XG4gICAgICAgIGlmICghZ3JvdXBzW3RoaXMuZ2V0R3JvdXBQcm9wKG9wdGlvbiwgdG8pXSkge1xuICAgICAgICAgIGdyb3Vwc1t0aGlzLmdldEdyb3VwUHJvcChvcHRpb24sIHRvKV0gPSBbXTtcbiAgICAgICAgICBnT3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIGxhYmVsOiB0aGlzLmdldEdyb3VwUHJvcChvcHRpb24sIHRvKSxcbiAgICAgICAgICAgIGdyb3VwOiBncm91cHNbdGhpcy5nZXRHcm91cFByb3Aob3B0aW9uLCB0byldLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGdyb3Vwc1t0aGlzLmdldEdyb3VwUHJvcChvcHRpb24sIHRvKV0ucHVzaCh0aGlzLnRvT3B0aW9uKG9wdGlvbiwgdG8pKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBnT3B0aW9ucztcbiAgfVxuXG4gIHByaXZhdGUgdG9PcHRpb24oaXRlbSwgdG8pIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGFiZWw6IHRoaXMuZ2V0TGFiZWxQcm9wKGl0ZW0sIHRvKSxcbiAgICAgIHZhbHVlOiB0aGlzLmdldFZhbHVlUHJvcChpdGVtLCB0byksXG4gICAgICBkaXNhYmxlZDogdGhpcy5nZXREaXNhYmxlZFByb3AoaXRlbSwgdG8pIHx8IGZhbHNlLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldExhYmVsUHJvcChpdGVtLCB0byk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiB0by5sYWJlbFByb3AgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiB0by5sYWJlbFByb3AoaXRlbSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2hvdWxkVXNlTGVnYWN5T3B0aW9uKGl0ZW0sIHRvKSkge1xuICAgICAgY29uc29sZS53YXJuKGBOZ3hGb3JtbHk6IGxlZ2FjeSBzZWxlY3Qgb3B0aW9uICd7a2V5LCB2YWx1ZX0nIGlzIGRlcHJlY2F0ZWQgc2luY2UgdjUuNSwgdXNlICd7dmFsdWUsIGxhYmVsfScgaW5zdGVhZC5gKTtcbiAgICAgIHJldHVybiBpdGVtLnZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBpdGVtW3RvLmxhYmVsUHJvcCB8fCAnbGFiZWwnXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VmFsdWVQcm9wKGl0ZW0sIHRvKTogc3RyaW5nIHtcbiAgICBpZiAodHlwZW9mIHRvLnZhbHVlUHJvcCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIHRvLnZhbHVlUHJvcChpdGVtKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zaG91bGRVc2VMZWdhY3lPcHRpb24oaXRlbSwgdG8pKSB7XG4gICAgICByZXR1cm4gaXRlbS5rZXk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGl0ZW1bdG8udmFsdWVQcm9wIHx8ICd2YWx1ZSddO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXREaXNhYmxlZFByb3AoaXRlbSwgdG8pOiBzdHJpbmcge1xuICAgIGlmICh0eXBlb2YgdG8uZGlzYWJsZWRQcm9wID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gdG8uZGlzYWJsZWRQcm9wKGl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gaXRlbVt0by5kaXNhYmxlZFByb3AgfHwgJ2Rpc2FibGVkJ107XG4gIH1cblxuICBwcml2YXRlIGdldEdyb3VwUHJvcChpdGVtLCB0byk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiB0by5ncm91cFByb3AgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiB0by5ncm91cFByb3AoaXRlbSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGl0ZW1bdG8uZ3JvdXBQcm9wIHx8ICdncm91cCddO1xuICB9XG5cbiAgcHJpdmF0ZSBzaG91bGRVc2VMZWdhY3lPcHRpb24oaXRlbSwgdG8pIHtcbiAgICByZXR1cm4gIXRvLnZhbHVlUHJvcFxuICAgICAgJiYgIXRvLmxhYmVsUHJvcFxuICAgICAgJiYgaXRlbSAhPSBudWxsXG4gICAgICAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCdcbiAgICAgICYmICdrZXknIGluIGl0ZW1cbiAgICAgICYmICd2YWx1ZScgaW4gaXRlbTtcbiAgfVxufVxuIl19