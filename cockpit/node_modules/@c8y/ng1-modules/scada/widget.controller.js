"use strict";!function(){function i(e,n,c,t,d,a,o){var r=this;function u(n){return _.find(r.devices,function(i){return n===i.id})}this.init=function(){e.child.config.deviceIds||(e.child.config.deviceIds={},_.forOwn(e.child.config.mapping,function(i,n){e.child.config.deviceIds[n]=e.child.config.device.id}));var i=_(e.child.config.deviceIds).values().uniq().map(function(i){return d.detailRealtime(i,e,function(i){i.name=c("truncate")(i.name)})}).value();n.all(i).then(function(i){r.devices=i,r.updateComputedProperties(e.child.config.deviceIds,e.child.config.mapping)}),t.detail(e.child.config.binaryId).then(function(i){r.svgFile=i.data,t.downloadAsDataUri(r.svgFile).then(t.decodeDataUri).then(function(i){r.svgFile.data=o.sanitizeString(i)})})},this.updateComputedProperties=function(i,c){i&&c&&_.forOwn(i,function(i,n){var e=[c[n]];e.length&&a.attach(u(i),e)})},e.$watch("child.config",this.init,!0),e.$on("$destroy",function(){var i=_.uniq(_.values(e.child.config.deviceIds));_.forEach(i,function(i){a.detach(u(i))})})}i.$inject=["$scope","$q","$filter","c8yBinary","c8yDevices","c8yComputedProperties","c8ySanitizeHtml"],angular.module("c8y.parts.scadaWidget").controller("ScadaWidgetCtrl",i)}();