"use strict";!function(){var o,c,r=!1;window.onload=function(){var e=document.getElementById("terminal"),t=new Terminal({fontSize:18,fontFamily:"consolas, monospace",cursorBlink:!0,cols:terminalSize.cols,rows:terminalSize.rows}),i=new ShellAdapter;i.setTermType("xterm-256color");var n=clientService.getParams();n?(clientService.setConnectionStatus(clientService.STATUSES.CONNECTING),document.title=unescape(n.title),o=n.wsProtocol+"//"+n.host+"/"+n.path,t.open(e),t.focus(),setTimeout(function(){(c=new WebSocket(o,"binary")).binaryType="arraybuffer",c.onopen=function(){t.writeln("[92mWebsocket connection was established successfully, waiting for device... [39m \r\n")},c.onclose=function(){t.writeln(""),t.writeln("\r\n[91mDevice disconnected. [39m \r\n"),t.writeln("\r\n[91mWebsocket connection was closed. [39m \r\n"),clientService.setConnectionStatus(clientService.STATUSES.ERROR)},c.onmessage=function(e){e.data&&clientService.getConnectionStatus()===clientService.STATUSES.CONNECTING&&clientService.setConnectionStatus(clientService.STATUSES.CONNECTED),r||(r=!0,t.writeln("[92mDevice connection was established successfully. [39m \r\n"));var n=i.filterReceiveData(e.data);n.dataToSend.length&&c.send(n.dataToSend),n.dataToDisplay.length&&t.write(n.dataToDisplay)},t.on("data",function(e){if(r){var n=i.filterSendData(e);n.length&&c.send(n)}}),window.onbeforeunload=function(){for(var e="exit\n",n=[],t=0;t<e.length;t++)n.push(e.charCodeAt(t));c.send(new Uint8Array(n))}})):(t.writeln(""),t.writeln("\r\n[91mConnection parameters could not be retrieved. Please close this window and try again [39m \r\n"),clientService.setConnectionStatus(clientService.STATUSES.ERROR))}}();