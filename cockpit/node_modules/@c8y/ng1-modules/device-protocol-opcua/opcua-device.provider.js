"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(){e.$inject=["c8yDeviceTypeProtocolBaseProvider","gettext"];var r="c8yOPCUADevice";function e(e,c){t.$inject=["c8yDeviceDatabase","c8yDeviceControl","c8yDevices","c8yBase","c8yUser","c8yTenant","$q"];var s={label:c("OPC UA legacy"),fieldbusType:"opcua",serviceName:r};return e.getDeviceTypeProtocolProvider(s,t);function t(t,u,o,d,n,r,a){var i=_objectSpread({},s,{options:!1,discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{sectionTitle:c("Variables"),noRegistersDefinedMessage:c("No variables defined."),elementTypeLabel:c("Variable"),newRegisterModalTitle:c("New variable"),editRegisterModalTitle:c('Edit variable: "{{name}}"'),addRegisterButtonLabel:c("Add variable"),validation:{invalidName:c("Name must be unique among variables."),invalidMeasurement:c("Selected measurement type and series are already used by another variable.")},browsePath:!0,nodeType:!0,attributeType:!0,multiplier:{min:1,step:1},divisor:!0,decimalPlaces:!0,unit:!0,options:{signed:!0,enumType:!0},functionalities:{showStatus:!0,updateStatus:!0,sendMeasurement:!0,raiseAlarm:!0,sendEvent:!0}},inputRegisters:!1,deviceFragments:["c8y_OPCUADevice","c8y_OPCUAGateway"],deviceConfiguration:{fragment:"c8y_OPCUAGateway",icon:"cogs"}});return{registerFeaturesManifest:function(){t.registerFeaturesManifest(function(){var e={isFeatureFieldbus4Subscribed:t.isFeatureFieldbus4Available(),isOpcuaLegacySubscribed:r.isSubscribed({name:"feature-opcua-legacy"})};return a.all(e).then(function(e){return e.isFeatureFieldbus4Subscribed&&e.isOpcuaLegacySubscribed})}().then(function(e){return e&&i}))},create:function(a,i){var c,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(l(a,i));case 2:return c=e.sent,e.t0=d,e.next=6,regeneratorRuntime.awrap(o.createConfirm(c));case 6:return e.t1=e.sent,s=e.t0.getResData.call(e.t0,e.t1),e.next=10,regeneratorRuntime.awrap(o.addChildDevice(a,s));case 10:return s.owner=a.owner,e.next=13,regeneratorRuntime.awrap(o.save(s));case 13:return e.abrupt("return",u.create((t=a,r=i.deviceType,n=s,{deviceId:t.id,description:'Added new child device to "'.concat(t.name,'" (ID: ').concat(t.id,")."),c8y_OPCUADevice:{id:n.id,name:n.name,browsePath:n.c8y_OPCUADevice.browsePath,type:"/inventory/managedObjects/".concat(r.id)}})));case 14:case"end":return e.stop()}var t,r,n},null,null,null,Promise)},isOpcua:function(e){return!!(e||{}).c8y_OPCUADevice}};function l(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(n.current());case 2:return r=e.sent,e.abrupt("return",{name:t.name,type:t.deviceType.name,c8y_OPCUADevice:{browsePath:t.directoryPath,type:"/inventory/managedObjects/".concat(t.deviceType.id)},owner:r.id});case 4:case"end":return e.stop()}},null,null,null,Promise)}}}angular.module("c8y.opcua").provider(r,e)}();