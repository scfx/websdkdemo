"use strict";!function(){function t(e,r,n,o,a){var l=this,i={inProgress:!1,progress:0,label:null};function s(t){i.inProgress=t,l.wizardCtrl.setAllowUserInteraction(!t)}function u(t,r){return o.upload(t.file).progress(function(t){!function(t,r){var e=i.multipleProgress;e[r]=10+t.loaded/t.total*90,i.progress=_.sum(e)/e.length}(t,r)}).then(n.getResData)}function c(t){i.progress=100,l.wizardCtrl.data.updloadResult=function(t){return t.reduce(function(e,t){return _.forEach(t,function(t,r){e[r]=_.get(e,r,[]).concat(t)}),e},{})}(t),r(_.partial(l.wizardCtrl.goTo,"c8yLwm2mFinalStep"),200)}function g(t){var r=t.data,e=l.wizardCtrl,n=e.data;n.errorMsg=_.get(r,"message")||a("Parsing the DDF file resulted in an internal error"),n.backStep=e.getCurrentStep().stepId,e.goTo("error")}function p(){s(!1)}_.assign(l,{upload:function(t){s(!0),i.progress=0,i.multipleProgress=_.fill(Array(t.length),0);var r=_.map(t,u);return e.all(r).then(c,g).then(p,p)},processingStatus:i})}t.$inject=["$q","$timeout","c8yBase","c8yLwm2m","gettext"],angular.module("c8y.lwm2m").component("c8yLwm2mUploadStep",{templateUrl:":::PLUGIN_PATH:::/lwm2mUploadStep.html",require:{wizardCtrl:"^c8yWizardStep"},controllerAs:"vm",controller:t})}();