"use strict";!function(){function n(n,e,u,c,t,r,i,o){var a=[],s={loading:!0};function l(){s.loading=!1}function f(n){return _.filter(n,function(n){return!n.hideFromList})}function h(n){var t,e=_.keys(r);return 0===e.length?n:_.filter(n,function(n){return!!(n.contexts&&(t=_.keys(n.contexts),0<_.intersection(e,t).length))})}function m(n){return _.filter(n,function(n){return!i||i(n)})}function v(n){n.forEach(function(n){a.push(n)})}function d(){1===a.length&&a[0]._active&&g(a[0])}function g(n){var t;return n._active&&(t=c.createInstanceWithUI(n,function(t){var e={},n=t.contexts&&_.intersection(_.keys(r),_.keys(t.contexts))||[];return _.forEach(n,function(n){var i={obj:r[n]},o={rule:e};_.forEach(t.contexts[n],function(n,t){var e=u("obj.".concat(t)),c=u("rule.".concat(n)),r=e(i);c.assign(o,r)})}),_.assign(e,o)}(n)).then(e.close)),t}n.ruleTemplates=a,n.cancel=function(){e.dismiss()},n.createInstance=g,n.loading=s,t.list().then(f).then(h).then(m).then(v).then(d).finally(l)}n.$inject=["$scope","$uibModalInstance","$parse","smartRulesSvc","smartRuleTemplatesSvc","context","ruleTemplatesFilterFn","ruleInitialObj"],angular.module("c8y.smartRules").controller("SmartRuleAddCtrl",n)}();