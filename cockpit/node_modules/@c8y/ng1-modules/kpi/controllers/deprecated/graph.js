"use strict";angular.module("c8y.parts.kpi").controller("kpiGraphCtrl",["$scope","$routeParams","c8yKpi",function(t,n,e){function c(){var i=n.deviceId;return t.child.config&&t.child.config.device&&t.child.config.device.id&&(i=t.child.config.device.id),i}t.$watch("child.config.kpis",function(i){var n=_.filter(_.map(i,"moId"),_.identity);e.listByIds(n).then(function(i){return _.map(i,function(i){return i.c8y_Kpi||i})}).then(function(n){return _.map(i,function(i){return _.find(n,{fragment:i.fragment,series:i.series})||i})}).then(function(i){t.deviceId=c(),t.kpis=i})}),t.$watch("child.config.timeInterval",function(i){t.interval=i}),t.$watch("child.config.aggregationType",function(i){t.aggregationType=i}),t.deviceId=c(),t.autoStart=!0}]);