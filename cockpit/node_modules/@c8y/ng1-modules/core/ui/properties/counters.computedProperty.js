"use strict";!function(){function e(r){var n={},e="YYYY-MM-DD",t=moment().startOf("day").format(e),o=moment().subtract(3,"months").format(e),a={alarmCountToday:{dateFrom:t,service:"c8yAlarms"},alarmCount3Months:{dateFrom:o,service:"c8yAlarms"},eventCountToday:{dateFrom:t,service:"c8yEvents"},eventCount3Months:{dateFrom:o,service:"c8yEvents"}};return _.forEach(a,function(e,t){e.name=t,r.register(t,[e.service,"config",function(r){return function(o,e){var a=_.merge({},r,e),c=new WeakMap;n[a.name]=n[a.name]||{};var i=n[a.name],d=a.type||"";function t(e){i[e.id]=i[e.id]||{};var t=i[e.id],r=t[d];r||(t[d]=o.createCounter({dateFrom:a.dateFrom,type:a.type,source:e.id}),(r=t[d]).removeFromCache=function(){return delete t[d]},r.devices=new Set,r.start());var n=c.get(e);return n||(n=new Set,c.set(e,n)),r.devices.has(e)||r.devices.add(e),n.has(r)||n.add(r),r.count}return t.detach=function(t){(c.get(t)||[]).forEach(function(e){e.devices.delete(t),e.devices.size||(e.removeFromCache(),e.stop())}),c.delete(t)},t}}(e)])}),{$get:c}}function c(){return{attach:function(){console.warn("method deprecated: please use the generic computed property api")}}}e.$inject=["c8yComputedPropertiesProvider"],angular.module("c8y.ui").provider("c8yCountersConfig",e)}();