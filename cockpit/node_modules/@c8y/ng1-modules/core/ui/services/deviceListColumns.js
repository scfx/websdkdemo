"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(){function e(a,e,t,u,y){function i(e){return"/device/".concat(e.id)}function n(){var e="c8y_RequiredAvailability.responseInterval",t=_defineProperty({},e,{__le:0}),n={__not:{__has:e}},i="c8y_Availability.status",r=_defineProperty({},i,"AVAILABLE"),a=_defineProperty({},i,"UNAVAILABLE"),s=_defineProperty({},i,"MAINTENANCE"),o={__not:{__has:i}},l="c8y_Connection.status",c=_defineProperty({},l,"CONNECTED"),m=_defineProperty({},l,"DISCONNECTED"),p=_defineProperty({},l,"MAINTENANCE"),g={__or:[t,s,p]},d={__and:[{__not:t},{__not:s},{__not:p}]};return{name:"status",header:u("Status"),cell:{style:{width:"90px"},class:{"text-center":!0},template:'<c8y-device-status-display device="item"></c8y-device-status-display>'},filtering:{schema:{type:"object",properties:{sendOnline:{type:"boolean"},sendOffline:{type:"boolean"},sendUnknown:{type:"boolean"},sendNotMonitored:{type:"boolean"},pushOnline:{type:"boolean"},pushOffline:{type:"boolean"},pushNotMonitored:{type:"boolean"},maintenance:{type:"boolean"}}},form:[{type:"template",template:["<label><span translate>",u("Show devices with send status"),"</span>:</label>"].join("")},{key:"sendOnline",title:y.getString("Online")},{key:"sendOffline",title:y.getString("Offline")},{key:"sendUnknown",title:y.getString("Unknown")},{key:"sendNotMonitored",title:y.getString("Not monitored")},{type:"template",template:["<label><span translate>",u("Show devices with push status"),"</span>:</label>"].join("")},{key:"pushOnline",title:y.getString("Online")},{key:"pushOffline",title:y.getString("Offline")},{key:"pushNotMonitored",title:y.getString("Not monitored")},{type:"template",template:["<label><span translate>",u("Show devices with maintenance status"),"</span>:</label>"].join("")},{key:"maintenance",title:y.getString("Device is under maintenance")}],getFilter:function(e){var t={},i=[];return e&&(e.sendOnline&&i.push({__and:[d,r]}),e.sendOffline&&i.push({__and:[d,a]}),e.sendUnknown&&i.push({__and:[d,o]}),(e.sendNotMonitored||e.pushNotMonitored)&&i.push(n),e.pushOnline&&i.push({__and:[d,c]}),e.pushOffline&&i.push({__and:[d,m]}),e.maintenance&&i.push(g),i.length&&(t.__or=i)),t}},sorting:{path:"c8y_Availability.status"}}}function r(){return{name:"name",header:u("Name"),style:{"min-width":"200px"},cell:{template:['<a ng-href="#{{getDeviceLink(item)}}" title="{{item.properName}}" class="interact">',"  {{item.properName}}","</a>"].join("\n"),scopeExtensions:{getDeviceLink:i},class:"table-cell-truncate",innerClass:"truncated-cell-content"},filtering:{schema:{type:"object",properties:{names:{type:"array",items:{type:"string"}}}},form:[{key:"names",title:y.getString("Show devices with name"),add:y.getString("Or"),items:[{key:"names[]",notitle:!0,placeholder:y.getString("e.g. My Device, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"names","name")},sorting:{path:"name"}}}function s(){return{name:"model",header:u("Model"),cell:{template:"{{model(item)}}",scopeExtensions:{model:e.model}},filtering:{schema:{type:"object",properties:{models:{type:"array",items:{type:"string"}}}},form:[{key:"models",title:y.getString("Show devices with model"),add:y.getString("Or"),items:[{key:"models[]",notitle:!0,placeholder:y.getString("e.g. ModelName, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"models","c8y_Hardware.model")},sorting:{path:"c8y_Hardware.model"}}}function o(){return{name:"serialNumber",header:u("Serial number"),cell:{template:"{{serial(item)}}",scopeExtensions:{serial:e.serial}},filtering:{schema:{type:"object",properties:{serialNumbers:{type:"array",items:{type:"string"}}}},form:[{key:"serialNumbers",title:y.getString("Show devices with serial number"),add:y.getString("Or"),items:[{key:"serialNumbers[]",notitle:!0,placeholder:y.getString("e.g. 54321-123, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"serialNumbers","c8y_Hardware.serialNumber")},sorting:{path:"c8y_Hardware.serialNumber"}}}function l(){return{name:"group",header:u("Group"),cell:{template:"\n            <span title=\"{{getAssetParentsNames(item.assetParents.references,\n              ctrl.columnsConfig['group'].filtering.deviceGroupId)}}\">\n              {{getAssetParentsNames(item.assetParents.references,\n                ctrl.columnsConfig['group'].filtering.deviceGroupId)}}\n            </span>\n          ",scopeExtensions:{getAssetParentsNames:function(e,t){var i=_.map(e,"managedObject"),n=_.sortBy(i,["name"]),r=_.remove(n,{id:t}).concat(n);return _.map(r,"name").join(", ")}}},filtering:{schema:{type:"object",properties:{deviceGroupId:{type:"integer",format:"deviceGroupId"}}},form:[{key:"deviceGroupId",title:y.getString("Show devices in group")}],getFilter:function(e){var t={};return e.deviceGroupId&&(t.__bygroupid=e.deviceGroupId),t}}}}function c(){return{name:"registrationDate",header:u("Registration date"),cell:{template:"{{item.creationTime | absoluteDate}}"},filtering:{schema:{type:"object",properties:{registrationDate:{type:"object",properties:{after:{type:"string",format:"datetime"},before:{type:"string",format:"datetime"}}}}},form:[{key:"registrationDate.after",title:y.getString("Show devices registered after"),maxDateKey:"registrationDate.before"},{key:"registrationDate.before",title:y.getString("And before`date`"),minDateKey:"registrationDate.after"}],getFilter:function(e){var t={},i=e&&e.registrationDate;if(i&&(i.after||i.before)){if(t.__and=[],i.after){var n=moment(i.after).format(a.dateFullFormat);t.__and.push({__or:{creationTime:{__gt:n},"creationTime.date":{__gt:n}}})}if(i.before){var r=moment(e.registrationDate.before).format(a.dateFullFormat);t.__and.push({__or:{creationTime:{__lt:r},"creationTime.date":{__lt:r}}})}}return t}},sorting:{paths:[{path:"creationTime.date",orderModifier:1},{path:"creationTime",orderModifier:1}]}}}function m(){return{name:"systemId",header:u("System ID"),cell:{template:"{{item.id}}"},filtering:{schema:{type:"object",properties:{ids:{type:"array",items:{type:"string"}}}},form:[{key:"ids",title:y.getString("Show devices with system ID"),add:y.getString("Or"),items:[{key:"ids[]",notitle:!0,placeholder:y.getString("e.g. 10300, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"ids","id")},sorting:{path:"id"}}}function p(){return{name:"imei",order:8,header:u("IMEI"),cell:{template:"{{item.c8y_Mobile.imei}}"},filtering:{schema:{type:"object",properties:{imeis:{type:"array",items:{type:"string"}}}},form:[{key:"imeis",title:y.getString("Show devices with IMEI"),add:y.getString("Or"),items:[{key:"imeis[]",notitle:!0,placeholder:y.getString("e.g. 46543432321, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"imeis","c8y_Mobile.imei")},sorting:{path:"c8y_Mobile.imei"}}}function g(){return{name:"alarms",header:u("Alarms"),cell:{class:{"text-center":!0},style:{"min-width":"130px"},template:['<a ng-href="#{{getDeviceAlarmsLink(item)}}" class="listLink">','  <small class="status critical" ng-if="item.c8y_ActiveAlarmsStatus.critical" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.critical}} <i c8y-icon="warning"></i>',"  </small>",'  <small class="status major" ng-if="item.c8y_ActiveAlarmsStatus.major" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.major}} <i c8y-icon="exclamation-circle"></i>',"  </small>",'  <small class="status minor" ng-if="item.c8y_ActiveAlarmsStatus.minor" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.minor}} <i c8y-icon="exclamation-circle"></i>',"  </small>",'  <small class="status warning" ng-if="item.c8y_ActiveAlarmsStatus.warning" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.warning}} <i c8y-icon="circle"></i>',"  </small>","</a>"].join("\n"),scopeExtensions:{getDeviceAlarmsLink:function(e){return[i(e),"alarms"].join("/")}}},filtering:{schema:{type:"object",properties:{critical:{type:"boolean"},major:{type:"boolean"},minor:{type:"boolean"},warning:{type:"boolean"},none:{type:"boolean"}}},form:[{type:"template",template:["<label><span translate>",u("Show devices with active"),"</span>:</label>"].join("")},{key:"critical",title:y.getString("Critical alarms")},{key:"major",title:y.getString("Major alarms")},{key:"minor",title:y.getString("Minor alarms")},{key:"warning",title:y.getString("Warnings")},{key:"none",title:y.getString("No alarms")}],getFilter:function(e){var t={},i=[];return e.critical&&i.push({"c8y_ActiveAlarmsStatus.critical":{__gt:0}}),e.major&&i.push({"c8y_ActiveAlarmsStatus.major":{__gt:0}}),e.minor&&i.push({"c8y_ActiveAlarmsStatus.minor":{__gt:0}}),e.warning&&i.push({"c8y_ActiveAlarmsStatus.warning":{__gt:0}}),e.none&&(i.push({__not:{__has:"c8y_ActiveAlarmsStatus"}}),i.push({__and:_.map(["critical","major","minor","warning"],function(e){var t={},i={__not:{__has:void 0}},n="c8y_ActiveAlarmsStatus.".concat(e);return t[n]=0,i.__not.__has=n,{__or:[t,i]}})})),i.length&&(t.__or=i),t}}}}function d(t){return{name:"removalColumn",cell:{class:{"text-center":!0},style:{"min-width":"130px"},template:['<button class="btn-dot showOnHover"\n              uib-tooltip="{{\''.concat(u("Delete device"),'\' | translate}}"\n              tooltip-append-to-body="true"\n              tooltip-placement="left"\n              ng-click="onClickDelete(item)">'),'  <i c8y-icon="minus-circle" class="text-danger"></i>',"</button>"].join("\n"),scopeExtensions:{onClickDelete:function(e){t&&t(e)}}}}}return{getStatusColumn:n,getNameColumn:r,getModelColumn:s,getSerialNumberColumn:o,getGroupColumn:l,getRegistrationDateColumn:c,getSystemIdColumn:m,getImeiColumn:p,getAlarmsColumn:g,getRemovalColumn:d,getParentDeviceColumns:function(e){var t=e||{};return[n(),r(),s(),o(),l(),c(),m(),p(),g(),d(t.clickDeleteCallback)]},getChildDeviceColumns:function(e){var t=e||{};return[n(),r(),s(),o(),c(),m(),p(),g(),d(t.clickDeleteCallback)]}}}e.$inject=["c8yBase","c8yDevices","c8yFilteringSortingInventoryQueries","gettext","gettextCatalog"],angular.module("c8y.ui").factory("c8yDeviceListColumns",e)}();