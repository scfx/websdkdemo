"use strict";function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_unsupportedIterableToArray(t,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function _iterableToArrayLimit(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,a,o=[],i=!0,c=!1;try{for(e=e.call(t);!(i=(n=e.next()).done)&&(o.push(n.value),!r||o.length!==r);i=!0);}catch(t){c=!0,a=t}finally{try{i||null==e.return||e.return()}finally{if(c)throw a}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}angular.module("c8y.core").directive("c8ySunburstChart",[function(){return{priority:1e3,terminal:!0,restrict:"A",scope:{data:"=chartData"},compile:function(){return function(t,e){var r=_slicedToArray(e,1)[0],n=e.width(),a=n,o=n/2,i=d3.select(r).append("svg").attr("width",n).attr("height",a).append("g").attr("transform","translate(".concat([o,o],")")),c=d3.scale.linear().range([0,2*Math.PI]),l=d3.scale.sqrt().range([0,o]),u=d3.layout.partition().value(function(t){return t.value}),s=d3.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,c(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,c(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,l(t.y))}).outerRadius(function(t){return Math.max(0,l(t.y+t.dy))});function d(t){var r=t.depth?180*c(t.x+t.dx/2)/Math.PI-90:0;return"rotate(".concat(0+r,")translate(").concat(l(t.y),")rotate(").concat(90<r?-180:0,")")}function y(t){return t.class}function f(t){return t.depth?c(t.x+t.dx/2)>Math.PI?"end":"start":"middle"}function p(t){return t.text?t.text.class:""}t.$watch("data",function(t){if(i.selectAll("*").remove(),_.isObjectLike(t)){e.find("center").remove();var r=u.nodes(t);i.selectAll("*").remove(),i.selectAll("path").data(r).enter().append("path").attr("id",function(t,r){return"path-".concat(r)}).attr("d",s).attr("class",y),i.selectAll("text").data(r).enter().append("text").style("fill-opacity",1).attr("class",p).attr("text-anchor",f).style("font-size",function(t){return t.text?t.text.size:""}).attr("dy",".2em").attr("transform",d).append("tspan").attr("x",0).text(function(t){return t.name?t.name:""})}else e.prepend('<center><i class="icon-spinner icon-spin  icon-3x "></i></center')})}}}}]);