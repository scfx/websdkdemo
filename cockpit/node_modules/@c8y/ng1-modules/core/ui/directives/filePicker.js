"use strict";!function(){function e(e,i,l){var n=this,t=128;function o(){n.files.push({file:null})}function c(e){return 0===n.allowedFileType.length||-1<n.allowedFileType.indexOf(i.getFileGenericType(e))}function r(e){return t>e.name.length}function s(e){return c(e)&&n.hasValidSize(e)&&r(e)}_.assign(n,{$onInit:function(){i.getBytesSizeLimitAsync().then(function(e){n.fileSizeLimit=e}),n.files=n.files||[],n.allowedFileType=n.allowedFileType||[],0===n.files.length&&o()},add:o,remove:function(i){i.file=null;var e=_.findIndex(n.files,function(e){return e===i});n.files.splice(e,1),n.onFileRemoved(i),0===n.files.length&&o()},onFileSelect:function(e,i){0<i.length&&(e.file=i[0],n.onFileSelected&&s(e.file)&&n.onFileSelected(e.file))},checkFileType:c,checkMaxLength:r,isValid:s,hasValidSize:i.hasValidSize}),e.$watch(function(){return n.processingStatus()},function(e){n.process=e||{},n.process.label=n.process.label||l("Processing")},!0)}e.$inject=["$scope","c8yBinary","gettext"],angular.module("c8y.ui").directive("filePicker",function(){return{restrict:"E",scope:{files:"=?",required:"=?",multiple:"=?",disabled:"=?",allowedFileType:"=?",displayDropZone:"&",dropZoneIcon:"&",dropZoneLabel:"&",dropZoneHideHint:"&",onFileSelected:"&",onFileRemoved:"&",processingStatus:"&"},templateUrl:":::PLUGIN_PATH:::/ui/views/filePicker.html",controller:e,controllerAs:"vm",bindToController:!0}})}();