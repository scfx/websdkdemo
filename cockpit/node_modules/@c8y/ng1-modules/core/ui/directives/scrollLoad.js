"use strict";!function(f){function t(a){return{restrict:"A",scope:{containerSelector:"@c8yScrollLoadContainer",onAppear:"&c8yScrollLoadOnAppear",onDisappear:"&c8yScrollLoadOnDisappear"},link:function(t,o){var r,n,i=!1,e=_.throttle(function(){n=function(t){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=f(window),i={top:n.scrollTop(),left:n.scrollLeft()};i.right=i.left+n.width(),i.bottom=i.top+n.height();var e=t.outerHeight(),l=t.outerWidth();if(!l||!e)return!1;var c=t.offset();if(c.right=c.left+l,c.bottom=c.top+e,i.right<c.left||i.left>c.right||i.bottom<c.top||i.top>c.bottom)return!1;var a={top:Math.min(1,(c.bottom-i.top)/e),bottom:Math.min(1,(i.bottom-c.top)/e),left:Math.min(1,(c.right-i.left)/l),right:Math.min(1,(i.right-c.left)/l)};return o<=a.left*a.right&&r<=a.top*a.bottom}(f(o),.5,.5),!i&&n&&c(t.onAppear),i&&!n&&c(t.onDisappear),i=n},500,{leading:!1,trailing:!0});function l(){r&&(r.unbind("scroll",e),f(window).unbind("scroll",e))}function c(t){a(t,100)}t.$watch("containerSelector",function(){l(),(r=f(o).closest(t.containerSelector)).bind("scroll",e),f(window).bind("scroll",e),c(e)}),t.$on("c8yScrollLoad::refresh",e),t.$on("$destroy",l)}}}t.$inject=["$timeout"],angular.module("c8y.ui").directive("c8yScrollLoad",t)}(jQuery);