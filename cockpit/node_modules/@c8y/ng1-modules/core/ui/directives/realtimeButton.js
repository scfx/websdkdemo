"use strict";!function(){function t(s,t){return n.$inject=["$scope","$log"],{scope:{channel:"@",data:"&onData",dataUpdate:"&onDataUpdate",subscribed:"&onSubscribed",state:"="},replace:!0,restrict:"EA",template:'<button class="btn btn-link c8y-realtime" ng-click="on()" ng-disabled="!channel"><span class="c8y-pulse {{icon()}}"></span> {{\''.concat(t("Realtime"),"' | translate}}</button>"),controller:n,require:{formCtrl:"?^^form"},link:function(t,n,a,e){t.formCtrl=e.formCtrl}};function n(e,c){var r=e.$id;function o(t,n){s.addListener(t,n,"CREATE",a),s.addListener(t,n,"UPDATE",i),s.start(t,n)}function a(t,n){e.data({$data:n})}function i(t,n){e.dataUpdate({$data:n})}function l(t){try{s.removeSubscriber(r,t)}catch(t){c.warn(t)}}e.icon=function(){return s.icon(e.state||!1)},e.on=function(){e.state=!e.state,e.formCtrl&&!e.formCtrl.$dirty&&e.formCtrl.$setDirty()},e.$watch("channel",function(t,n){n&&n!==t&&l(n);t&&e.state&&o(r,t)}),e.$watch("state",function(t,n){if(t===n)return;var a=e.channel;a&&t&&o(r,a);!t&&a&&function(t,n){try{s.stop(t,n)}catch(t){c.warn(t)}}(r,a)}),e.$on("$destroy",function(){var t=e.channel;t&&l(t)})}}t.$inject=["c8yRealtime","gettext"],angular.module("c8y.ui").directive("c8yRealtimeButton",t)}();