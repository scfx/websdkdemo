"use strict";!function(){function t(t){var r="registrationDataHistory",n=500,o=1,e="month",i={history:[]},c={};function s(){t.get(r).then(function(t){i=t||i})}return s(),c.commit=function(){!function(){var r=moment().local().subtract(o,e);_.remove(i.history,function(t){return moment(t.timestamp).isBefore(r)})}(),t.set(r,i)},c.pull=s,c.clearHistory=function(){i={history:[]}},c.add=function(t){!function(t){_.merge(t,{timestamp:moment().local().format()})}(t),i.history.push(function(t){var r=_.cloneDeep(t);return delete r.trackerPassword,r}(t)),function(){var t=i.history.length;n<t&&(i.history=_.drop(i.history,t-n))}()},c.list=function(){return i.history},c.find=function(r){return _.findLast(i.history,function(t){return t.trackerIMEI===r})},c.cleanByIMEI=function(r){_.remove(i.history,function(t){return t.trackerIMEI===r})},c}t.$inject=["c8yUserPreferences"],angular.module("c8y.tracking.trackerRegistration").factory("trackerRegistrationHistorySvc",t)}();