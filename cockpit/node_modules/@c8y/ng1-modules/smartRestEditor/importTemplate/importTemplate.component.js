"use strict";!function(){function e(t,e,l,n,a,o){var r=this;function i(e){return t.create(e.template,e.externalId).then(c,m)}function c(e){r.onImported({importedTemplate:e})}function m(e){_.isObjectLike(e)&&(e.errorMessage?l.danger(a.getString('Could not import template due to: "{{errorMessage | translate}}".',e)):l.danger(o("Could not import template.")))}r.importTemplate=function(){return e({templateUrl:":::PLUGIN_PATH:::/importTemplate/importTemplate.modal.html",controller:s,controllerAs:"$ctrl",size:"sm"}).then(i)}}function s(n,e,t,a,o){var r=this;r.selection={file:null,template:null,newName:{value:null,edited:!1},newExternalId:{value:null,edited:!1}},r.externalIdType=t.externalIdType,r.onSmartRestTemplateFileSelected=function(l){if(l.length){var e=new FileReader;e.onload=function(t){n.$apply(function(){try{var e=JSON.parse(t.target.result);!function(e,t){r.selection.file=e,r.selection.template=t,r.selection.newName.value=r.selection.newName.edited?r.selection.newName.value:t.name,r.selection.newExternalId.value=r.selection.newExternalId.edited?r.selection.newExternalId.value:t.__externalId,n.importForm.name.$setTouched(),n.importForm.externalId.$setTouched()}(l[0],e)}catch(e){a.danger(o("Cannot load template from selected file.")),r.selection.file=null,r.selection.template=null}})},e.readAsText(l[0])}},r.importSelectedTemplate=function(){e.close({template:_.assign(r.selection.template,{name:r.selection.newName.value}),externalId:r.selection.newExternalId.value})},r.cancel=e.dismiss}s.$inject=["$scope","$uibModalInstance","c8ySmartRestTemplates","c8yAlert","gettext"],e.$inject=["c8ySmartRestTemplates","c8yModal","c8yAlert","c8yLocales","gettextCatalog","gettext"],angular.module("c8y.smartRestEditor").component("c8ySmartRestImportTemplate",{bindings:{onImported:"&"},templateUrl:":::PLUGIN_PATH:::/importTemplate/importTemplate.button.html",controller:e,controllerAs:"$ctrl"})}();