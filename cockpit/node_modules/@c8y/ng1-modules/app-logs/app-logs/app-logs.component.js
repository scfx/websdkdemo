"use strict";function _slicedToArray(n,t){return _arrayWithHoles(n)||_iterableToArrayLimit(n,t)||_unsupportedIterableToArray(n,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(n,t){if(n){if("string"==typeof n)return _arrayLikeToArray(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(n,t):void 0}}function _arrayLikeToArray(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function _iterableToArrayLimit(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,o,a=[],i=!0,c=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(n){c=!0,o=n}finally{try{i||null==e.return||e.return()}finally{if(c)throw o}}return a}}function _arrayWithHoles(n){if(Array.isArray(n))return n}!function(){function n(n,t,e,o,a){var i=this;function r(n){return i.mo=n,i.mo}function c(n){var t=_.get(n,"c8y_Status.instances"),e=_.map(t,function(n,t){return t});_.isEmpty(e)||(i.instances=function(n){var e=moment().format();return n.reduce(function(n,t){return n[t]={name:t,dateFrom:e},n},{})}(e))}function s(){var n=_slicedToArray(Object.keys(i.instances),1)[0];i.selectedInstance=_.cloneDeep(_.get(i,["instances",n]))}function l(){return u(!0),m(i.mo.applicationId,i.selectedInstance.name).then(function(n){return d(n)})}function u(n){i.isRequestPending=n}function m(n,t,e,r){return o.getLogs(n,t,{dateFrom:e,dateTo:r}).finally(function(){u(!1)})}function d(n,t,e){if(u(!1),_.isEmpty(n.logs)){var r=o.getWarningMessageForMissingLogs(t,e);a.info(r)}else _.assign(i.selectedInstance,n)}_.assign(i,{$onInit:function(){e.getApplicationMO(n.applicationId).then(r).then(c).then(s).then(l)},selectedInstance:void 0,nextBtnClick:function(){u(!0);var n=i.mo.applicationId,t=i.selectedInstance.name,e=moment(_.get(i,"selectedInstance.dateTo")).format();return m(n,t,e,void 0).then(function(n){return d(n,e)})},backBtnClick:function(){u(!0);var n=i.mo.applicationId,t=i.selectedInstance.name,e=moment(_.get(i,"selectedInstance.dateFrom")).format();return m(n,t,void 0,e).then(function(n){return d(n,void 0,e)})},loadLatestLogs:l,onInstanceChange:function(n){i.selectedInstance=_.cloneDeep(n),l()},loadLogsFromDate:function(n){u(!0);var t=o.formatDateChosenByUser(moment(n)),e=i.mo.applicationId,r=i.selectedInstance.name;return m(e,r,t).then(function(n){return d(n,t,n.dateTo)})},beginningBtnClick:function(){u(!0);var n=i.mo.applicationId,t=i.selectedInstance.name;return m(n,t,"1970-01-01T00:00:00+00:00").then(function(n){return d(n,n.dateFrom,n.dateTo)})},isRequestPending:void 0})}n.$inject=["$routeParams","gettext","c8yApplication","c8yApplicationLogs","c8yAlert"],angular.module("c8y.appLogs").component("c8yAppLogs",{bindings:{basePath:"@"},templateUrl:":::PLUGIN_PATH:::/app-logs/app-logs.html",controller:n,controllerAs:"vm"})}();