"use strict";!function(){function e(a,i,n,t,r){var s,e,l=this,c=60,v={c8yMax:{required_availability:r("Required interval must be a number and cannot be longer than 32767 minutes.")},c8yMin:{required_availability:r("Required interval must be a positive number.")}};function o(){!function(e){if(e.c8y_RequiredAvailability=e.c8y_RequiredAvailability||{},e.c8y_RequiredAvailability&&e.c8y_RequiredAvailability.responseInterval<0)return;var i=Math.round(l.responseInterval);if(e.c8y_RequiredAvailability.responseInterval=i,e.c8y_Tracking&&e.c8y_Tracking.interval){var n;if(e.c8y_Tracking.interval!==i*c)n=e.c8y_Tracking.interval>i*c?r("Changing this value can cause showing false offline statuses and prevent alarms from being created as early as possible"):r("Changing this value can cause showing false online statuses and prevent alarms from being created as early as possible"),a.add({text:n,type:"warning"})}d(e.c8y_RequiredAvailability)}(l.device);var e=_.pick(l.device,["id","c8y_RequiredAvailability"]);return l.saveInProgress=!0,i.save(e).then(function(){l.saveInProgress=!1,u()}).then(function(){a.success(r("Required interval updated."))})}function d(e){var i=e&&0!==e.responseInterval;_.set(l,"responseInterval",i?Math.abs(Number(e.responseInterval)):void 0)}function u(){l.isEditMode?l.isEditMode=!1:(e=l.responseInterval,l.isEditMode=!0)}function y(){l.responseInterval=e,l.isEditMode=!1}_.assign(l,{isEditMode:!1,saveInProgress:!1,maxRequiredIntervalLimit:32767,save:o,switchMaintenance:function(e){i.switchResponseInterval(e)},$doCheck:function(){!function(){var e=_.get(l.device,"c8y_RequiredAvailability");_.isEqual(e,s)||(function(e){d(e)}(e),s=e)}()},toggleEdit:u,resetEdit:y,validationHints:function(e){return n.validationHints(e,v)},keyHandler:function(e){return t.handle(e,o,y)},invalid:angular.bind(n,n.invalid,l,"availabilityForm")})}e.$inject=["c8yAlert","c8yDevices","c8yBase","keyboardKeyHandler","gettext"],angular.module("c8y.deviceStatus").component("requiredAvailabilityIntervalSetting",{controller:e,controllerAs:"vm",templateUrl:":::PLUGIN_PATH:::/requiredAvailabilityIntervalSetting.html",bindings:{device:"<",status:"<"}})}();