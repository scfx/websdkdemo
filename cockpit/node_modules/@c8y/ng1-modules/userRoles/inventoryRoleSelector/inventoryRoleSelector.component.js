"use strict";!function(){function e(t,e,o){var i=this,r=[],n=[];function l(){r=_.clone((i.assignedRoles||{}).roles)||[]}function s(e){return _(e).sortBy(y).map(y).value().join(", ")}function c(e){return _.some(r,{id:e.id})||u(e)}function u(e){return _.some(n,{id:e.id})}function d(){return e("filter")(i.inventoryRoles,i.roleTextFilter)}function a(){var e=d().filter(function(e){return f(e)});return _.every(e,c)}function g(){return r.filter(function(e){return f(e)})}function f(e){return!i.ownerAllowedRoles||_.some(i.ownerAllowedRoles,{id:e.id})}function m(){var e=_.sortBy(_.map((i.assignedRoles||{}).roles,"id")),n=_.sortBy(_.map(r,"id"));i.isUnchanged=_.isEqual(e,n)}function y(e){return o.getString(e.name)}_.assign(i,{displayTextAssigned:function(){return s((i.assignedRoles||{}).roles)},displayTextInherited:function(){return s(n)},$onChanges:function(e){e.assignedRoles&&l();e.inheritedRoles&&(n=i.inheritedRoles)},toggle:function(e){c(e)?_.remove(r,{id:e.id}):(r.push(e),r=_.uniqBy(r,"id"));m()},toggleSelectAll:function(){a()?r.length=0:r=_.reject(d(),u);m()},allSelected:a,isSelected:c,isInherited:u,filteredAssignedRoles:g,apply:function(){var e=g();i.onApply({roles:e}),i.isDropDownOpen=!1},onToggleDropdown:function(e){e||(l(),i.isUnchanged=!0)},isAllowedByOwner:f,isUnchanged:!0,getFormattedInventoryRoleDescription:_.memoize(function(e){var n=o.getString(e.trim());return t.trustAsHtml("\n        <div>\n          ".concat(n,"\n        </div>\n      "))}),translateName:y})}e.$inject=["$sce","$filter","gettextCatalog"],angular.module("c8y.userRoles").component("c8yInventoryRoleSelector",{bindings:{assignedRoles:"<",inheritedRoles:"<",inventoryRoles:"<",ownerAllowedRoles:"<",onApply:"&"},templateUrl:":::PLUGIN_PATH:::/inventoryRoleSelector/inventoryRoleSelector.html",controller:e,controllerAs:"vm"})}();