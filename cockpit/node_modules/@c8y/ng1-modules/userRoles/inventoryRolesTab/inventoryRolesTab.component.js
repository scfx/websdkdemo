"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&t.push.apply(t,Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),t.forEach(function(e){_defineProperty(n,e,o[e])})}return n}function _defineProperty(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}!function(){function e(e,n,o,s,r,t,l,i){var a=this;function c(){n.listInventoryRoles(a.user).then(o.getResData).then(function(e){a.assignedRoles=_.keyBy(e.inventoryAssignments,"managedObject")}),n.detail(a.user).then(o.getResData).then(function(e){e.owner?n.listInventoryRoles(e.owner).then(o.getResData).then(function(e){a.ownerAssignedRoles=_.keyBy(e.inventoryAssignments,"managedObject"),_.isEmpty(a.ownerAssignedRoles)&&(a.displayNoOwnerRolesAlert=!0),a.failedToFetchOwnerInventoryRoles=!1}).catch(function(){a.failedToFetchOwnerInventoryRoles=!0}):a.failedToFetchOwnerInventoryRoles=!1})}function u(){c(),l.success(i.getPlural(y(),"Inventory role updated","Inventory roles updated",{}))}function y(){return _.filter(a.assignedRoles,"isModified").length}function d(e){var n="replace"===e.process,o=e.roles,t=_.map(a.assignedRoles);return s.copyUserRoles(o,t,a.user,n).then(c).then(r.successUserRolesCopy)}_.assign(a,{$onChange:function(e){e.user&&c()},onChangeRoles:function(e,n){a.assignedRoles[n]=a.assignedRoles[n]||{},_.assign(a.assignedRoles[n],{managedObject:n,roles:e,isModified:!0}),a.assignedRoles=_objectSpread({},a.assignedRoles)},onSaveInventoryRoles:function(){s.onSaveInventoryRoles(a.user,a.assignedRoles).then(u)},copyRoles:function(){r.copyFromUserDialog(a.user).then(d)},loadAssignedRoles:c,isUnchanged:function(){return 0===y()},helpLink:t.getUserGuideLink(_.get(r.STRINGS,"LINKS.ROLES_INVENTORY")),displayNoOwnerRolesAlert:!1,failedToFetchOwnerInventoryRoles:null}),c()}e.$inject=["$q","c8yUser","c8yBase","c8yUserInventoryRoles","c8yUserRolesUi","c8yDocs","c8yAlert","gettextCatalog"],angular.module("c8y.userRoles").component("c8yUserInventoryRolesTab",{templateUrl:":::PLUGIN_PATH:::/inventoryRolesTab/inventoryRolesTab.html",controllerAs:"vm",controller:e,bindings:{user:"<"}})}();