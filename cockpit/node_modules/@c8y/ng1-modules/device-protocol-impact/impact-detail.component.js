"use strict";!function(){function e(c,i){var r=this;function u(e){r.object=e,r.title=c.getName(e),o(),t()}function n(e){r.customActions=e}function t(){delete r.newResource}function e(){r.editingMain=!r.editingMain}function o(){r.objectMain=_.pick(_.clone(i.getMainProperties(r.object)),["id","name","description"]),r.mainPropertiesForm.$setPristine(),r.editingMain=!1}function s(){return i.getResources(r.object)}_.assign(r,{$onChanges:function(e){e.id&&(c.detail(r.id).then(u),c.getCustomActions().then(n))},addResource:function(){r.newResource={multiple:!1}},noResources:function(){return!r.newResource&&0===i.countResources(r.object)},cancelNewResourceMapping:t,saveResourceAndMapping:function(e,n,t){var o=_.cloneDeep(r.object);if(o=i.updateResource(e,t,o),o=i.updateMappingToResource(n,e,o),function(n,e){var t=s(r.object);return!i.isSameResource(n,e)&&_.find(t,function(e){return e.id===n.id})}(e,t))return c.overwriteResourceConfirm(e).then(function(){return c.save(o)}).then(u);return c.save(o).then(u)},removeResource:function(e){var n=_.cloneDeep(r.object);return c.removeResourceConfirm(e).then(function(e){return i.removeResource(e,n)}).then(i.saveToInventory).then(u).then(c.alertRemoveResourceSuccess)},toggleMainEdit:e,saveMainProperties:function(){var e=_.cloneDeep(r.object);return e=i.updateMainProperties(r.objectMain,e),i.saveToInventory(e).then(u).then(c.alertUpdateProtocolSuccess)},cancelMainProperties:function(){e(),o()},getResources:s,getMappingForResource:function(e){return _.get(i.getMappings(r.object),e)},getMainObject:function(){return i.getMainObject(r.object)}})}e.$inject=["c8yImpact","c8yObjectMappings"],angular.module("c8y.impact").component("c8yImpactDetail",{bindings:{id:"<"},templateUrl:":::PLUGIN_PATH:::/impact-detail.html",controller:e,controllerAs:"vm"})}();