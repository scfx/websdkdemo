"use strict";!function(){e.$inject=["c8yDeviceProtocolUiProvider","c8yViewsProvider","gettext"];var o="c8yImpact";function e(e,t,f){n.$inject=["c8yTenant","c8yBase","c8yInventory","c8yObjectMappings","c8yModal","c8yAlert","gettextCatalog","$q","$http"],c.$inject=["$routeParams"];var r={service:o,id:"impact",name:f("IMPACT")},h={path:"/deviceprotocols/".concat(r.id,"/:id"),template:'<c8y-impact-detail id="vm.id"></c8y-impact-detail>',controllerAs:"vm",controller:c};return{initUi:function(){e.register(r),t.when(h.path,h)},$get:n};function c(e){_.assign(this,e)}function n(e,c,r,n,o,t,a,i,u){var s,d=c.url("service/impact/"),l="".concat(d,"objectResourceMappings"),p="".concat(l,"/json"),g=[f("BOOLEAN"),f("STRING"),f("INTEGER"),f("FLOAT")];return{showIf:function e(){e.cached||(e.cached=v());return e.cached},isServiceSubscribed:v,flow:_.constant(["c8yImpactCreateStep"]),detail:function(e){var t=c.getId(e);return r.detail(t).then(c.getResData)},detailPath:function(e){var t=c.getId(e);return h.path.replace(/:id$/,t)},create:function(e){var t=n.createManagedObject(e);return t.type="impact_object_mapping",u.post(p,t).then(c.getResData)},save:function(e){var t=n.fragments.BASE_FRAGMENT,r=_.pick(e,["id",t]);if(!_.get(r,t))throw new Error("c8yImpact.save: ".concat(t," is not defined"));if(_.get(r,"id"))return u.post(p,r).then(c.getResData);throw new Error("c8yImpact.save: Id is not defined")},remove:r.remove,removeResourceConfirm:function(t){var e={title:f("Delete resource"),body:a.getString('You are about to delete the resource with the ID "{{id}}". Do you want to proceed?',t),status:"danger",labels:{ok:f("Delete"),cancel:f("Cancel")}};return o(e).then(function(e){return e?t:i.reject()})},overwriteResourceConfirm:function(t){var e={title:f("Overwrite resource"),body:a.getString('You are about to overwrite the resource with the ID "{{id}}". Do you want to proceed?',t),status:"warning",labels:{ok:f("Overwrite"),cancel:f("Cancel")}};return o(e).then(function(e){return e?t:i.reject()})},list:function(){return u.get(l,{silentError:!0}).then(c.getResData)},getName:n.getName,DATA_TYPES:g,alertRemoveResourceSuccess:function(){var e=f("Resource deleted.");t.success(e)},alertUpdateProtocolSuccess:function(){var e=f("Device protocol updated");t.success(e)},listRowInfoComponent:"c8yDeviceProtocolRowCountResources",getCustomActions:function(){s||(s=u.get("".concat(d,"mappingActions/resourceactions")).then(c.getResData).then(m));return s}};function v(){return e.isSubscribed({name:"impact",type:"MICROSERVICE"})}function m(e){return _.reduce(e,function(e,t){var r=t.name,c=t.args,n=_.get(c,"length")?c.map(function(e){return"".concat(r,":").concat(e)}):[r];return e.concat(n)},[])}}}angular.module("c8y.impact").provider(o,e)}();