"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(){e.$inject=["c8yBase","c8yUser","c8yInventory","c8yExportApis","c8yExportFilters","gettext","gettextCatalog","c8yReportsService"],angular.module("c8y.cockpit.export").service("exportConfig",e);var m="c8y_ExportConfiguration",f={name:"",exportType:"csv",queryParameters:{},apiList:[]};function e(t,e,r,n,a,o,i,s){var u=[{name:"source",label:o("Object to export"),template:":::PLUGIN_PATH:::/views/filters/source.html",def:[a.SourceFilter,"source"]},{name:"dateType",label:o("Time range"),template:":::PLUGIN_PATH:::/views/filters/dateRange.html",def:[a.DateRangeFilter,"dateType"]}],c=[{name:"Alarms",icon:"bell",label:o("Alarms"),def:[n.Api,"Alarms"]},{name:"Events",icon:"c8y-events",label:o("Events"),def:[n.Api,"Events"]},{name:"ManagedObjects",icon:"cubes",label:o("Managed objects"),def:[n.Api,"ManagedObjects"]},{name:"Measurements",icon:"line-chart",label:o("Measurements"),def:[n.MeasurementsApi],template:":::PLUGIN_PATH:::/views/apis/measurements.html"}];function l(e){for(var t=arguments.length,o=new Array(1<t?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];return _.map(e,function(e){var t,r=e.def,n=_.tail(r),a=new((t=_).bind.apply(t,_toConsumableArray([r[0],r[0]].concat(n).concat(o))));return _.assign(a,_.omit(e,"def","name")),a})}this.getFilters=function(e,t){return l(u,e,t)},this.getApis=function(e){return l(c,e)},this.getFileTypes=function(){return[{name:"CSV",type:"csv"},{name:"Excel (.xlsx)",type:"vnd.ms-excel"}]},this.list=function(){return r.list({fragmentType:m})},this.create=function(e){return _.merge(_.cloneDeep(f),e)},this.detail=function(e){return r.detail(e).then(t.getResData)},this.save=function(e){return e.id?r.save(e).then(function(){return e}):(e[m]={},r.createConfirm(e).then(t.getResData))},this.remove=function(e){return s.removeConfiguration(e)},this.getSmartRuleDefaults=function(t){return e.current().then(function(e){return{name:i.getString('Send "{{name}}" via email',t),c8y_Context:{context:"exportConfiguration",id:t.id},config:{exportConfiguration:_.pick(t,["id","name"]),exportConfigurationId:t.id,to:e.email,subject:i.getString('Export of "{{name}}"',t)}}})}}}();