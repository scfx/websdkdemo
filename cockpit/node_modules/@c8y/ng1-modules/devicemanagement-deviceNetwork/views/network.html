<div ng-controller="deviceNetworkCtrl" class="deviceNetwork row">
  <div class="col-lg-12 col-lg-max">
    <form name="wanForm">
      <div class="card m-b-4">
        <div class="card-header separator">
          <h4 class="card-title">{{ 'WAN' | translate }}</h4>
        </div>

        <div class="card-block p-b-0">
          <div class="row">
            <div class="col-xs-12 col-md-4">
              <div class="form-group">
                <label>{{ 'SIM status' | translate }}</label>
                <p class="form-control-static">
                  {{ device.c8y_Network.c8y_WAN.simStatus }}
                </p>
              </div>
            </div>
            <div class="col-xs-12 col-md-4">
              <div class="form-group">
                <label for="apn">{{ 'APN' | translate }}</label>
                <input
                  id="apn"
                  type="text"
                  class="form-control"
                  ng-model="device.c8y_Network.c8y_WAN.apn"
                />
              </div>
              <div class="form-group">
                <label for="authType">{{ 'Auth type' | translate }}</label>
                <div class="c8y-select-wrapper">
                  <select
                    id="authType"
                    class="form-control"
                    ng-model="device.c8y_Network.c8y_WAN.authType"
                    ng-options="authType.value as (authType.label | translate) for authType in authTypes"
                  ></select>
                  <span></span>
                </div>
              </div>
            </div>
            <div class="col-xs-12 col-md-4">
              <div class="form-group">
                <label for="user">{{ 'User' | translate }}</label>
                <input
                  id="user"
                  type="text"
                  class="form-control"
                  ng-model="device.c8y_Network.c8y_WAN.username"
                />
              </div>
              <div class="form-group">
                <label for="password">{{ 'Password' | translate }}</label>
                <input
                  id="password"
                  type="text"
                  class="form-control"
                  ng-model="device.c8y_Network.c8y_WAN.password"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="card-footer separator">
          <button
            title="{{ 'Save' | translate }}"
            class="btn btn-primary"
            ng-disabled="wanForm.$invalid || wanForm.$pristine"
            ng-click="saveWANviaIP(device)"
          >
            {{ 'Save' | translate }}
          </button>
          <button
            title="{{ 'Save (SMS)' | translate }}"
            class="btn btn-primary"
            ng-disabled="wanForm.$invalid || !smsEnabled || wanForm.$pristine"
            ng-click="saveWANviaSMS(device)"
          >
            {{ 'Save (SMS)' | translate }}
            <i
              ng-if="!smsEnabled"
              c8y-icon="question-circle"
              uib-tooltip="{{
                'Messaging provider must be configured to send WAN settings to device via SMS.'
                  | translate
              }}"
            >
            </i>
          </button>
        </div>
      </div>
    </form>
  </div>

  <div class="col-lg-12 col-lg-max">
    <form name="lanDhcpForm" ng-submit="saveLANandDHCP(device)">
      <div class="card m-b-0">
        <div class="card-header separator">
          <h4 class="card-title">{{ 'LAN' | translate }}</h4>
        </div>

        <div class="card-block">
          <div class="row">
            <div class="col-xs-12 col-md-4">
              <div class="form-group">
                <label>{{ 'Name' | translate }}</label>
                <p class="form-control-static">
                  {{ device.c8y_Network.c8y_LAN.name }}
                </p>
              </div>

              <div class="form-group">
                <label>{{ 'MAC address' | translate }}</label>
                <p class="form-control-static">
                  {{ device.c8y_Network.c8y_LAN.mac | uppercase }}
                </p>
              </div>
            </div>

            <div class="col-xs-12 col-md-4">
              <div class="form-group" ng-class="{'has-error': invalid('lanDhcpForm', 'ip')}">
                <label for="ip">{{ 'IP Address' | translate }}</label>
                <input
                  id="ip"
                  name="ip"
                  type="text"
                  validate-ip
                  class="form-control"
                  ng-model="device.c8y_Network.c8y_LAN.ip"
                  ng-change="onLanIpChanged(device.c8y_Network.c8y_LAN)"
                  placeholder="{{ 'e.g.' | translate }} 192.168.0.1"
                  maxlength="15"
                  required
                />
                <c8y-messages>
                  <c8y-message
                    class="form-control-feedback-message"
                    ng-if="invalid('lanDhcpForm', 'ip')"
                  >
                    {{ 'Invalid IP address.' | translate }}
                  </c8y-message>
                </c8y-messages>
              </div>

              <div class="form-group" ng-class="{'has-error': invalid('lanDhcpForm', 'netmask')}">
                <label for="netmaskLan">{{ 'Subnet mask' | translate }}</label>
                <input
                  id="netmaskLan"
                  name="netmask"
                  type="text"
                  validate-ip
                  class="form-control"
                  ng-model="device.c8y_Network.c8y_LAN.netmask"
                  placeholder="{{ 'e.g.' | translate }} 255.255.255.0"
                  maxlength="15"
                  required
                />
                <c8y-messages>
                  <c8y-message
                    class="form-control-feedback-message"
                    ng-if="invalid('lanDhcpForm', 'netmask')"
                  >
                    {{ 'Invalid subnet mask.' | translate }}
                  </c8y-message>
                </c8y-messages>
              </div>
            </div>

            <div class="col-xs-12 col-md-2">
              <div class="form-group"></div>
              <button
                class="btn"
                type="button"
                ng-model="device.c8y_Network.c8y_LAN.enabled"
                uib-btn-checkbox
              >
                <i
                  c8y-icon="minus-circle"
                  class="text-danger"
                  ng-show="!device.c8y_Network.c8y_LAN.enabled"
                ></i>
                <i
                  c8y-icon="check-circle"
                  class="text-success"
                  ng-show="device.c8y_Network.c8y_LAN.enabled"
                ></i>
                <span
                  title="{{ 'Enabled' | translate }}"
                  ng-show="device.c8y_Network.c8y_LAN.enabled"
                >
                  {{ 'Enabled' | translate }}
                </span>
                <span
                  title="{{ 'Disabled' | translate }}"
                  ng-show="!device.c8y_Network.c8y_LAN.enabled"
                >
                  {{ 'Disabled' | translate }}
                </span>
              </button>
            </div>
          </div>
          <div class="row" ng-model="device.c8y_Network.c8y_DHCP.enabled">
            <label class="c8y-checkbox input-sm p-l-16 col-md-3">
              <input
                type="checkbox"
                ng-model="device.c8y_Network.c8y_DHCP.enabled"
                ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
              />
              <span> </span>
              <span>
                {{ 'Enable DHCP' | translate }}
              </span>
            </label>
          </div>
        </div>

        <div class="collapse" uib-collapse="!device.c8y_Network.c8y_DHCP.enabled">
          <div ng-show="device.c8y_Network.c8y_LAN.enabled" class="card-block bg-gray-white">
            <fieldset
              name="lanDhcpForm"
              class="c8y-fieldset"
              ng-model="device.c8y_Network.c8y_LAN.enabled"
            >
              <legend class="m-b-8">{{ 'DHCP' | translate }}</legend>
              <div class="row">
                <div class="col-xs-12 col-md-4">
                  <div class="form-group form-group-sm">
                    <label for="addressRangeStart">{{ 'Address range' | translate }}</label>
                    <div class="row tight-grid">
                      <div class="form-group">
                        <div
                          class="col-sm-6"
                          ng-class="{'has-error': invalid('lanDhcpForm', 'addressRangeStart')}"
                        >
                          <input
                            id="addressRangeStart"
                            name="addressRangeStart"
                            type="text"
                            validate-ip
                            class="form-control"
                            ng-model="device.c8y_Network.c8y_DHCP.addressRange.start"
                            ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
                            placeholder="{{ 'e.g.' | translate }} 192.168.0.1"
                            maxlength="15"
                            ng-required="device.c8y_Network.c8y_DHCP.enabled"
                          />
                          <c8y-messages>
                            <c8y-message
                              class="form-control-feedback-message"
                              ng-if="invalid('lanDhcpForm', 'addressRangeStart')"
                            >
                              {{ 'Invalid IP address range start.' | translate }}
                            </c8y-message>
                          </c8y-messages>
                        </div>

                        <div
                          class="col-sm-6"
                          ng-class="{'has-error': invalid('lanDhcpForm', 'addressRangeEnd')}"
                        >
                          <input
                            id="addressRangeEnd"
                            name="addressRangeEnd"
                            type="text"
                            validate-ip
                            class="form-control"
                            ng-model="device.c8y_Network.c8y_DHCP.addressRange.end"
                            ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
                            placeholder="{{ 'e.g.' | translate }} 192.168.0.10"
                            maxlength="15"
                            ng-required="device.c8y_Network.c8y_DHCP.enabled"
                          />
                          <c8y-messages>
                            <c8y-message
                              class="form-control-feedback-message"
                              ng-if="invalid('lanDhcpForm', 'addressRangeEnd')"
                            >
                              {{ 'Invalid IP address range end.' | translate }}
                            </c8y-message>
                          </c8y-messages>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group form-group-sm">
                    <label for="domainName">{{ 'Domain name' | translate }}</label>
                    <input
                      id="domainName"
                      type="text"
                      class="form-control"
                      ng-model="device.c8y_Network.c8y_DHCP.domainName"
                      ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
                    />
                  </div>
                </div>
                <div class="col-xs-12 col-md-4">
                  <div
                    class="form-group form-group-sm"
                    ng-class="{'has-error': invalid('lanDhcpForm', 'dns1')}"
                  >
                    <label for="dns1">{{ 'DNS' | translate }}</label>
                    <input
                      id="dns1"
                      name="dns1"
                      type="text"
                      validate-ip
                      class="form-control"
                      ng-model="device.c8y_Network.c8y_DHCP.dns1"
                      ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
                      placeholder="{{ 'e.g.' | translate }} 192.168.0.1"
                      maxlength="15"
                    />
                    <c8y-messages>
                      <c8y-message
                        class="form-control-feedback-message"
                        ng-if="invalid('lanDhcpForm', 'dns1')"
                      >
                        {{ 'Invalid IP address.' | translate }}
                      </c8y-message>
                    </c8y-messages>
                  </div>

                  <div
                    class="form-group form-group-sm"
                    ng-class="{'has-error': invalid('lanDhcpForm', 'dns2')}"
                  >
                    <label for="dns2">{{ 'DNS 2' | translate }}</label>
                    <input
                      id="dns2"
                      name="dns2"
                      type="text"
                      validate-ip
                      class="form-control"
                      ng-model="device.c8y_Network.c8y_DHCP.dns2"
                      ng-disabled="!device.c8y_Network.c8y_LAN.enabled"
                      placeholder="{{ 'e.g.' | translate }} 192.168.0.2"
                      maxlength="15"
                    />

                    <c8y-messages>
                      <c8y-message
                        class="form-control-feedback-message"
                        ng-if="invalid('lanDhcpForm', 'dns2')"
                      >
                        {{ 'Invalid IP address.' | translate }}
                      </c8y-message>
                    </c8y-messages>
                  </div>
                </div>
              </div>
            </fieldset>
          </div>
        </div>

        <div class="card-footer separator">
          <button
            title="{{ 'Save' | translate }}"
            class="btn btn-primary"
            ng-disabled="lanDhcpForm.$invalid || lanDhcpForm.$pristine"
          >
            {{ 'Save' | translate }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
