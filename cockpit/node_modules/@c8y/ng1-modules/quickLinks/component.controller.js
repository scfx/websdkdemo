"use strict";!function(){function n(n,u,s,p,i,e,o,d,g){var f,c=[],r=[],h=(["col-lg-4","col-md-3","col-sm-4","col-xs-6"].join(" "),["col-lg-3","col-md-3","col-sm-4","col-xs-6"].join(" "),["col-lg-2","col-md-2","col-sm-4","col-xs-6"].join(" "),_.merge({},window.C8Y_APP&&window.C8Y_APP.C8Y_INSTANCE_OPTIONS,window.C8Y_INSTANCE_OPTIONS).target);function t(n){f=n.name}function l(){return i.listByUser().then(a)}function a(n){r=_(n).map(function(n){return n.contextPath}).uniq().value()}function y(){return p.getCount()}function E(n){n=parseInt(n);var i=[],e=function(i){return g.hasAnyRole(["ROLE_USER_MANAGEMENT_CREATE","ROLE_USER_MANAGEMENT_ADMIN"]).then(function(n){return n&&v("administration")}).then(function(n){return n?_.assign({priority:2,icon:"c8y-icon c8y-icon-add-user",label:d("Add user"),url:"/apps/administration/index.html#/users/new",color:"#FEFEFE",backgroundColorClass:"a"},i):null})}(),o=function(n){if(v("devicemanagement"))return _.assign({priority:2,icon:"c8y-icon c8y-icon-device-connect",label:d("Add device"),url:"",click:k,color:"#FEFEFE",backgroundColorClass:"b"},n)}(),c=function(n){if(v("devicemanagement"))return _.assign({priority:2,icon:"c8y-icon c8y-icon-group-add",label:d("Add group"),url:"",click:C,color:"#FEFEFE",backgroundColorClass:({dt:{backgroundColorClass:"d"}}[h]||{}).backgroundColorClass||"e"},n)}(),r=function(n){if(v("devicemanagement")){return _.assign({priority:({dt:{priority:2}}[h]||{}).priority||3,icon:"c8y-icon c8y-icon-device-management",label:d("Device management"),url:"/apps/devicemanagement",color:"#EFEFEF",backgroundColorClass:"f"},n)}}(),t=function(n){if(v("cockpit")){return _.assign({priority:({dt:{priority:2}}[h]||{}).priority||3,icon:"c8y-icon c8y-icon-cockpit",label:d("Cockpit"),url:"/apps/cockpit",color:"#EFEFEF",backgroundColorClass:"e"},n)}}(),l=function(n){if("dt"===h&&v("HelpAndService")){return _.assign({priority:2,iconSrc:":::PLUGIN_PATH:::/icons/HelpAndService.svg",label:d("Help & Service"),url:"/apps/HelpAndService",color:"#EFEFEF",backgroundColorClass:"f"},n)}}();if(0===n)o.priority=1;else if(n<=5){var a=1===n?1:3;i.push(p.list({pageSize:n}).then(function(n){var i=[];return _.forEach(n,function(n){i.push(function(n,i){if(v("cockpit"))return _.assign({priority:({dt:{priority:2}}[h]||{}).priority||3,icon:"c8y-icon c8y-icon-device",label:n.name||d("Device ")+n.id,url:"/apps/cockpit/index.html#/device/".concat(n.id),color:"#FEFEFE",backgroundColorClass:"c"},i)}(n,{priority:a}))}),i}))}else t.priority=1;return i.push(function(){var n=s.getPluginService("phoneRegistrationService");if(n)return n.createAddPhoneLink()}()),i.push(u.when(e)),i.push(u.when(o)),i.push(u.when(c)),"devicemanagement"!==f&&i.push(u.when(r)),"cockpit"!==f&&i.push(u.when(t)),l&&"HelpAndService"!==f&&i.push(u.when(l)),u.all(i).then(_.flattenDeep).then(_.partialRight(_.filter,function(n){return n}))}function m(n){c.length=0,_.forEach(n,function(n){c.push(n)})}function C(){o.addAssetUI()}function k(){e({templateUrl:":::PLUGIN_PATH:::/views/deviceRegistration.html",controller:"deviceRegistrationCtrl"})}function v(n){return _.includes(r,n)}n.links=c,n.getLinkClass=function(n){return["quick-link","quick-link-".concat(n.priority),"quick-link-bgcolor-".concat(n.backgroundColorClass)]},i.getCurrent().then(t).then(l).then(y).then(E).then(m)}n.$inject=["$scope","$q","c8yBase","c8yDevices","c8yApplication","c8yModal","groupsHierarchySvc","gettext","c8yPermissions"],angular.module("c8y.welcome.quickLinks").controller("QuickLinksController",n)}();