"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _slicedToArray(r,t){return _arrayWithHoles(r)||_iterableToArrayLimit(r,t)||_unsupportedIterableToArray(r,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){if(r){if("string"==typeof r)return _arrayLikeToArray(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var n,a,o=[],i=!0,u=!1;try{for(e=e.call(r);!(i=(n=e.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(r){u=!0,a=r}finally{try{i||null==e.return||e.return()}finally{if(u)throw a}}return o}}function _arrayWithHoles(r){if(Array.isArray(r))return r}!function(){function r(r,t,e,n,a,o,l){p.$inject=["$routeParams","$injector"];var y,s,d,f,i="/group",u="".concat(i,"/:groupId"),c="/group/:groupId",h={};return{init:function(){n.addTitle(u,{data:["$routeParams","c8yBase","c8yInventory",function(r,t,e){var n=r.groupId;return n?e.detailCached(n,{withChildren:!1}).then(t.getResData).then(function(r){return{title:r.name}}):{}}]}),e.addBreadcrumbs(u,{data:p}),e.addBreadcrumbs(c,{data:p}),o.add({name:l("Search all"),path:function(r){return r&&"/assetsearch?s=".concat(window.encodeURIComponent(r))}})},$get:function(){}};function p(r,t){var e=y=t.get("$q"),n=s=t.get("c8yBase"),a=d=t.get("c8yInventory");f=t.get("c8yGroups");var o,i=e.when([]),u=r.groupId;e.when(null);return u&&(o=a.detail(u,{withParents:!0}).then(n.getResData).then(function(r){return function i(u,c,r){if(!r)return y.when(u);c.unshift((t=r,{icon:f.getIconSpecs(t).iconOpen,groupType:t.type,label:t.name||"".concat(l("Group")," ").concat(t.id),path:"#/group/".concat(t.id)}));var t;return y.all([d.directParentDevices(r),d.directParentAssets(r)]).then(function(r){var t=_slicedToArray(r,2),e=t[0],n=t[1],a=[].concat(_toConsumableArray(e),_toConsumableArray(n)).filter(function(r){var e=r.id;return!c.some(function(r){var t=r.path;return t.includes(e)})}),o=[];return 0===a.length?(u.push(c),y.when(u)):(_.forEach(a,function(r){var t=d.detail(r.id,{withParents:!0}).then(s.getResData).then(function(r){return y.when(i(u,_.cloneDeep(c),r))});o.push(t)}),y.all(o).then(function(){return u}))})}([],[],r)}).then(function(r){var t=r;return _.forEach(t,function(r){r.unshift({label:l("Groups"),icon:"c8y-group-open",path:"#/group",translate:!0})}),t=function(r){return _.sortBy(r,function(r){return-1*r.length})}(t=function(r){return _.forEach(r,function(r){return r.pop()})}(t)),h[u]=t}),i=e.when(_.get(h,u,o))),i}}r.$inject=["$routeProvider","c8yViewsProvider","c8yBreadcrumbsProvider","c8yTitleProvider","c8yActionsProvider","c8ySearchProvider","gettext"],angular.module("c8y.groupsHierarchy").provider("c8yGroupsHierarchyUi",r)}();