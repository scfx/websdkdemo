"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&o.push.apply(o,Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),o.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(){function e(s){m.$inject=["$q","c8yPermissions","gettextCatalog","c8yInventory","c8yBinary"];var c="brandingVariables",e={title:s("General"),items:["html_title"]},t={title:s("Main logo"),items:["favicon","brand-logo-img","brand-logo-height"]},r={title:s("Navigator logo"),items:["appLogo","appLogo-height"]},o={title:s("Font"),key:"font.options",items:["font-family-sans-serif","headings-font-family","navigator-font-family","__import-font"]},a={title:s("Colors"),items:["brand-primary","brand-complementary","brand-dark","brand-light","gray-text","link-color","body-background-color"]},i={title:s("Top bar"),items:["headerColor","header-text-color","header-hover-color"]},n={title:s("Navigator"),items:["navColor","navColorHeader","navigator-title-color","navigator-text-color","navigator-separator-color","navigator-active-color","navigator-active-bg"]},l={title:s("Misc"),items:["btn-border-radius-base"]},g={title:s("Cookie banner"),items:["cookieBannerDisabled","cookieBannerTitle","cookieBannerText","policyUrl"]},d=[e,t,r,o,a],p=[i,n,l,g];return{$get:m};function m(i,e,r,a,n){var l=["brand-logo-img","appLogo","favicon"];return{getSchema:o,getForm:function(){return i.when([_.map(d,t),_.map(p,t)])},getSchemaFormOptions:function(){return e.hasAnyRole(["ROLE_OPTION_MANAGEMENT_ADMIN"]).then(function(e){return{formDefaults:{readonly:!e}}})},getBranding:function(){var e=o(),t=a.list({type:c});return i.all({schema:e,managedObjects:t}).then(function(e){var r=_.pick(e.managedObjects[0],["id","c8y_less_variables","binary_ref","cookieBanner"]),o=[];return _.each(l,function(t){if(r.binary_ref&&r.binary_ref[t]){var e=a.detail(r.binary_ref[t],{},{silentError:!0}).then(function(e){r.c8y_less_variables[t]=e.data},function(){});o.push(e)}}),i.all(o).then(_.constant(r))})},saveConfiguration:function(e,t){var r={type:c,c8y_less_variables:e.c8y_less_variables,binary_ref:e.binary_ref||{}};t&&(r.id=t);return a.save(r)},saveBinary:function(t,e,r,o){if(_.isEqual(e,o))return i.when(o);var a={c8y_Branding:t,fileSrc:e.fileSrc};return n.upload(e,a).then(function(e){return r&&r[t]&&o&&n.removeBinary(r[t]),e.data})},BINARY_VARS:l};function o(){var e=s("Hex, rgb or rgba value. Default: {{defaultColor}}"),t={message:{cssColor:r.getString("Must be a valid CSS color value.")},validator:{cssColor:function(e){if(_.isEmpty(e))return!0;var t=document.createElement("SPAN");return t.style.color=e,!_.isEmpty(t.style.color)}}};return i.when({type:"object",properties:{html_title:{title:r.getString("Title"),type:"string",description:r.getString("Title to be used in browser tab")},"brand-logo-img":{title:"".concat(r.getString("Brand logo")),type:"string",description:r.getString("Supported files: *.png, *.svg"),format:"file",required:!0,"x-schema-form":{type:"fileUpload",allowedFileType:["image"]}},favicon:{title:"".concat(r.getString("Favicon")),type:"string",description:r.getString("Supported files: *.ico"),format:"file",required:!0,"x-schema-form":{type:"fileUpload",allowedFileType:["image"]}},"brand-logo-height":{title:r.getString("Brand logo height"),type:"number",minimum:0,description:r.getString("Height for setting the right proportion for the logo: height / width x 100")},appLogo:{title:r.getString("Navigator logo"),type:"string",description:r.getString("Supported files: *.png, *.svg"),format:"file","x-schema-form":{type:"fileUpload",allowedFileType:["image"]}},"appLogo-height":{title:r.getString("Navigator logo height"),type:"number",minimum:0,description:r.getString("Height for setting the right proportion for the navigator logo: height / width x 100")},"font-family-sans-serif":{title:r.getString("Base font stack"),type:"string","x-schema-form":{placeholder:r.getString('e.g. "Lato", Arial, Verdana, sans-serif')}},"headings-font-family":{title:r.getString("Headings font stack"),type:"string","x-schema-form":{placeholder:r.getString('e.g. "Lato", Arial, Verdana, sans-serif')}},"navigator-font-family":{title:r.getString("Navigator font stack"),type:"string",default:"@font-family-sans-serif","x-schema-form":{type:"radios",enum:["@font-family-sans-serif","@headings-font-family"],titleMap:[{value:"@font-family-sans-serif",name:r.getString("Same as base font")},{value:"@headings-font-family",name:r.getString("Same as headings font")}]}},"__import-font":{title:r.getString("URL"),description:r.getString("A link to existing remote fonts (e.g. Google Fonts)"),type:"string"},"brand-primary":{title:"".concat(r.getString("Main brand color")),type:"string",description:r.getString("Hex, rgb or rgba value."),required:!0,"x-schema-form":{placeholder:r.getString("e.g.: #27b3ce"),validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"brand-complementary":{title:r.getString("Secondary brand color"),type:"string",description:r.getString(e,{defaultColor:g("brand-complementary")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"brand-dark":{title:r.getString("Dark brand color"),type:"string",description:r.getString(e,{defaultColor:g("brand-dark")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"brand-light":{title:r.getString("Light brand color"),type:"string",description:r.getString(e,{defaultColor:g("brand-light")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"gray-text":{title:r.getString("Text color"),type:"string",description:r.getString(e,{defaultColor:g("gray-text")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"link-color":{title:r.getString("Link color"),type:"string",description:r.getString(e,{defaultColor:g("link-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"body-background-color":{title:r.getString("Main background color"),type:"string",description:r.getString(e,{defaultColor:g("body-background-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},headerColor:{title:r.getString("Background color"),type:"string",description:r.getString(e,{defaultColor:g("headerColor")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"header-text-color":{title:r.getString("Text color"),type:"string",description:r.getString(e,{defaultColor:g("header-text-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"header-hover-color":{title:r.getString("Button hover text color"),type:"string",description:r.getString(e,{defaultColor:g("header-hover-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},navColor:{title:r.getString("Background color"),type:"string",description:r.getString(e,{defaultColor:g("navColor")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},navColorHeader:{title:r.getString("Logo wrapper background color"),type:"string",description:r.getString(e,{defaultColor:g("navColorHeader")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"navigator-title-color":{title:r.getString("Title color"),type:"string",description:r.getString(e,{defaultColor:g("navigator-title-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"navigator-text-color":{title:r.getString("Text and buttons color"),type:"string",description:r.getString(e,{defaultColor:g("navigator-text-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"navigator-separator-color":{title:r.getString("Separator line color"),type:"string",description:r.getString(e,{defaultColor:g("navigator-separator-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"navigator-active-color":{title:r.getString("Text color of current item in navigator"),type:"string",description:r.getString(e,{defaultColor:g("navigator-active-color")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"navigator-active-bg":{title:r.getString("Background color of current item in navigator"),type:"string",description:r.getString(e,{defaultColor:g("navigator-active-bg")}),"x-schema-form":{validationMessage:_objectSpread({},t.message),$validators:_objectSpread({},t.validator)}},"btn-border-radius-base":{title:r.getString("Button border-radius"),type:"number",minimum:0,maximum:20,description:r.getString("Value in px")},cookieBannerDisabled:{title:r.getString("Disable cookie banner"),type:"boolean"},cookieBannerTitle:{title:r.getString("Title"),type:"string","x-schema-form":{condition:"!model.cookieBannerDisabled"}},cookieBannerText:{title:r.getString("Text"),type:"string","x-schema-form":{type:"textarea",condition:"!model.cookieBannerDisabled"}},policyUrl:{title:r.getString("Link to privacy policy"),type:"string","x-schema-form":{placeholder:r.getString("e.g. https://example.com/mypolicy"),condition:"!model.cookieBannerDisabled"}}}})}function g(e){return{"brand-complementary":"#07b91A","gray-text":"#444","link-color":"main brand color","body-background-color":"#FAFAFA","brand-dark":"#0B385B","brand-light":"#5FAEEC",headerColor:"#FFFFFF","header-text-color":"#49595B","header-hover-color":"main brand color",navColor:"#2c3637",navColorHeader:"transparent","navigator-title-color":"#FFFFFF","navigator-text-color":"#FAFAFA","navigator-separator-color":"#FAFAFA","navigator-active-color":"#FAFAFA","navigator-active-bg":"main brand color"}[e]}function t(e){var t={type:"collapse"};return _.assign(t,e),t.items=_.map(t.items,function(e){return{key:[e]}}),t.title=r.getString(t.title),t}}}e.$inject=["gettext"],angular.module("c8y.custom-branding").provider("c8yBrandingConfigurationUi",e)}();