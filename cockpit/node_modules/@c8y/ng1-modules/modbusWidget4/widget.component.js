"use strict";!function(){function e(u,n,e,a,t,i,o,c,s,l,r){var m,d,g=this,f=e.PROFIBUS_DEVICE_FRAGMENT,p=e.CANOPEN_DEVICE_FRAGMENT,v=i.isElementChangePending,h=i.canUpdateElement,E=i.getCurrentElementValue,b=l("Value out of range. Allowed values from {{min | number}} to {{max | number}}."),y=[];function C(e){n(S,e)}function S(){_.forEach(g.categories,function(e){_.forEach(e.elements,function(e){(function(e){return g.isElementChangePending(e)||_.includes(y,e)})(e)||(e.meta.type===t.ElementType.DISCRETE_IO&&(e.valueObj=_.find(e.meta.enumValues,{value:E(g.device,e)})),e.meta.type===t.ElementType.REGISTER&&(e.meta.enumType?e.valueObj=_.find(e.meta.enumValues,{value:E(g.device,e)}):_.set(e,"valueObj.value",E(g.device,e))))})})}_.assign(g,{$onChanges:function(e){e.config&&function(n){var t;regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n)return e.next=3,regeneratorRuntime.awrap(s.getWidgetModel(n));e.next=6;break;case 3:t=e.sent,_.assign(g,t),u.$apply();case 6:case"end":return e.stop()}},null,null,null,Promise)}(g.config)},$doCheck:function(){var e=!1;_.isEqual(m,g.categories)||(m=_.cloneDeep(g.categories),e=!0);_.isEqual(d,g.device)||(d=_.cloneDeep(g.device),e=!0);e&&C()},isElementChangePending:v,canUpdateElement:h,updateElement:function(e,n,t){var u=i.updateElement;_.has(e,f)?u=o.updateElement:_.has(e,p)&&(u=c.updateElement);return u(e,n,t).then(function(){y=_.without(y,n),C(500)})},shouldShowSwitch:function(e){return e.meta.enumType&&e.meta.enumValues&&2===e.meta.enumValues.length},shouldShowEnumSelect:function(e){return e.meta.enumType&&e.meta.enumValues&&(1===e.meta.enumValues.length||2<e.meta.enumValues.length)},shouldShowNumberInput:function(e){return!e.meta.enumType},validationHints:function(e,n){var t=[];n.meta.valuesRange.possiblePrecisionLoss&&t.push(r.getString("Precision loss may occur, check Cloud Fieldbus specification for details."));if(g.canUpdateElement(g.device,n)){var u=_.get(n,"meta.valuesRange.custom");t.push(a.validationHints(e,{required:l("This field is required."),"value-in-register-range":r.getString(b,u)}))}return t.join(" ")},focus:function(e){y.push(e)},blur:_.debounce(function(e){y=_.without(y,e),C(500)},500)})}e.$inject=["$rootScope","$timeout","fieldbusConstants","c8yBase","c8yDeviceDatabase","c8yModbusDevice","c8yProfibusDevice","c8yCanopenDevice","modbusWidgetSvc","gettext","gettextCatalog"],angular.module("c8y.modbusWidget4").component("c8yModbusWidget",{templateUrl:":::PLUGIN_PATH:::/widget.html",bindings:{config:"<"},controllerAs:"vm",controller:e})}();