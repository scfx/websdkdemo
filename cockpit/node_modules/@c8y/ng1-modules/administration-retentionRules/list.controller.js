"use strict";!function(){function e(n,t,i,o,r,a,e,l,u){function s(){n.refreshLoading=!0,r.list({pageSize:1e3}).then(function(e){n.retentions=e,n.paging=e.paging},g).finally(function(){n.refreshLoading=!1})}function c(e){n.retentions=_.concat(n.retentions,e),n.paging=e.paging}function g(e){403===e.status?i.info(u("You need these roles to access retention rules: Retention rule Read/Admin")):i.danger(l.getString(e.data.message),e.data)}function d(e){var t=_.partial(i.success,u("Retention rule deleted."));return r.remove(e).then(_.partial(f,e)).then(t)}function f(e){_.remove(n.retentions,e)}function p(e){n.retentions.push(e)}function h(e){var t=_.find(n.retentions,{id:e.id});_.merge(t,e)}function R(e){return!1!==e.editable}e.changeTitle({title:u("Retention rules")}),s(),n.list=s,n.createModal=function(){return a.editRetentionRule().then(p)},n.updateModal=function(e){return R(e)?a.editRetentionRule(e).then(h):t.resolve()},n.removeWithConfirmation=function(e){return o({title:u("Delete retention rule"),body:u("You are about to delete this retention rule. Do you want to proceed?"),labels:{ok:u("Delete")},status:"danger"}).then(_.partial(d,e))},n.isEditable=R,n.refreshLoading=!1,n.loadNext=function(){n.paging.loading=!0,n.paging.next().then(c).finally(function(){n.paging.loading=!1})}}e.$inject=["$scope","$q","c8yAlert","c8yModal","c8yRetentions","c8yUiUtil","c8yTitle","gettextCatalog","gettext"],angular.module("c8y.parts.retentionRules").controller("c8yRetentionRulesListCtrl",e)}();