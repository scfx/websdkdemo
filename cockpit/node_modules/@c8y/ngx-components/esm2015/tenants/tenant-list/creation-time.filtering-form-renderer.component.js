import { Component } from '@angular/core';
import { FilteringFormRendererContext } from '@c8y/ngx-components';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@c8y/ngx-components';
import * as ɵngcc2 from '@angular/forms';
import * as ɵngcc3 from 'ngx-bootstrap/datepicker';

const _c0 = function () { return { customTodayClass: "today", returnFocusToInput: true }; };
export class CreationTimeFilteringFormRendererComponent {
    constructor(context) {
        this.context = context;
        this.model = (this.context.property.externalFilterQuery || {}).model || {};
    }
    applyFilter() {
        this.context.applyFilter({
            externalFilterQuery: {
                model: this.model
            },
            filterPredicate: (tenant) => {
                const creationTime = new Date(tenant.creationTime);
                let dateFrom;
                let dateTo;
                if (this.model.dateFrom) {
                    dateFrom = this.model.dateFrom;
                    dateFrom.setHours(0, 0, 0, 0);
                }
                if (this.model.dateTo) {
                    dateTo = this.model.dateTo;
                    dateTo.setHours(23, 59, 59, 999);
                }
                return Boolean((!dateFrom && !dateTo) ||
                    (dateFrom && !dateTo && dateFrom <= creationTime) ||
                    (!dateFrom && dateTo && creationTime <= dateTo) ||
                    (dateFrom && dateTo && dateFrom <= creationTime && creationTime <= dateTo));
            }
        });
    }
    resetFilter() {
        this.context.resetFilter();
    }
}
CreationTimeFilteringFormRendererComponent.ɵfac = function CreationTimeFilteringFormRendererComponent_Factory(t) { return new (t || CreationTimeFilteringFormRendererComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.FilteringFormRendererContext)); };
CreationTimeFilteringFormRendererComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: CreationTimeFilteringFormRendererComponent, selectors: [["ng-component"]], decls: 21, vars: 30, consts: [["filterForm", "ngForm"], [1, "m-b-8", "p-t-8"], [1, "datepicker", "d-block", "m-b-16", 2, "max-height", "32px"], ["name", "dateFrom", "bsDatepicker", "", 1, "form-control", "fit-w", "text-left", 3, "ngModel", "placeholder", "bsConfig", "maxDate", "ngModelChange"], [1, "datepicker", "m-l-0", "d-block", 2, "max-height", "32px"], ["name", "dateTo", "bsDatepicker", "", 1, "form-control", "fit-w", "text-left", 3, "ngModel", "placeholder", "bsConfig", "minDate", "ngModelChange"], [1, "data-grid__dropdown__footer", "d-flex", "separator-top"], [1, "btn", "btn-default", "btn-sm", "m-r-8", "flex-grow", 3, "title", "click"], [1, "btn", "btn-primary", "btn-sm", "flex-grow", 3, "disabled", "title", "click"]], template: function CreationTimeFilteringFormRendererComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "form", null, 0);
        ɵngcc0.ɵɵelementStart(2, "div", 1);
        ɵngcc0.ɵɵelementStart(3, "label");
        ɵngcc0.ɵɵtext(4);
        ɵngcc0.ɵɵpipe(5, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(6, "c8y-form-group", 2);
        ɵngcc0.ɵɵelementStart(7, "input", 3);
        ɵngcc0.ɵɵlistener("ngModelChange", function CreationTimeFilteringFormRendererComponent_Template_input_ngModelChange_7_listener($event) { return ctx.model.dateFrom = $event; });
        ɵngcc0.ɵɵpipe(8, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(9, "c8y-form-group", 4);
        ɵngcc0.ɵɵelementStart(10, "input", 5);
        ɵngcc0.ɵɵlistener("ngModelChange", function CreationTimeFilteringFormRendererComponent_Template_input_ngModelChange_10_listener($event) { return ctx.model.dateTo = $event; });
        ɵngcc0.ɵɵpipe(11, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(12, "div", 6);
        ɵngcc0.ɵɵelementStart(13, "button", 7);
        ɵngcc0.ɵɵlistener("click", function CreationTimeFilteringFormRendererComponent_Template_button_click_13_listener() { return ctx.resetFilter(); });
        ɵngcc0.ɵɵpipe(14, "translate");
        ɵngcc0.ɵɵtext(15);
        ɵngcc0.ɵɵpipe(16, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(17, "button", 8);
        ɵngcc0.ɵɵlistener("click", function CreationTimeFilteringFormRendererComponent_Template_button_click_17_listener() { return ctx.applyFilter(); });
        ɵngcc0.ɵɵpipe(18, "translate");
        ɵngcc0.ɵɵtext(19);
        ɵngcc0.ɵɵpipe(20, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        const _r0 = ɵngcc0.ɵɵreference(1);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(5, 14, "Filter by creation time"));
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵpropertyInterpolate("placeholder", ɵngcc0.ɵɵpipeBind1(8, 16, "Created from`date`"));
        ɵngcc0.ɵɵproperty("ngModel", ctx.model.dateFrom)("bsConfig", ɵngcc0.ɵɵpureFunction0(28, _c0))("maxDate", ctx.model.dateTo);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵpropertyInterpolate("placeholder", ɵngcc0.ɵɵpipeBind1(11, 18, "Created to`date`"));
        ɵngcc0.ɵɵproperty("ngModel", ctx.model.dateTo)("bsConfig", ɵngcc0.ɵɵpureFunction0(29, _c0))("minDate", ctx.model.dateFrom);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(14, 20, "Reset"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(16, 22, "Reset"), " ");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(18, 24, "Apply"));
        ɵngcc0.ɵɵproperty("disabled", _r0.invalid);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(20, 26, "Apply"), " ");
    } }, directives: [ɵngcc2.ɵNgNoValidate, ɵngcc2.NgControlStatusGroup, ɵngcc2.NgForm, ɵngcc1.FormGroupComponent, ɵngcc3.BsDatepickerInputDirective, ɵngcc2.DefaultValueAccessor, ɵngcc3.BsDatepickerDirective, ɵngcc2.NgControlStatus, ɵngcc2.NgModel], pipes: [ɵngcc1.C8yTranslatePipe], encapsulation: 2 });
CreationTimeFilteringFormRendererComponent.ctorParameters = () => [
    { type: FilteringFormRendererContext }
];
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CreationTimeFilteringFormRendererComponent, [{
        type: Component,
        args: [{
                template: "<form #filterForm=\"ngForm\">\n  <div class=\"m-b-8 p-t-8\">\n    <label>{{ 'Filter by creation time' | translate }}</label>\n    <c8y-form-group class=\"datepicker d-block m-b-16\" style=\"max-height: 32px\">\n      <input\n        name=\"dateFrom\"\n        [(ngModel)]=\"model.dateFrom\"\n        class=\"form-control fit-w text-left\"\n        placeholder=\"{{ 'Created from`date`' | translate }}\"\n        bsDatepicker\n        [bsConfig]=\"{ customTodayClass: 'today', returnFocusToInput: true }\"\n        [maxDate]=\"model.dateTo\"\n      />\n    </c8y-form-group>\n    <c8y-form-group class=\"datepicker m-l-0 d-block\" style=\"max-height: 32px\">\n      <input\n        name=\"dateTo\"\n        [(ngModel)]=\"model.dateTo\"\n        class=\"form-control fit-w text-left\"\n        placeholder=\"{{ 'Created to`date`' | translate }}\"\n        bsDatepicker\n        [bsConfig]=\"{ customTodayClass: 'today', returnFocusToInput: true }\"\n        [minDate]=\"model.dateFrom\"\n      />\n    </c8y-form-group>\n  </div>\n</form>\n\n<div class=\"data-grid__dropdown__footer d-flex separator-top\">\n  <button\n    class=\"btn btn-default btn-sm m-r-8 flex-grow\"\n    (click)=\"resetFilter()\"\n    title=\"{{ 'Reset' | translate }}\"\n  >\n    {{ 'Reset' | translate }}\n  </button>\n  <button\n    class=\"btn btn-primary btn-sm flex-grow\"\n    [disabled]=\"filterForm.invalid\"\n    (click)=\"applyFilter()\"\n    title=\"{{ 'Apply' | translate }}\"\n  >\n    {{ 'Apply' | translate }}\n  </button>\n</div>\n"
            }]
    }], function () { return [{ type: ɵngcc1.FilteringFormRendererContext }]; }, null); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRpb24tdGltZS5maWx0ZXJpbmctZm9ybS1yZW5kZXJlci5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3RlbmFudHMvdGVuYW50LWxpc3QvY3JlYXRpb24tdGltZS5maWx0ZXJpbmctZm9ybS1yZW5kZXJlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUxQyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7Ozs7OztBQUtuRSxNQUFNLE9BQU8sMENBQTBDO0FBQ3ZELElBS0UsWUFBbUIsT0FBcUM7QUFDMUQsUUFEcUIsWUFBTyxHQUFQLE9BQU8sQ0FBOEI7QUFBQyxRQUN2RCxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsbUJBQW1CLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztBQUMvRSxJQUFFLENBQUM7QUFDSCxJQUNFLFdBQVc7QUFDYixRQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQzdCLFlBQU0sbUJBQW1CLEVBQUU7QUFDM0IsZ0JBQVEsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO0FBQ3pCLGFBQU87QUFDUCxZQUFNLGVBQWUsRUFBRSxDQUFDLE1BQWUsRUFBRSxFQUFFO0FBQzNDLGdCQUFRLE1BQU0sWUFBWSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUMzRCxnQkFBUSxJQUFJLFFBQVEsQ0FBQztBQUNyQixnQkFBUSxJQUFJLE1BQU0sQ0FBQztBQUNuQixnQkFDUSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFO0FBQ2pDLG9CQUFVLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQztBQUN6QyxvQkFBVSxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3hDLGlCQUFTO0FBQ1QsZ0JBQ1EsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtBQUMvQixvQkFBVSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7QUFDckMsb0JBQVUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUMzQyxpQkFBUztBQUNULGdCQUNRLE9BQU8sT0FBTyxDQUNaLENBQUMsQ0FBQyxRQUFRLElBQUksQ0FBQyxNQUFNLENBQUM7QUFDaEMsb0JBQVksQ0FBQyxRQUFRLElBQUksQ0FBQyxNQUFNLElBQUksUUFBUSxJQUFJLFlBQVksQ0FBQztBQUM3RCxvQkFBWSxDQUFDLENBQUMsUUFBUSxJQUFJLE1BQU0sSUFBSSxZQUFZLElBQUksTUFBTSxDQUFDO0FBQzNELG9CQUFZLENBQUMsUUFBUSxJQUFJLE1BQU0sSUFBSSxRQUFRLElBQUksWUFBWSxJQUFJLFlBQVksSUFBSSxNQUFNLENBQUMsQ0FDN0UsQ0FBQztBQUNWLFlBQU0sQ0FBQztBQUNQLFNBQUssQ0FBQyxDQUFDO0FBQ1AsSUFBRSxDQUFDO0FBQ0gsSUFDRSxXQUFXO0FBQ2IsUUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQy9CLElBQUUsQ0FBQztBQUNIO3NFQTlDQyxTQUFTLFNBQUMsa0JBQ1Q7Ozs7Ozs7Ozs7c0RBQXFFLGNBQ3RFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Z1RBQ0k7QUFBQztBQUVELFlBUEksNEJBQTRCO0FBQUc7Ozs7Ozs2RkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBJVGVuYW50IH0gZnJvbSAnQGM4eS9jbGllbnQnO1xuaW1wb3J0IHsgRmlsdGVyaW5nRm9ybVJlbmRlcmVyQ29udGV4dCB9IGZyb20gJ0BjOHkvbmd4LWNvbXBvbmVudHMnO1xuXG5AQ29tcG9uZW50KHtcbiAgdGVtcGxhdGVVcmw6ICcuL2NyZWF0aW9uLXRpbWUuZmlsdGVyaW5nLWZvcm0tcmVuZGVyZXIuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIENyZWF0aW9uVGltZUZpbHRlcmluZ0Zvcm1SZW5kZXJlckNvbXBvbmVudCB7XG4gIG1vZGVsOiB7XG4gICAgZGF0ZUZyb206IERhdGU7XG4gICAgZGF0ZVRvOiBEYXRlO1xuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb250ZXh0OiBGaWx0ZXJpbmdGb3JtUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgdGhpcy5tb2RlbCA9ICh0aGlzLmNvbnRleHQucHJvcGVydHkuZXh0ZXJuYWxGaWx0ZXJRdWVyeSB8fCB7fSkubW9kZWwgfHwge307XG4gIH1cblxuICBhcHBseUZpbHRlcigpIHtcbiAgICB0aGlzLmNvbnRleHQuYXBwbHlGaWx0ZXIoe1xuICAgICAgZXh0ZXJuYWxGaWx0ZXJRdWVyeToge1xuICAgICAgICBtb2RlbDogdGhpcy5tb2RlbFxuICAgICAgfSxcbiAgICAgIGZpbHRlclByZWRpY2F0ZTogKHRlbmFudDogSVRlbmFudCkgPT4ge1xuICAgICAgICBjb25zdCBjcmVhdGlvblRpbWUgPSBuZXcgRGF0ZSh0ZW5hbnQuY3JlYXRpb25UaW1lKTtcbiAgICAgICAgbGV0IGRhdGVGcm9tO1xuICAgICAgICBsZXQgZGF0ZVRvO1xuXG4gICAgICAgIGlmICh0aGlzLm1vZGVsLmRhdGVGcm9tKSB7XG4gICAgICAgICAgZGF0ZUZyb20gPSB0aGlzLm1vZGVsLmRhdGVGcm9tO1xuICAgICAgICAgIGRhdGVGcm9tLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubW9kZWwuZGF0ZVRvKSB7XG4gICAgICAgICAgZGF0ZVRvID0gdGhpcy5tb2RlbC5kYXRlVG87XG4gICAgICAgICAgZGF0ZVRvLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gQm9vbGVhbihcbiAgICAgICAgICAoIWRhdGVGcm9tICYmICFkYXRlVG8pIHx8XG4gICAgICAgICAgICAoZGF0ZUZyb20gJiYgIWRhdGVUbyAmJiBkYXRlRnJvbSA8PSBjcmVhdGlvblRpbWUpIHx8XG4gICAgICAgICAgICAoIWRhdGVGcm9tICYmIGRhdGVUbyAmJiBjcmVhdGlvblRpbWUgPD0gZGF0ZVRvKSB8fFxuICAgICAgICAgICAgKGRhdGVGcm9tICYmIGRhdGVUbyAmJiBkYXRlRnJvbSA8PSBjcmVhdGlvblRpbWUgJiYgY3JlYXRpb25UaW1lIDw9IGRhdGVUbylcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0RmlsdGVyKCkge1xuICAgIHRoaXMuY29udGV4dC5yZXNldEZpbHRlcigpO1xuICB9XG59XG4iXX0=