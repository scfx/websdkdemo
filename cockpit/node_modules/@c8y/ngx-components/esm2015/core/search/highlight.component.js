import { Component, ElementRef, Input, ViewChild } from '@angular/core';
import { escape, escapeRegExp } from 'lodash-es';
import * as ɵngcc0 from '@angular/core';

const _c0 = ["text"];
export class HighlightComponent {
    constructor() {
        this.pattern = '';
        this.text = '';
        this.elementClass = 'text-info';
        this.highlightedText = '';
    }
    ngOnChanges() {
        const textNoHtml = escape(this.text || '');
        const patternNoHtml = escape(this.pattern || '');
        const patternForRegex = escapeRegExp(patternNoHtml).replace(/\\\*/g, '.*');
        this.highlightedText = textNoHtml.replace(new RegExp(patternForRegex, 'i'), `<strong class="${this.elementClass}">$&</strong>`);
    }
}
HighlightComponent.ɵfac = function HighlightComponent_Factory(t) { return new (t || HighlightComponent)(); };
HighlightComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: HighlightComponent, selectors: [["c8y-highlight"]], viewQuery: function HighlightComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 7, ElementRef);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
    } }, inputs: { pattern: "pattern", text: "text", elementClass: "elementClass" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 1, vars: 1, consts: [[3, "innerHTML"]], template: function HighlightComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "span", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("innerHTML", ctx.highlightedText, ɵngcc0.ɵɵsanitizeHtml);
    } }, encapsulation: 2 });
HighlightComponent.propDecorators = {
    container: [{ type: ViewChild, args: ['text', { read: ElementRef, static: true },] }],
    pattern: [{ type: Input }],
    text: [{ type: Input }],
    elementClass: [{ type: Input }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HighlightComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-highlight',
                template: '<span [innerHTML]="highlightedText"></span>'
            }]
    }], function () { return []; }, { pattern: [{
            type: Input
        }], text: [{
            type: Input
        }], elementClass: [{
            type: Input
        }], container: [{
            type: ViewChild,
            args: ['text', { read: ElementRef, static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlnaGxpZ2h0LmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29yZS9zZWFyY2gvaGlnaGxpZ2h0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFVBQVUsRUFDVixLQUFLLEVBQ0wsU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sV0FBVyxDQUFDOzs7O0FBTWpELE1BQU0sT0FBTyxrQkFBa0I7QUFDL0IsSUFMQTtBQUNHLFFBUUQsWUFBTyxHQUFXLEVBQUUsQ0FBQztBQUN2QixRQUVFLFNBQUksR0FBVyxFQUFFLENBQUM7QUFDcEIsUUFFRSxpQkFBWSxHQUFXLFdBQVcsQ0FBQztBQUNyQyxRQUNFLG9CQUFlLEdBQVcsRUFBRSxDQUFDO0FBQy9CLElBVUEsQ0FBQztBQUNELElBVkUsV0FBVztBQUFLLFFBQ2QsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLENBQUM7QUFDL0MsUUFBSSxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNyRCxRQUFJLE1BQU0sZUFBZSxHQUFHLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQy9FLFFBQUksSUFBSSxDQUFDLGVBQWUsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUN2QyxJQUFJLE1BQU0sQ0FBQyxlQUFlLEVBQUUsR0FBRyxDQUFDLEVBQ2hDLGtCQUFrQixJQUFJLENBQUMsWUFBWSxlQUFlLENBQ25ELENBQUM7QUFDTixJQUFFLENBQUM7QUFDSDs4Q0E1QkMsU0FBUyxTQUFDLGtCQUNULFFBQVEsRUFBRSxlQUFlO2VBQ3pCLFFBQVEsRUFBRSw2Q0FBNkMsY0FDeEQ7Ozs7Ozs7Ozs2QkFDSTtBQUFDO0FBQ0ksd0JBQVAsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtBQUNsRCxzQkFFRixLQUFLO0FBQ04sbUJBRUMsS0FBSztBQUNOLDJCQUVDLEtBQUs7QUFDUDs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBJbnB1dCxcbiAgVmlld0NoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZXNjYXBlLCBlc2NhcGVSZWdFeHAgfSBmcm9tICdsb2Rhc2gtZXMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktaGlnaGxpZ2h0JyxcbiAgdGVtcGxhdGU6ICc8c3BhbiBbaW5uZXJIVE1MXT1cImhpZ2hsaWdodGVkVGV4dFwiPjwvc3Bhbj4nXG59KVxuZXhwb3J0IGNsYXNzIEhpZ2hsaWdodENvbXBvbmVudCB7XG4gIEBWaWV3Q2hpbGQoJ3RleHQnLCB7IHJlYWQ6IEVsZW1lbnRSZWYsIHN0YXRpYzogdHJ1ZSB9KVxuICBjb250YWluZXI6IEVsZW1lbnRSZWY7XG5cbiAgQElucHV0KClcbiAgcGF0dGVybjogc3RyaW5nID0gJyc7XG5cbiAgQElucHV0KClcbiAgdGV4dDogc3RyaW5nID0gJyc7XG5cbiAgQElucHV0KClcbiAgZWxlbWVudENsYXNzOiBzdHJpbmcgPSAndGV4dC1pbmZvJztcblxuICBoaWdobGlnaHRlZFRleHQ6IHN0cmluZyA9ICcnO1xuXG4gIG5nT25DaGFuZ2VzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRleHROb0h0bWwgPSBlc2NhcGUodGhpcy50ZXh0IHx8ICcnKTtcbiAgICBjb25zdCBwYXR0ZXJuTm9IdG1sID0gZXNjYXBlKHRoaXMucGF0dGVybiB8fCAnJyk7XG4gICAgY29uc3QgcGF0dGVybkZvclJlZ2V4ID0gZXNjYXBlUmVnRXhwKHBhdHRlcm5Ob0h0bWwpLnJlcGxhY2UoL1xcXFxcXCovZywgJy4qJyk7XG4gICAgdGhpcy5oaWdobGlnaHRlZFRleHQgPSB0ZXh0Tm9IdG1sLnJlcGxhY2UoXG4gICAgICBuZXcgUmVnRXhwKHBhdHRlcm5Gb3JSZWdleCwgJ2knKSxcbiAgICAgIGA8c3Ryb25nIGNsYXNzPVwiJHt0aGlzLmVsZW1lbnRDbGFzc31cIj4kJjwvc3Ryb25nPmBcbiAgICApO1xuICB9XG59XG4iXX0=