import { Component, TemplateRef, Attribute, HostBinding } from '@angular/core';
import { AlertService } from './alert.service';
/**
 * Alert outlet component shows all added alerts. It is used in the application's `c8y-bootstrap` component.
 *
 * For applications which don’t use `c8y-bootstrap` component but want to display alerts via AlertService, a c8y-alert-outlet component needs to be added explicitly in the template.
 *
 * ## Example:
 * ```html
 *  <div class="alerts">
 *    <c8y-alert-outlet></c8y-alert-outlet>
 *  </div>
 * ```
 */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './alert.service';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from '../common/icon.directive';
import * as ɵngcc4 from '../i18n/c8y-translate.pipe';

function AlertOutletComponent_div_0_div_8_strong_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "strong", 10);
    ɵngcc0.ɵɵpipe(1, "translate");
} if (rf & 2) {
    const alert_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵproperty("textContent", ɵngcc0.ɵɵpipeBind1(1, 1, alert_r1.text));
} }
function AlertOutletComponent_div_0_div_8_strong_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "strong", 11);
    ɵngcc0.ɵɵpipe(1, "translate");
} if (rf & 2) {
    const alert_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵproperty("innerHTML", ɵngcc0.ɵɵpipeBind1(1, 1, alert_r1.text), ɵngcc0.ɵɵsanitizeHtml);
} }
function AlertOutletComponent_div_0_div_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtemplate(1, AlertOutletComponent_div_0_div_8_strong_1_Template, 2, 3, "strong", 8);
    ɵngcc0.ɵɵtemplate(2, AlertOutletComponent_div_0_div_8_strong_2_Template, 2, 3, "strong", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const alert_r1 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !alert_r1.allowHtml);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", alert_r1.allowHtml);
} }
function AlertOutletComponent_div_0_p_9_Template(rf, ctx) { if (rf & 1) {
    const _r13 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "p", 12);
    ɵngcc0.ɵɵelementStart(1, "button", 13);
    ɵngcc0.ɵɵlistener("click", function AlertOutletComponent_div_0_p_9_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r13); const alert_r1 = ɵngcc0.ɵɵnextContext().$implicit; const ctx_r11 = ɵngcc0.ɵɵnextContext(); return ctx_r11.showDetails(alert_r1); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelement(3, "i", 14);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵpipe(5, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 2, "Show details"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(5, 4, "Show details"), " ");
} }
function AlertOutletComponent_div_0_p_10_Template(rf, ctx) { if (rf & 1) {
    const _r15 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "p", 12);
    ɵngcc0.ɵɵelementStart(1, "button", 13);
    ɵngcc0.ɵɵlistener("click", function AlertOutletComponent_div_0_p_10_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r15); const ctx_r14 = ɵngcc0.ɵɵnextContext(2); return ctx_r14.closeDetails(); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelement(3, "i", 15);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵpipe(5, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 2, "Hide details"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(5, 4, "Hide details"), " ");
} }
function AlertOutletComponent_div_0_div_11_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵelementStart(1, "pre");
    ɵngcc0.ɵɵelement(2, "code", 16);
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r16 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("textContent", ɵngcc0.ɵɵpipeBind1(3, 1, ctx_r16.detailDisplayedAlert.contents));
} }
function AlertOutletComponent_div_0_div_11_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtemplate(1, AlertOutletComponent_div_0_div_11_div_1_Template, 4, 3, "div", 5);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const alert_r1 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r5.isTemplateRef(ctx_r5.detailDisplayedAlert.contents))("ngIfElse", ctx_r5.template(alert_r1.detailedData));
} }
const _c0 = function (a0, a1) { return [a0, a1]; };
function AlertOutletComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r19 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 1);
    ɵngcc0.ɵɵelementStart(1, "button", 2);
    ɵngcc0.ɵɵlistener("click", function AlertOutletComponent_div_0_Template_button_click_1_listener() { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r19); const alert_r1 = restoredCtx.$implicit; const ctx_r18 = ɵngcc0.ɵɵnextContext(); return ctx_r18.close(alert_r1); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "span", 3);
    ɵngcc0.ɵɵtext(4, "\u00D7");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "span", 4);
    ɵngcc0.ɵɵtext(6);
    ɵngcc0.ɵɵpipe(7, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(8, AlertOutletComponent_div_0_div_8_Template, 3, 2, "div", 5);
    ɵngcc0.ɵɵtemplate(9, AlertOutletComponent_div_0_p_9_Template, 6, 6, "p", 6);
    ɵngcc0.ɵɵtemplate(10, AlertOutletComponent_div_0_p_10_Template, 6, 6, "p", 6);
    ɵngcc0.ɵɵtemplate(11, AlertOutletComponent_div_0_div_11_Template, 2, 2, "div", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const alert_r1 = ctx.$implicit;
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction2(12, _c0, ctx_r0.getClass(alert_r1), ctx_r0.isDetailsShow(alert_r1) ? "expanded" : ""));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 8, "Close"));
    ɵngcc0.ɵɵadvance(5);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(7, 10, "Close"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r0.isTemplateRef(alert_r1.text))("ngIfElse", ctx_r0.template(alert_r1.text));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.hasDetails(alert_r1) && !ctx_r0.isDetailsShow(alert_r1));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.hasDetails(alert_r1) && ctx_r0.isDetailsShow(alert_r1));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.isDetailsShow(alert_r1));
} }
export class AlertOutletComponent {
    /**
     * @ignore
     */
    constructor(position, alertService) {
        this.position = position;
        this.alertService = alertService;
        /**
         * Currently displayed details of an alert. Only one alert’s details can be displayed at a time.”
         */
        this.detailDisplayedAlert = {};
        /**
         * @ignore
         */
        this.isStatic = false;
        this.isStatic = this.position === 'static';
    }
    /**
     * The array of current alerts.
     */
    get alerts() {
        return this.alertService.state$;
    }
    /**
     * Returns a CSS class for an alert depending on its type to style the corresponding alert component.
     */
    getClass(alert) {
        const classes = [];
        if (alert.type !== 'danger') {
            classes.push('interact');
        }
        classes.push(`alert-${alert.type}`);
        return classes.join(' ');
    }
    /**
     * Executes alert’s onClose method, if provided, and closes the alert.
     * @param alert The alert which will be closed.
     */
    close(alert) {
        if (alert.onClose) {
            alert.onClose();
        }
        this.alertService.remove(alert);
    }
    /**
     * Expands details part of particular alert, and collapses details for another alerts.
     * @param alert The alert which details should be expanded.
     */
    showDetails(alert) {
        if (alert.onDetail) {
            return alert.onDetail();
        }
        this.detailDisplayedAlert = Object.assign({}, alert);
        this.detailDisplayedAlert.mode = 'raw';
        this.setDetailsContent(alert);
    }
    /**
     * Returns true if alert has extra detailedData or defines custom onDetail method.
     */
    hasDetails(alert) {
        return (alert.detailedData || alert.onDetail);
    }
    /**
     * Collapses alert's details.
     */
    closeDetails() {
        this.detailDisplayedAlert = {};
    }
    /**
     * Returns true if details part of alert is expanded.
     */
    isDetailsShow(alert) {
        return this.alertService.areSame(alert, this.detailDisplayedAlert);
    }
    /**
     * @ignore
     */
    isTemplateRef(value) {
        return value instanceof TemplateRef;
    }
    /**
     * @ignore
     */
    template(content) {
        return this.isTemplateRef(content) ? content : undefined;
    }
    setDetailsContent(alert) {
        if (this.isTemplateRef(alert.detailedData) || typeof alert.detailedData === 'string') {
            this.detailDisplayedAlert.contents = alert.detailedData;
        }
        else {
            this.detailDisplayedAlert.contents = JSON.stringify(alert.detailedData, null, 2);
        }
    }
}
AlertOutletComponent.ɵfac = function AlertOutletComponent_Factory(t) { return new (t || AlertOutletComponent)(ɵngcc0.ɵɵinjectAttribute('position'), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AlertService)); };
AlertOutletComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: AlertOutletComponent, selectors: [["c8y-alert-outlet"]], hostVars: 2, hostBindings: function AlertOutletComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("static", ctx.isStatic);
    } }, decls: 2, vars: 3, consts: [["class", "alert animated fadeInRightBig m-t-16", 3, "ngClass", 4, "ngFor", "ngForOf"], [1, "alert", "animated", "fadeInRightBig", "m-t-16", 3, "ngClass"], ["type", "button", 1, "close", 3, "title", "click"], ["aria-hidden", "true"], [1, "sr-only"], [4, "ngIf", "ngIfElse"], ["class", "text-muted m-t-8", 4, "ngIf"], [4, "ngIf"], ["class", "message", 3, "textContent", 4, "ngIf"], ["class", "message", 3, "innerHTML", 4, "ngIf"], [1, "message", 3, "textContent"], [1, "message", 3, "innerHTML"], [1, "text-muted", "m-t-8"], [1, "btn", "btn-clean", 3, "title", "click"], ["c8yIcon", "chevron-down"], ["c8yIcon", "chevron-up"], [3, "textContent"]], template: function AlertOutletComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, AlertOutletComponent_div_0_Template, 12, 15, "div", 0);
        ɵngcc0.ɵɵpipe(1, "async");
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(1, 1, ctx.alerts));
    } }, directives: [ɵngcc2.NgForOf, ɵngcc2.NgClass, ɵngcc2.NgIf, ɵngcc3.IconDirective], pipes: [ɵngcc2.AsyncPipe, ɵngcc4.C8yTranslatePipe], encapsulation: 2 });
AlertOutletComponent.ctorParameters = () => [
    { type: String, decorators: [{ type: Attribute, args: ['position',] }] },
    { type: AlertService }
];
AlertOutletComponent.propDecorators = {
    isStatic: [{ type: HostBinding, args: ['class.static',] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(AlertOutletComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-alert-outlet',
                template: "<div\n  class=\"alert animated fadeInRightBig m-t-16\"\n  *ngFor=\"let alert of alerts | async\"\n  [ngClass]=\"[getClass(alert), isDetailsShow(alert) ? 'expanded' : '']\"\n>\n  <button title=\"{{ 'Close' | translate }}\" type=\"button\" class=\"close\" (click)=\"close(alert)\">\n    <span aria-hidden=\"true\">&times;</span>\n    <span class=\"sr-only\">{{ 'Close' | translate }}</span>\n  </button>\n\n  <div *ngIf=\"!isTemplateRef(alert.text); else template(alert.text)\">\n    <strong *ngIf=\"!alert.allowHtml\" [textContent]=\"alert.text | translate\" class=\"message\"></strong>\n    <strong *ngIf=\"alert.allowHtml\" [innerHTML]=\"alert.text | translate\" class=\"message\"></strong>\n  </div>\n  <p *ngIf=\"hasDetails(alert) && !isDetailsShow(alert)\" class=\"text-muted m-t-8\">\n    <button\n      title=\"{{ 'Show details' | translate }}\"\n      class=\"btn btn-clean\"\n      (click)=\"showDetails(alert)\"\n    >\n      <i c8yIcon=\"chevron-down\"></i>\n      {{ 'Show details' | translate }}\n    </button>\n  </p>\n  <p *ngIf=\"hasDetails(alert) && isDetailsShow(alert)\" class=\"text-muted m-t-8\">\n    <button title=\"{{ 'Hide details' | translate }}\" class=\"btn btn-clean\" (click)=\"closeDetails()\">\n      <i c8yIcon=\"chevron-up\"></i>\n      {{ 'Hide details' | translate }}\n    </button>\n  </p>\n  <div *ngIf=\"isDetailsShow(alert)\">\n    <div *ngIf=\"!isTemplateRef(detailDisplayedAlert.contents); else template(alert.detailedData)\">\n      <pre><code [textContent]=\"detailDisplayedAlert.contents | translate\"></code></pre>\n    </div>\n  </div>\n</div>\n"
            }]
    }], function () { return [{ type: String, decorators: [{
                type: Attribute,
                args: ['position']
            }] }, { type: ɵngcc1.AlertService }]; }, { isStatic: [{
            type: HostBinding,
            args: ['class.static']
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWxlcnQtb3V0bGV0LmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29yZS9hbGVydC9hbGVydC1vdXRsZXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFL0UsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLSCxNQUFNLE9BQU8sb0JBQW9CO0FBQ2pDLElBY0U7QUFDRjtBQUNFLE9BQUc7QUFDTCxJQUFFLFlBQ2lDLFFBQWdCLEVBQ3hDLFlBQTBCO0FBQ2xDLFFBRmdDLGFBQVEsR0FBUixRQUFRLENBQVE7QUFBQyxRQUN6QyxpQkFBWSxHQUFaLFlBQVksQ0FBYztBQUNyQyxRQXBCRTtBQUNGO0FBRUEsV0FESztBQUNMLFFBQUUseUJBQW9CLEdBQVEsRUFBRSxDQUFDO0FBQ2pDLFFBQUU7QUFDRjtBQUVBLFdBREs7QUFDTCxRQUErQixhQUFRLEdBQUcsS0FBSyxDQUFDO0FBQ2hELFFBYUksSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxLQUFLLFFBQVEsQ0FBQztBQUMvQyxJQUFFLENBQUM7QUFDSCxJQWZFO0FBQ0Y7QUFDRSxPQUFHO0FBQ0wsSUFBRSxJQUFJLE1BQU07QUFBSyxRQUNiLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUM7QUFDcEMsSUFBRSxDQUFDO0FBQ0gsSUFTRTtBQUNGO0FB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QztBQUN2RixTQUFLO0FBQ0wsSUFBRSxDQUFDO0FBQ0g7Z0RBbEdDLFNBQVMsU0FBQyxrQkFDVCxRQUFRLEVBQUUsa0JBQWtCLGtCQUM1Qjs7Ozs7Ozs7a0tBRUc7QUFBQzt3RUFGd0MseEVBSXBDLHlDQWlCTCxTQUFTLFNBQUMsVUFBVTtRQXBCeEIsUkFvQmlDLFlBdEN6QixZQUFZO0FBQUc7QUFBRztBQUNSLHVCQTBCaEIsV0FBVyxTQUFDLGNBQWM7QUFBTTs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBUZW1wbGF0ZVJlZiwgQXR0cmlidXRlLCBIb3N0QmluZGluZyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWxlcnQgfSBmcm9tICcuL2FsZXJ0Lm1vZGVsJztcbmltcG9ydCB7IEFsZXJ0U2VydmljZSB9IGZyb20gJy4vYWxlcnQuc2VydmljZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuLyoqXG4gKiBBbGVydCBvdXRsZXQgY29tcG9uZW50IHNob3dzIGFsbCBhZGRlZCBhbGVydHMuIEl0IGlzIHVzZWQgaW4gdGhlIGFwcGxpY2F0aW9uJ3MgYGM4eS1ib290c3RyYXBgIGNvbXBvbmVudC5cbiAqXG4gKiBGb3IgYXBwbGljYXRpb25zIHdoaWNoIGRvbuKAmXQgdXNlIGBjOHktYm9vdHN0cmFwYCBjb21wb25lbnQgYnV0IHdhbnQgdG8gZGlzcGxheSBhbGVydHMgdmlhIEFsZXJ0U2VydmljZSwgYSBjOHktYWxlcnQtb3V0bGV0IGNvbXBvbmVudCBuZWVkcyB0byBiZSBhZGRlZCBleHBsaWNpdGx5IGluIHRoZSB0ZW1wbGF0ZS5cbiAqXG4gKiAjIyBFeGFtcGxlOlxuICogYGBgaHRtbFxuICogIDxkaXYgY2xhc3M9XCJhbGVydHNcIj5cbiAqICAgIDxjOHktYWxlcnQtb3V0bGV0PjwvYzh5LWFsZXJ0LW91dGxldD5cbiAqICA8L2Rpdj5cbiAqIGBgYFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktYWxlcnQtb3V0bGV0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL2FsZXJ0LW91dGxldC5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgQWxlcnRPdXRsZXRDb21wb25lbnQge1xuICAvKipcbiAgICogQ3VycmVudGx5IGRpc3BsYXllZCBkZXRhaWxzIG9mIGFuIGFsZXJ0LiBPbmx5IG9uZSBhbGVydOKAmXMgZGV0YWlscyBjYW4gYmUgZGlzcGxheWVkIGF0IGEgdGltZS7igJ1cbiAgICovXG4gIGRldGFpbERpc3BsYXllZEFsZXJ0OiBhbnkgPSB7fTtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEBIb3N0QmluZGluZygnY2xhc3Muc3RhdGljJykgaXNTdGF0aWMgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFRoZSBhcnJheSBvZiBjdXJyZW50IGFsZXJ0cy5cbiAgICovXG4gIGdldCBhbGVydHMoKTogQmVoYXZpb3JTdWJqZWN0PEFsZXJ0W10+IHtcbiAgICByZXR1cm4gdGhpcy5hbGVydFNlcnZpY2Uuc3RhdGUkO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBAQXR0cmlidXRlKCdwb3NpdGlvbicpIHByaXZhdGUgcG9zaXRpb246IHN0cmluZyxcbiAgICBwdWJsaWMgYWxlcnRTZXJ2aWNlOiBBbGVydFNlcnZpY2VcbiAgKSB7XG4gICAgdGhpcy5pc1N0YXRpYyA9IHRoaXMucG9zaXRpb24gPT09ICdzdGF0aWMnO1xuICB9XG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgQ1NTIGNsYXNzIGZvciBhbiBhbGVydCBkZXBlbmRpbmcgb24gaXRzIHR5cGUgdG8gc3R5bGUgdGhlIGNvcnJlc3BvbmRpbmcgYWxlcnQgY29tcG9uZW50LlxuICAgKi9cbiAgZ2V0Q2xhc3MoYWxlcnQ6IEFsZXJ0KSB7XG4gICAgY29uc3QgY2xhc3NlcyA9IFtdO1xuICAgIGlmIChhbGVydC50eXBlICE9PSAnZGFuZ2VyJykge1xuICAgICAgY2xhc3Nlcy5wdXNoKCdpbnRlcmFjdCcpO1xuICAgIH1cbiAgICBjbGFzc2VzLnB1c2goYGFsZXJ0LSR7YWxlcnQudHlwZX1gKTtcbiAgICByZXR1cm4gY2xhc3Nlcy5qb2luKCcgJyk7XG4gIH1cbiAgLyoqXG4gICAqIEV4ZWN1dGVzIGFsZXJ04oCZcyBvbkNsb3NlIG1ldGhvZCwgaWYgcHJvdmlkZWQsIGFuZCBjbG9zZXMgdGhlIGFsZXJ0LlxuICAgKiBAcGFyYW0gYWxlcnQgVGhlIGFsZXJ0IHdoaWNoIHdpbGwgYmUgY2xvc2VkLlxuICAgKi9cbiAgY2xvc2UoYWxlcnQ6IEFsZXJ0KSB7XG4gICAgaWYgKGFsZXJ0Lm9uQ2xvc2UpIHtcbiAgICAgIGFsZXJ0Lm9uQ2xvc2UoKTtcbiAgICB9XG4gICAgdGhpcy5hbGVydFNlcnZpY2UucmVtb3ZlKGFsZXJ0KTtcbiAgfVxuICAvKipcbiAgICogRXhwYW5kcyBkZXRhaWxzIHBhcnQgb2YgcGFydGljdWxhciBhbGVydCwgYW5kIGNvbGxhcHNlcyBkZXRhaWxzIGZvciBhbm90aGVyIGFsZXJ0cy5cbiAgICogQHBhcmFtIGFsZXJ0IFRoZSBhbGVydCB3aGljaCBkZXRhaWxzIHNob3VsZCBiZSBleHBhbmRlZC5cbiAgICovXG4gIHNob3dEZXRhaWxzKGFsZXJ0OiBBbGVydCkge1xuICAgIGlmIChhbGVydC5vbkRldGFpbCkge1xuICAgICAgcmV0dXJuIGFsZXJ0Lm9uRGV0YWlsKCk7XG4gICAgfVxuICAgIHRoaXMuZGV0YWlsRGlzcGxheWVkQWxlcnQgPSBPYmplY3QuYXNzaWduKHt9LCBhbGVydCk7XG4gICAgdGhpcy5kZXRhaWxEaXNwbGF5ZWRBbGVydC5tb2RlID0gJ3Jhdyc7XG4gICAgdGhpcy5zZXREZXRhaWxzQ29udGVudChhbGVydCk7XG4gIH1cbiAgLyoqXG4gICAqIFJldHVybnMgdHJ1ZSBpZiBhbGVydCBoYXMgZXh0cmEgZGV0YWlsZWREYXRhIG9yIGRlZmluZXMgY3VzdG9tIG9uRGV0YWlsIG1ldGhvZC5cbiAgICovXG4gIGhhc0RldGFpbHMoYWxlcnQ6IEFsZXJ0KSB7XG4gICAgcmV0dXJuIChhbGVydC5kZXRhaWxlZERhdGEgfHwgYWxlcnQub25EZXRhaWwpO1xuICB9XG4gIC8qKlxuICAgKiBDb2xsYXBzZXMgYWxlcnQncyBkZXRhaWxzLlxuICAgKi9cbiAgY2xvc2VEZXRhaWxzKCkge1xuICAgIHRoaXMuZGV0YWlsRGlzcGxheWVkQWxlcnQgPSB7fTtcbiAgfVxuICAvKipcbiAgICogUmV0dXJucyB0cnVlIGlmIGRldGFpbHMgcGFydCBvZiBhbGVydCBpcyBleHBhbmRlZC5cbiAgICovXG4gIGlzRGV0YWlsc1Nob3coYWxlcnQ6IEFsZXJ0KSB7XG4gICAgcmV0dXJuIHRoaXMuYWxlcnRTZXJ2aWNlLmFyZVNhbWUoYWxlcnQsIHRoaXMuZGV0YWlsRGlzcGxheWVkQWxlcnQpO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBpc1RlbXBsYXRlUmVmKHZhbHVlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgVGVtcGxhdGVSZWY7XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHRlbXBsYXRlKGNvbnRlbnQpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLmlzVGVtcGxhdGVSZWYoY29udGVudCkgPyBjb250ZW50IDogdW5kZWZpbmVkO1xuICB9XG4gIHByaXZhdGUgc2V0RGV0YWlsc0NvbnRlbnQoYWxlcnQ6IEFsZXJ0KSB7XG4gICAgaWYgKCB0aGlzLmlzVGVtcGxhdGVSZWYoYWxlcnQuZGV0YWlsZWREYXRhKSB8fCB0eXBlb2YgYWxlcnQuZGV0YWlsZWREYXRhID09PSAnc3RyaW5nJyApIHtcbiAgICAgIHRoaXMuZGV0YWlsRGlzcGxheWVkQWxlcnQuY29udGVudHMgPSBhbGVydC5kZXRhaWxlZERhdGE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGV0YWlsRGlzcGxheWVkQWxlcnQuY29udGVudHMgPSBKU09OLnN0cmluZ2lmeShhbGVydC5kZXRhaWxlZERhdGEsIG51bGwsIDIpO1xuICAgIH1cbiAgfVxufVxuIl19