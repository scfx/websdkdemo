import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, HostBinding, HostListener, Input, Output } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
/**
 * Displays a CSS grid which is customizable by the customer. You can set
 * `c8y-dashboard-child`-components on it or position any element on it by
 * setting the grid CSS properties. On change (resize, or rearrange) the
 * component emits an change event.
 *
 * ## Example:
 *
 * ```html
 * <c8y-title>Hello from outlet</c8y-title>
 *
 * <c8y-action-bar-item [placement]="'right'">
 *   <button class="btn btn-link" (click)="addRandom()"><i c8yIcon="plus-circle"></i> Add random</button>
 * </c8y-action-bar-item>
 * <c8y-action-bar-item [placement]="'right'">
 *   <button class="btn btn-link" (click)="isFrozen = !isFrozen">
 *     <i [c8yIcon]="isFrozen ? 'lock' : 'unlock'"></i> Toggle freeze
 *   </button>
 * </c8y-action-bar-item>
 *
 * <c8y-dashboard (dashboardChange)="dashboardChange($event)">
 *   <c8y-dashboard-child
 *     [isFrozen]="isFrozen"
 *     title="dynamic"
 *     *ngFor="let widget of widgets"
 *     #current
 *   >
 *     x: {{ current.x }}<br />
 *     y: {{ current.y }}<br />
 *     width: {{ current.width }}<br />
 *     height: {{ current.height }}<br />
 *   </c8y-dashboard-child>
 *   <c8y-dashboard-child
 *     #cpWidget
 *     [isFrozen]="isFrozen"
 *     [x]="0"
 *     [y]="1"
 *     [width]="3"
 *     [height]="2"
 *     [data]="widget"
 *     [class]="'card card-dashboard panel-title-regular panel-content-branded panel-title-overlay'"
 *   >
 *     <c8y-dashboard-child-title>
 *       <span>World!</span>
 *     </c8y-dashboard-child-title>
 *     x: {{ cpWidget.x }}<br />
 *     y: {{ cpWidget.y }}<br />
 *     width: {{ cpWidget.width }}<br />
 *     height: {{ cpWidget.height }}<br />
 *   </c8y-dashboard-child>
 *   <c8y-dashboard-child
 *     #cpWidget2
 *     [isFrozen]="isFrozen"
 *     [x]="8"
 *     [y]="1"
 *     [width]="4"
 *     [height]="4"
 *     [class]="'card card-dashboard panel-content-dark'"
 *   >
 *     <c8y-dashboard-child-title>
 *       <span>Hello!</span>
 *     </c8y-dashboard-child-title>
 *     <c8y-dashboard-child-action>
 *       <a href="" (click)="cpWidget2.isFrozen = !cpWidget2.isFrozen; (false)">
 *         <i [c8yIcon]="cpWidget2.isFrozen ? 'lock' : 'unlock'"></i> Toggle freeze
 *       </a>
 *     </c8y-dashboard-child-action>
 *     x: {{ cpWidget2.x }}<br />
 *     y: {{ cpWidget2.y }}<br />
 *     width: {{ cpWidget2.width }}<br />
 *     height: {{ cpWidget2.height }}<br />
 *   </c8y-dashboard-child>
 *
 *   <c8y-dashboard-child
 *     #cpWidget3
 *     [isFrozen]="isFrozen"
 *     [x]="0"
 *     [y]="3"
 *     [width]="4"
 *     [height]="4"
 *     [class]="'card-dashboard panel-content-transparent'"
 *   >
 *     <c8y-dashboard-child-title *ngIf="showTitle">
 *       <span>Transparent!</span>
 *     </c8y-dashboard-child-title>
 *     <c8y-dashboard-child-action>
 *       <a href="" (click)="showTitle = !showTitle; (false)">
 *         <i [c8yIcon]="'heading'"></i> Hide/show title
 *       </a>
 *     </c8y-dashboard-child-action>
 *     <c8y-dashboard-child-action>
 *       <a href="" (click)="cpWidget3.isFrozen = !cpWidget3.isFrozen; (false)">
 *         <i [c8yIcon]="cpWidget3.isFrozen ? 'lock' : 'unlock'"></i> Toggle freeze
 *       </a>
 *     </c8y-dashboard-child-action>
 *     x: {{ cpWidget3.x }}<br />
 *     y: {{ cpWidget3.y }}<br />
 *     width: {{ cpWidget3.width }}<br />
 *     height: {{ cpWidget3.height }}<br />
 *   </c8y-dashboard-child>
 * </c8y-dashboard>
 * ```
 */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/platform-browser';

const _c0 = ["*"];
export class DashboardComponent {
    constructor(element, sanitizer) {
        this.element = element;
        this.sanitizer = sanitizer;
        /**
         * All children in that dashboard.
         */
        this.children = [];
        /**
         * The amount of columns on that dashboard.
         */
        this.columns = 12;
        /**
         * The spacing between each children in pixel.
         */
        this.gap = 12;
        /**
         * The amount of rows to dusplay. Set to auto to
         * auto extend the rows.
         */
        this.rows = 'auto';
        /**
         * An event fired if the dashboard was changed.
         */
        this.dashboardChange = new EventEmitter();
        this.lastRow = 1;
        this.DEFAULT_ROW_SIZE = 68;
    }
    /**
     * The current column size.
     */
    get columnSize() {
        return this.dashboardRect.width / this.columns;
    }
    /**
     * The current row size.
     */
    get rowSize() {
        return this.rows === 'auto' ? this.DEFAULT_ROW_SIZE : this.calculateRowSize();
    }
    /**
     * Returns all positioning styles. Nasty workaround for that issue:
     * https://github.com/angular/angular/issues/9343
     */
    get inlineStyle() {
        return this.sanitizer.bypassSecurityTrustStyle(`
        -ms-grid-columns: (1fr)[${this.columns}];
        grid-template-columns: repeat(${this.columns}, 1fr);
        ${this.rows !== 'auto' ? `grid-template-rows: repeat(${this.rows}, 1fr);` : ''}
        grid-auto-rows: ${this.rowSize + this.gap}px;
        -ms-grid-rows: (${this.rowSize + this.gap}px)[${this.rows === 'auto' ? this.lastRow : this.rows}];
        margin: -${this.gap}px -${this.gap}px 0;
      `);
    }
    ngAfterContentInit() {
        this.onResize();
    }
    onResize() {
        this.updateRectSize();
    }
    /**
     * Updates the current rect size of the dashboard.
     */
    updateRectSize() {
        const ele = this.element.nativeElement;
        this.dashboardRect = ele.getBoundingClientRect();
    }
    emitChange(widget) {
        this.dashboardChange.emit({ source: widget, children: this.children });
    }
    calculateRowSize() {
        return this.dashboardRect.height / this.rows;
    }
}
DashboardComponent.ɵfac = function DashboardComponent_Factory(t) { return new (t || DashboardComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.DomSanitizer)); };
DashboardComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: DashboardComponent, selectors: [["c8y-dashboard"]], hostAttrs: [1, "c8y-grid-dashboard", "dashboard-grid"], hostVars: 1, hostBindings: function DashboardComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("resize", function DashboardComponent_resize_HostBindingHandler() { return ctx.onResize(); }, false, ɵngcc0.ɵɵresolveWindow);
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("style", ctx.inlineStyle, ɵngcc0.ɵɵsanitizeStyle);
    } }, inputs: { columns: "columns", gap: "gap", rows: "rows" }, outputs: { dashboardChange: "dashboardChange" }, ngContentSelectors: _c0, decls: 1, vars: 0, template: function DashboardComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵprojection(0);
    } }, encapsulation: 2, changeDetection: 0 });
DashboardComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: DomSanitizer }
];
DashboardComponent.propDecorators = {
    columns: [{ type: Input }],
    gap: [{ type: Input }],
    rows: [{ type: Input }],
    dashboardChange: [{ type: Output }],
    inlineStyle: [{ type: HostBinding, args: ['attr.style',] }],
    onResize: [{ type: HostListener, args: ['window:resize',] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DashboardComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-dashboard',
                template: "<ng-content></ng-content>\n",
                host: {
                    class: 'c8y-grid-dashboard dashboard-grid'
                },
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc1.DomSanitizer }]; }, { columns: [{
            type: Input
        }], gap: [{
            type: Input
        }], rows: [{
            type: Input
        }], dashboardChange: [{
            type: Output
        }], inlineStyle: [{
            type: HostBinding,
            args: ['attr.style']
        }], onResize: [{
            type: HostListener,
            args: ['window:resize']
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29yZS9kYXNoYm9hcmQvZGFzaGJvYXJkLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLFdBQVcsRUFDWCxZQUFZLEVBQ1osS0FBSyxFQUNMLE1BQU0sRUFDUCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFJekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7Ozs7QUFTSCxNQUFNLE9BQU8sa0JBQWtCO0FBQUcsSUFpRWhDLFlBQW9CLE9BQW1CLEVBQVUsU0FBdUI7QUFBSSxRQUF4RCxZQUFPLEdBQVAsT0FBTyxDQUFZ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Q0FuR0MsU0FBUyxTQUFDLGtCQUNULFFBQVEsRUFBRSxlQUFlLGtCQUN6Qix1Q0FBeUMsa0JBQ3pDLElBQUksRUFBRTtVQUNKLEtBQUssRUFBRSxtQ0FBbUMsa0JBQzNDLGtCQUNELGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNLGNBQ2hEOzs7Ozs7O2lEQUNJO0FBQUM7QUFBNEMsWUExSGhELFVBQVU7QUFDVixZQU1PLFlBQVk7QUFBRztBQUFHO0FBQ3BCLHNCQTJISixLQUFLO0FBQUssa0JBS1YsS0FBSztBQUFLLG1CQU1WLEtBQUs7QUFBSyw4QkFLVixNQUFNO0FBQUssMEJBd0JYLFdBQVcsU0FBQyxZQUFZO0FBQ3RCLHVCQXFCRixZQUFZLFNBQUMsZUFBZTtBQUMzQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBIb3N0QmluZGluZyxcbiAgSG9zdExpc3RlbmVyLFxuICBJbnB1dCxcbiAgT3V0cHV0XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRG9tU2FuaXRpemVyIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQgeyBEYXNoYm9hcmRDaGlsZENvbXBvbmVudCB9IGZyb20gJy4vZGFzaGJvYXJkLWNoaWxkLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBEYXNoYm9hcmRDaGFuZ2UgfSBmcm9tICcuL2Rhc2hib2FyZC5tb2RlbCc7XG5cbi8qKlxuICogRGlzcGxheXMgYSBDU1MgZ3JpZCB3aGljaCBpcyBjdXN0b21pemFibGUgYnkgdGhlIGN1c3RvbWVyLiBZb3UgY2FuIHNldFxuICogYGM4eS1kYXNoYm9hcmQtY2hpbGRgLWNvbXBvbmVudHMgb24gaXQgb3IgcG9zaXRpb24gYW55IGVsZW1lbnQgb24gaXQgYnlcbiAqIHNldHRpbmcgdGhlIGdyaWQgQ1NTIHByb3BlcnRpZXMuIE9uIGNoYW5nZSAocmVzaXplLCBvciByZWFycmFuZ2UpIHRoZVxuICogY29tcG9uZW50IGVtaXRzIGFuIGNoYW5nZSBldmVudC5cbiAqXG4gKiAjIyBFeGFtcGxlOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxjOHktdGl0bGU+SGVsbG8gZnJvbSBvdXRsZXQ8L2M4eS10aXRsZT5cbiAqXG4gKiA8Yzh5LWFjdGlvbi1iYXItaXRlbSBbcGxhY2VtZW50XT1cIidyaWdodCdcIj5cbiAqICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tbGlua1wiIChjbGljayk9XCJhZGRSYW5kb20oKVwiPjxpIGM4eUljb249XCJwbHVzLWNpcmNsZVwiPjwvaT4gQWRkIHJhbmRvbTwvYnV0dG9uPlxuICogPC9jOHktYWN0aW9uLWJhci1pdGVtPlxuICogPGM4eS1hY3Rpb24tYmFyLWl0ZW0gW3BsYWNlbWVudF09XCIncmlnaHQnXCI+XG4gKiAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLWxpbmtcIiAoY2xpY2spPVwiaXNGcm96ZW4gPSAhaXNGcm96ZW5cIj5cbiAqICAgICA8aSBbYzh5SWNvbl09XCJpc0Zyb3plbiA/ICdsb2NrJyA6ICd1bmxvY2snXCI+PC9pPiBUb2dnbGUgZnJlZXplXG4gKiAgIDwvYnV0dG9uPlxuICogPC9jOHktYWN0aW9uLWJhci1pdGVtPlxuICpcbiAqIDxjOHktZGFzaGJvYXJkIChkYXNoYm9hcmRDaGFuZ2UpPVwiZGFzaGJvYXJkQ2hhbmdlKCRldmVudClcIj5cbiAqICAgPGM4eS1kYXNoYm9hcmQtY2hpbGRcbiAqICAgICBbaXNGcm96ZW5dPVwiaXNGcm96ZW5cIlxuICogICAgIHRpdGxlPVwiZHluYW1pY1wiXG4gKiAgICAgKm5nRm9yPVwibGV0IHdpZGdldCBvZiB3aWRnZXRzXCJcbiAqICAgICAjY3VycmVudFxuICogICA+XG4gKiAgICAgeDoge3sgY3VycmVudC54IH19PGJyIC8+XG4gKiAgICAgeToge3sgY3VycmVudC55IH19PGJyIC8+XG4gKiAgICAgd2lkdGg6IHt7IGN1cnJlbnQud2lkdGggfX08YnIgLz5cbiAqICAgICBoZWlnaHQ6IHt7IGN1cnJlbnQuaGVpZ2h0IH19PGJyIC8+XG4gKiAgIDwvYzh5LWRhc2hib2FyZC1jaGlsZD5cbiAqICAgPGM4eS1kYXNoYm9hcmQtY2hpbGRcbiAqICAgICAjY3BXaWRnZXRcbiAqICAgICBbaXNGcm96ZW5dPVwiaXNGcm96ZW5cIlxuICogICAgIFt4XT1cIjBcIlxuICogICAgIFt5XT1cIjFcIlxuICogICAgIFt3aWR0aF09XCIzXCJcbiAqICAgICBbaGVpZ2h0XT1cIjJcIlxuICogICAgIFtkYXRhXT1cIndpZGdldFwiXG4gKiAgICAgW2NsYXNzXT1cIidjYXJkIGNhcmQtZGFzaGJvYXJkIHBhbmVsLXRpdGxlLXJlZ3VsYXIgcGFuZWwtY29udGVudC1icmFuZGVkIHBhbmVsLXRpdGxlLW92ZXJsYXknXCJcbiAqICAgPlxuICogICAgIDxjOHktZGFzaGJvYXJkLWNoaWxkLXRpdGxlPlxuICogICAgICAgPHNwYW4+V29ybGQhPC9zcGFuPlxuICogICAgIDwvYzh5LWRhc2hib2FyZC1jaGlsZC10aXRsZT5cbiAqICAgICB4OiB7eyBjcFdpZGdldC54IH19PGJyIC8+XG4gKiAgICAgeToge3sgY3BXaWRnZXQueSB9fTxiciAvPlxuICogICAgIHdpZHRoOiB7eyBjcFdpZGdldC53aWR0aCB9fTxiciAvPlxuICogICAgIGhlaWdodDoge3sgY3BXaWRnZXQuaGVpZ2h0IH19PGJyIC8+XG4gKiAgIDwvYzh5LWRhc2hib2FyZC1jaGlsZD5cbiAqICAgPGM4eS1kYXNoYm9hcmQtY2hpbGRcbiAqICAgICAjY3BXaWRnZXQyXG4gKiAgICAgW2lzRnJvemVuXT1cImlzRnJvemVuXCJcbiAqICAgICBbeF09XCI4XCJcbiAqICAgICBbeV09XCIxXCJcbiAqICAgICBbd2lkdGhdPVwiNFwiXG4gKiAgICAgW2hlaWdodF09XCI0XCJcbiAqICAgICBbY2xhc3NdPVwiJ2NhcmQgY2FyZC1kYXNoYm9hcmQgcGFuZWwtY29udGVudC1kYXJrJ1wiXG4gKiAgID5cbiAqICAgICA8Yzh5LWRhc2hib2FyZC1jaGlsZC10aXRsZT5cbiAqICAgICAgIDxzcGFuPkhlbGxvITwvc3Bhbj5cbiAqICAgICA8L2M4eS1kYXNoYm9hcmQtY2hpbGQtdGl0bGU+XG4gKiAgICAgPGM4eS1kYXNoYm9hcmQtY2hpbGQtYWN0aW9uPlxuICogICAgICAgPGEgaHJlZj1cIlwiIChjbGljayk9XCJjcFdpZGdldDIuaXNGcm96ZW4gPSAhY3BXaWRnZXQyLmlzRnJvemVuOyAoZmFsc2UpXCI+XG4gKiAgICAgICAgIDxpIFtjOHlJY29uXT1cImNwV2lkZ2V0Mi5pc0Zyb3plbiA/ICdsb2NrJyA6ICd1bmxvY2snXCI+PC9pPiBUb2dnbGUgZnJlZXplXG4gKiAgICAgICA8L2E+XG4gKiAgICAgPC9jOHktZGFzaGJvYXJkLWNoaWxkLWFjdGlvbj5cbiAqICAgICB4OiB7eyBjcFdpZGdldDIueCB9fTxiciAvPlxuICogICAgIHk6IHt7IGNwV2lkZ2V0Mi55IH19PGJyIC8+XG4gKiAgICAgd2lkdGg6IHt7IGNwV2lkZ2V0Mi53aWR0aCB9fTxiciAvPlxuICogICAgIGhlaWdodDoge3sgY3BXaWRnZXQyLmhlaWdodCB9fTxiciAvPlxuICogICA8L2M4eS1kYXNoYm9hcmQtY2hpbGQ+XG4gKlxuICogICA8Yzh5LWRhc2hib2FyZC1jaGlsZFxuICogICAgICNjcFdpZGdldDNcbiAqICAgICBbaXNGcm96ZW5dPVwiaXNGcm96ZW5cIlxuICogICAgIFt4XT1cIjBcIlxuICogICAgIFt5XT1cIjNcIlxuICogICAgIFt3aWR0aF09XCI0XCJcbiAqICAgICBbaGVpZ2h0XT1cIjRcIlxuICogICAgIFtjbGFzc109XCInY2FyZC1kYXNoYm9hcmQgcGFuZWwtY29udGVudC10cmFuc3BhcmVudCdcIlxuICogICA+XG4gKiAgICAgPGM4eS1kYXNoYm9hcmQtY2hpbGQtdGl0bGUgKm5nSWY9XCJzaG93VGl0bGVcIj5cbiAqICAgICAgIDxzcGFuPlRyYW5zcGFyZW50ITwvc3Bhbj5cbiAqICAgICA8L2M4eS1kYXNoYm9hcmQtY2hpbGQtdGl0bGU+XG4gKiAgICAgPGM4eS1kYXNoYm9hcmQtY2hpbGQtYWN0aW9uPlxuICogICAgICAgPGEgaHJlZj1cIlwiIChjbGljayk9XCJzaG93VGl0bGUgPSAhc2hvd1RpdGxlOyAoZmFsc2UpXCI+XG4gKiAgICAgICAgIDxpIFtjOHlJY29uXT1cIidoZWFkaW5nJ1wiPjwvaT4gSGlkZS9zaG93IHRpdGxlXG4gKiAgICAgICA8L2E+XG4gKiAgICAgPC9jOHktZGFzaGJvYXJkLWNoaWxkLWFjdGlvbj5cbiAqICAgICA8Yzh5LWRhc2hib2FyZC1jaGlsZC1hY3Rpb24+XG4gKiAgICAgICA8YSBocmVmPVwiXCIgKGNsaWNrKT1cImNwV2lkZ2V0My5pc0Zyb3plbiA9ICFjcFdpZGdldDMuaXNGcm96ZW47IChmYWxzZSlcIj5cbiAqICAgICAgICAgPGkgW2M4eUljb25dPVwiY3BXaWRnZXQzLmlzRnJvemVuID8gJ2xvY2snIDogJ3VubG9jaydcIj48L2k+IFRvZ2dsZSBmcmVlemVcbiAqICAgICAgIDwvYT5cbiAqICAgICA8L2M4eS1kYXNoYm9hcmQtY2hpbGQtYWN0aW9uPlxuICogICAgIHg6IHt7IGNwV2lkZ2V0My54IH19PGJyIC8+XG4gKiAgICAgeToge3sgY3BXaWRnZXQzLnkgfX08YnIgLz5cbiAqICAgICB3aWR0aDoge3sgY3BXaWRnZXQzLndpZHRoIH19PGJyIC8+XG4gKiAgICAgaGVpZ2h0OiB7eyBjcFdpZGdldDMuaGVpZ2h0IH19PGJyIC8+XG4gKiAgIDwvYzh5LWRhc2hib2FyZC1jaGlsZD5cbiAqIDwvYzh5LWRhc2hib2FyZD5cbiAqIGBgYFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktZGFzaGJvYXJkJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2Rhc2hib2FyZC5jb21wb25lbnQuaHRtbCcsXG4gIGhvc3Q6IHtcbiAgICBjbGFzczogJ2M4eS1ncmlkLWRhc2hib2FyZCBkYXNoYm9hcmQtZ3JpZCdcbiAgfSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgRGFzaGJvYXJkQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJDb250ZW50SW5pdCB7XG4gIC8qKlxuICAgKiBBbGwgY2hpbGRyZW4gaW4gdGhhdCBkYXNoYm9hcmQuXG4gICAqL1xuICBjaGlsZHJlbjogRGFzaGJvYXJkQ2hpbGRDb21wb25lbnRbXSA9IFtdO1xuXG4gIC8qKlxuICAgKiBUaGUgYW1vdW50IG9mIGNvbHVtbnMgb24gdGhhdCBkYXNoYm9hcmQuXG4gICAqL1xuICBASW5wdXQoKSBjb2x1bW5zID0gMTI7XG5cbiAgLyoqXG4gICAqIFRoZSBzcGFjaW5nIGJldHdlZW4gZWFjaCBjaGlsZHJlbiBpbiBwaXhlbC5cbiAgICovXG4gIEBJbnB1dCgpIGdhcCA9IDEyO1xuXG4gIC8qKlxuICAgKiBUaGUgYW1vdW50IG9mIHJvd3MgdG8gZHVzcGxheS4gU2V0IHRvIGF1dG8gdG9cbiAgICogYXV0byBleHRlbmQgdGhlIHJvd3MuXG4gICAqL1xuICBASW5wdXQoKSByb3dzOiBudW1iZXIgfCAnYXV0bycgPSAnYXV0byc7XG5cbiAgLyoqXG4gICAqIEFuIGV2ZW50IGZpcmVkIGlmIHRoZSBkYXNoYm9hcmQgd2FzIGNoYW5nZWQuXG4gICAqL1xuICBAT3V0cHV0KCkgZGFzaGJvYXJkQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxEYXNoYm9hcmRDaGFuZ2U+KCk7XG5cbiAgZGFzaGJvYXJkUmVjdDtcbiAgcHJpdmF0ZSBsYXN0Um93ID0gMTtcbiAgcHJpdmF0ZSByZWFkb25seSBERUZBVUxUX1JPV19TSVpFID0gNjg7XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IGNvbHVtbiBzaXplLlxuICAgKi9cbiAgZ2V0IGNvbHVtblNpemUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGFzaGJvYXJkUmVjdC53aWR0aCAvIHRoaXMuY29sdW1ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudCByb3cgc2l6ZS5cbiAgICovXG4gIGdldCByb3dTaXplKCkge1xuICAgIHJldHVybiB0aGlzLnJvd3MgPT09ICdhdXRvJyA/IHRoaXMuREVGQVVMVF9ST1dfU0laRSA6IHRoaXMuY2FsY3VsYXRlUm93U2l6ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYWxsIHBvc2l0aW9uaW5nIHN0eWxlcy4gTmFzdHkgd29ya2Fyb3VuZCBmb3IgdGhhdCBpc3N1ZTpcbiAgICogaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvOTM0M1xuICAgKi9cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLnN0eWxlJylcbiAgZ2V0IGlubGluZVN0eWxlKCkge1xuICAgIHJldHVybiB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0U3R5bGUoXG4gICAgICBgXG4gICAgICAgIC1tcy1ncmlkLWNvbHVtbnM6ICgxZnIpWyR7dGhpcy5jb2x1bW5zfV07XG4gICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KCR7dGhpcy5jb2x1bW5zfSwgMWZyKTtcbiAgICAgICAgJHt0aGlzLnJvd3MgIT09ICdhdXRvJyA/IGBncmlkLXRlbXBsYXRlLXJvd3M6IHJlcGVhdCgke3RoaXMucm93c30sIDFmcik7YCA6ICcnfVxuICAgICAgICBncmlkLWF1dG8tcm93czogJHt0aGlzLnJvd1NpemUgKyB0aGlzLmdhcH1weDtcbiAgICAgICAgLW1zLWdyaWQtcm93czogKCR7dGhpcy5yb3dTaXplICsgdGhpcy5nYXB9cHgpWyR7XG4gICAgICAgIHRoaXMucm93cyA9PT0gJ2F1dG8nID8gdGhpcy5sYXN0Um93IDogdGhpcy5yb3dzXG4gICAgICB9XTtcbiAgICAgICAgbWFyZ2luOiAtJHt0aGlzLmdhcH1weCAtJHt0aGlzLmdhcH1weCAwO1xuICAgICAgYFxuICAgICk7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsIHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIpIHt9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xuICAgIHRoaXMub25SZXNpemUoKTtcbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpyZXNpemUnKVxuICBvblJlc2l6ZSgpIHtcbiAgICB0aGlzLnVwZGF0ZVJlY3RTaXplKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY3VycmVudCByZWN0IHNpemUgb2YgdGhlIGRhc2hib2FyZC5cbiAgICovXG4gIHVwZGF0ZVJlY3RTaXplKCkge1xuICAgIGNvbnN0IGVsZSA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xuICAgIHRoaXMuZGFzaGJvYXJkUmVjdCA9IGVsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgfVxuXG4gIGVtaXRDaGFuZ2Uod2lkZ2V0OiBEYXNoYm9hcmRDaGlsZENvbXBvbmVudCkge1xuICAgIHRoaXMuZGFzaGJvYXJkQ2hhbmdlLmVtaXQoeyBzb3VyY2U6IHdpZGdldCwgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW4gfSk7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVJvd1NpemUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGFzaGJvYXJkUmVjdC5oZWlnaHQgLyAodGhpcy5yb3dzIGFzIG51bWJlcik7XG4gIH1cbn1cbiJdfQ==